{"version":3,"sources":["src/app.js","src/environment.js","src/main.js","src/utility.js","src/web-api.js","src/resources/aurelia-templating.js","src/resources/index.js","src/child-element.js","src/widget.js"],"names":["App","message","debug","testing","configure","aurelia","use","standardConfiguration","developmentLogging","start","then","a","setRoot","areEqual","obj1","obj2","Object","keys","every","key","hasOwnProperty","latency","id","getId","contacts","firstName","lastName","email","phoneNumber","WebAPI","isRequesting","getContactList","Promise","setTimeout","results","map","x","resolve","getContactDetails","found","filter","JSON","parse","stringify","saveContact","contact","instance","index","indexOf","push","_hyphenate","_isAllWhitespace","viewEngineHooks","children","child","resource","behavior","customElement","customAttribute","templateController","bindable","dynamicOptions","useShadowDOM","processAttributes","processContent","containerless","useViewStrategy","useView","inlineView","noView","elementConfig","viewResources","LogManager","_class","_temp","_dec","_class2","_dec2","_class3","_dec3","_class4","_dec4","_class5","_dec5","_class6","_class7","_temp2","_dec6","_class8","_class9","_temp3","_class11","_dec7","_class13","_dec8","_class14","_class15","_temp4","_dec9","_class16","_dec10","_class17","_dec11","_class18","animationEvent","enterBegin","enterActive","enterDone","enterTimeout","leaveBegin","leaveActive","leaveDone","leaveTimeout","staggerNext","removeClassBegin","removeClassActive","removeClassDone","removeClassTimeout","addClassBegin","addClassActive","addClassDone","addClassTimeout","animateBegin","animateActive","animateDone","animateTimeout","sequenceBegin","sequenceDone","Animator","enter","element","leave","removeClass","className","classList","remove","addClass","add","animate","runSequence","animations","registerEffect","effectName","properties","unregisterEffect","CompositionTransactionNotifier","owner","_compositionCount","done","_tryCompleteTransaction","CompositionTransactionOwnershipToken","_ownershipToken","thenable","_createThenable","waitForCompositionComplete","_resolveCallback","reject","CompositionTransaction","tryCapture","enlist","token","capitalMatcher","addHyphenAndLower","char","toLowerCase","name","charAt","slice","replace","node","auInterpolationTarget","test","textContent","ViewEngineHooksResource","initialize","container","target","get","register","registry","registerViewEngineHooks","load","convention","endsWith","deco","t","define","ElementEvents","subscriptions","_enqueueHandler","handler","eventName","_dequeueHandler","splice","publish","detail","bubbles","cancelable","event","createCustomEvent","dispatchEvent","subscribe","dispose","removeEventListener","addEventListener","undefined","subscribeOnce","_handler","length","subscription","pop","disposeAll","ResourceLoadContext","dependencies","addDependency","url","hasDependency","ViewCompileInstruction","targetShadowDOM","compileSurrogate","associatedModuleId","normal","BehaviorInstruction","enhance","instruction","unitTest","type","attributes","anchorIsContainer","hasAttribute","initiatedByBehavior","attribute","attrName","dynamic","host","viewModel","viewFactory","inheritBindingContext","partReplacements","originalAttrName","skipContentProcessing","contentFactory","TargetInstruction","shadowSlot","parentInjectorId","contentExpression","expression","lifting","liftingInstruction","expressions","noExpressions","behaviorInstructions","providers","injectorId","elementInstruction","surrogate","values","slotName","slotFallbackFactory","freeze","viewStrategy","create","validate","loadViewFactory","compose","makeRelativeTo","noop","RelativeViewStrategy","path","absolutePath","viewEngine","compileInstruction","loadContext","moduleId","file","ConventionalViewStrategy","viewLocator","origin","viewUrl","convertOriginToViewUrl","NoViewStrategy","dependencyBaseUrl","entry","factoryIsReady","templateIsLoaded","i","ii","current","from","as","TemplateRegistryViewStrategy","factory","InlineViewStrategy","markup","template","createTemplateFromMarkup","ViewLocator","getViewStrategy","value","constructor","assert","strategy","viewStrategyMetadataKey","Error","createFallbackViewStrategy","substring","mi","BindingLanguage","inspectAttribute","resources","elementName","attrValue","createAttributeInstruction","info","existingInstruction","inspectTextContent","noNodes","SlotCustomAttribute","Element","auSlotAttribute","valueChanged","newValue","oldValue","PassThroughSlot","anchor","destinationName","fallbackFactory","viewSlot","destinationSlot","projections","contentView","attr","renderFallbackContent","view","nodes","projectionSource","ownerView","bind","bindingContext","overrideContext","slots","ShadowDOM","distributeView","passThroughTo","addNode","removeNodes","detached","unbind","removeView","needsFallbackRendering","removeAll","projectFrom","created","attached","ShadowSlot","isContentProjectionSource","projectFromAnchors","destinationSlots","destination","distributeNodes","auOwnerView","auProjectionSource","auAssignedSlot","_findAnchor","parent","parentNode","insertBefore","undistributeView","hasSlots","find","auSlotProjectFrom","auProjectionChildren","fragment","appendChild","undistributeAll","viewIndex","lastView","projectTo","createComment","insertNodesBefore","slot","fallbackSlots","getSlotName","defaultSlotKey","destinationOverride","childNodes","Array","currentNode","nodeType","lookup","existing","ViewResources","bindingLanguage","hasParent","lookupFunctions","valueConverters","getValueConverter","bindingBehaviors","getBindingBehavior","elements","attributeMap","beforeCompile","afterCompile","beforeCreate","afterCreate","beforeBind","beforeUnbind","_tryAddHook","obj","func","counter","callbackName","toString","_invokeHook","one","two","three","four","hooks","getBindingLanguage","bindingLanguageFallback","patchInParent","newParent","originalParent","relativeToView","registerElement","tagName","getElement","mapAttribute","registerAttribute","knownAttribute","getAttribute","registerValueConverter","valueConverter","registerBindingBehavior","bindingBehavior","registerValue","getValue","View","controllers","bindings","firstChild","lastChild","fromCache","isBound","isAttached","controller","viewModelScope","animatableElement","_isUserControlled","returnToCache","returnViewToCache","_systemUpdate","addBinding","binding","refNode","appendNodesTo","end","next","nextSibling","getAnimatableElement","contains","ViewSlot","animator","contentSelectors","animateView","direction","transformChildNodesIntoView","last","removeChild","insert","move","sourceIndex","targetIndex","skipAnimation","removeAt","removeMany","viewsToRemove","rmPromises","forEach","animation","removeAction","all","projectToSlots","_projectionAdd","_projectionInsert","_projectionMove","_projectionRemove","_projectionRemoveAt","_projectionRemoveMany","_projectionRemoveAll","ProviderResolver","__providerId__","invoke","providerResolverInstance","elementContainerGet","BoundViewFactory","boundViewFactory","part","elementEvents","compositionTransaction","superGet","createElementContainer","createChild","_resolvers","set","_element","setAttribute","makeElementIntoAnchor","contentElement","replaceNode","applyInstructions","containers","shadowSlots","elementContainer","createBinding","commentAnchor","slotDestination","styleStringToObject","style","split","firstIndexOfColon","trim","styleObjectToString","result","applySurrogateInstruction","currentAttributeValue","styleObject","parentContainer","factoryCreateInstruction","setCacheSize","size","doNotOverrideIfAlreadySet","getCachedView","isCaching","ViewFactory","instructions","cacheSize","cache","Number","MAX_VALUE","parseInt","createInstruction","cachedView","cloneNode","instructables","querySelectorAll","root","instructable","surrogateInstruction","nextInjectorId","getNextInjectorId","lastAUTargetID","getNextAUTargetID","makeIntoInstructionTarget","auTargetID","makeShadowSlot","compiler","auShadowSlot","createElement","innerHTML","createDocumentFragment","compile","ViewCompiler","source","content","adoptNode","shadowDOM","_compileNode","targetId","ins","_compileSurrogate","targetLightDOM","_compileElement","wholeText","marker","currentChild","property","hasValues","defaultBindingMode","command","hasOptions","primaryProperty","alteredAttr","discrete","_configureProperties","liftsContent","attrToRemove","removeAttribute","elementProperty","targetProperty","ResourceModule","moduleInstance","mainResource","isInitialized","onLoaded","vs","metadata","main","loads","ResourceDescription","exportedValue","resourceTypeMeta","HtmlBehaviorResource","attributeName","ModuleAnalyzer","getAnalysis","analyze","mainResourceKey","fallbackValue","fallbackKey","conventional","resourceModule","decorates","logger","getLogger","ensureRegistryEntry","loader","urlOrRegistryEntry","loadTemplate","ProxyViewFactory","promise","ViewEngine","viewCompiler","moduleAnalyzer","appResources","_pluginMap","auSlotBehavior","addResourcePlugin","extension","implementation","addPlugin","registryEntry","onReady","loadTemplateResources","address","importIds","names","src","viewModelRequires","viewModelRequireMetadataKey","templateImportCount","req","importId","importViewResources","importViewModelResource","moduleImport","moduleMember","loadModule","normalizedId","viewModelModule","moduleIds","_applyLoaderPlugin","loadAllModules","analysis","associatedModule","allAnalysis","imports","lastIndexOf","ext","pluginName","applyPluginToUrl","Controller","scope","observerLookup","observerLocator","getOrCreateObserversLookup","handlesBind","boundProperties","_ensurePropertiesDefined","_initialize","owningView","handlesCreated","automate","skipSelfSubscriber","observer","selfSubscriber","publishing","call","__parentOverrideContext","assign","parentOverrideContext","handlesUnbind","handlesAttached","handlesDetached","BehaviorPropertyObserver","taskQueue","propertyName","initialValue","notqueued","currentValue","setValue","flushing","queueMicroTask","callSubscribers","context","callable","addSubscriber","unsubscribe","removeSubscriber","getObserver","__observers__","BindableProperty","nameOrConfig","oneWay","changeHandler","descriptor","registerWith","_configureDescriptor","configurable","enumerable","defaultValue","initializer","writable","defineOn","handlerName","prototype","defineProperty","createObserver","changeHandlerName","propertyChanged","behaviorHandlesBind","isDynamic","_createDynamicProperty","lastProviderId","nextProviderId","doProcessContent","doProcessAttributes","attributeDefaultBindingMode","shadowDOMOptions","usesShadowDOM","childBindings","hasDynamicOptions","addChildBinding","proto","htmlName","isArray","aliases","alias","transientView","options","hasChildNodes","toReplace","removeNode","viewHost","au","attachShadow","registerInstance","boundary","__propertiesDefined__","createChildObserverDecorator","selectorOrConfig","actualTarget","r","getOrCreateOwn","selector","ChildObserver","config","ChildObserverBinder","noMutations","trackMutation","groupedMutations","binder","record","mutations","onChildChange","binders","bindersLength","Map","added","addedNodes","removed","removedNodes","j","jj","k","onRemove","onAdd","matches","assignedSlot","anchors","__childObserver__","createMutationObserver","childList","subtree","observe","firstElementChild","items","nextElementSibling","prev","previousElementSibling","disconnect","previous","SwapStrategies","before","callback","with","after","tryActivateViewModel","skipActivation","activate","model","CompositionEngine","_swap","swapStrategy","swapOrder","previousViews","currentController","compositionTransactionNotifier","_createControllerAndSwap","createController","compositionTransactionOwnershipToken","childContainer","viewModelResource","m","ensureViewModel","autoRegister","transaction","ElementConfigResource","eventManager","registerElementConfig","validateBehaviorName","newName","warn","override","nameOrConfigOrTarget","key2","descriptor2","prop","defaultShadowDOMOptions","mode","targetOrOptions","processor","error","doNotProcessContent","targetOrDependencies","TemplatingEngine","compositionEngine","_container","_moduleAnalyzer","_viewCompiler","_compositionEngine","configureAnimator","unregister","compilerInstructions","ChildElementCustomElement","WidgetCustomElement","$parent"],"mappings":"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","file":"app-bundle.js","sourcesContent":["import {bindable} from \"aurelia-framework\";\n\nexport class App {\n  constructor() {\n  // changing this property definition to a @bindable throws and exception\n  this.message = \"This is some data that I'll pass to the child of the widget.\";\n\n  }\n}\n","export default {\n  debug: true,\n  testing: true\n};\n","import environment from './environment';\n\nexport function configure(aurelia) {\n  aurelia.use\n    .standardConfiguration()\n    .developmentLogging();\n\n  aurelia.start().then(a => a.setRoot());\n}\n","export function areEqual(obj1, obj2) {\n\treturn Object.keys(obj1).every((key) => obj2.hasOwnProperty(key) && (obj1[key] === obj2[key]));\n};","let latency = 200;\nlet id = 0;\n\nfunction getId(){\n  return ++id;\n}\n\nlet contacts = [\n  {\n    id:getId(),\n    firstName:'John',\n    lastName:'Tolkien',\n    email:'tolkien@inklings.com',\n    phoneNumber:'867-5309'\n  },\n  {\n    id:getId(),\n    firstName:'Clive',\n    lastName:'Lewis',\n    email:'lewis@inklings.com',\n    phoneNumber:'867-5309'\n  },\n  {\n    id:getId(),\n    firstName:'Owen',\n    lastName:'Barfield',\n    email:'barfield@inklings.com',\n    phoneNumber:'867-5309'\n  },\n  {\n    id:getId(),\n    firstName:'Charles',\n    lastName:'Williams',\n    email:'williams@inklings.com',\n    phoneNumber:'867-5309'\n  },\n  {\n    id:getId(),\n    firstName:'Roger',\n    lastName:'Green',\n    email:'green@inklings.com',\n    phoneNumber:'867-5309'\n  }\n];\n\nexport class WebAPI {\n  isRequesting = false;\n  \n  getContactList(){\n    this.isRequesting = true;\n    return new Promise(resolve => {\n      setTimeout(() => {\n        let results = contacts.map(x =>  { return {\n          id:x.id,\n          firstName:x.firstName,\n          lastName:x.lastName,\n          email:x.email\n        }});\n        resolve(results);\n        this.isRequesting = false;\n      }, latency);\n    });\n  }\n\n  getContactDetails(id){\n    this.isRequesting = true;\n    return new Promise(resolve => {\n      setTimeout(() => {\n        let found = contacts.filter(x => x.id == id)[0];\n        resolve(JSON.parse(JSON.stringify(found)));\n        this.isRequesting = false;\n      }, latency);\n    });\n  }\n\n  saveContact(contact){\n    this.isRequesting = true;\n    return new Promise(resolve => {\n      setTimeout(() => {\n        let instance = JSON.parse(JSON.stringify(contact));\n        let found = contacts.filter(x => x.id == contact.id)[0];\n\n        if(found){\n          let index = contacts.indexOf(found);\n          contacts[index] = instance;\n        }else{\n          instance.id = getId();\n          contacts.push(instance);\n        }\n\n        this.isRequesting = false;\n        resolve(instance);\n      }, latency);\n    });\n  }\n}\n","var _class, _temp, _dec, _class2, _dec2, _class3, _dec3, _class4, _dec4, _class5, _dec5, _class6, _class7, _temp2, _dec6, _class8, _class9, _temp3, _class11, _dec7, _class13, _dec8, _class14, _class15, _temp4, _dec9, _class16, _dec10, _class17, _dec11, _class18;\n\nimport * as LogManager from 'aurelia-logging';\nimport { metadata, Origin, protocol } from 'aurelia-metadata';\nimport { DOM, PLATFORM, FEATURE } from 'aurelia-pal';\nimport { relativeToFile } from 'aurelia-path';\nimport { TemplateRegistryEntry, Loader } from 'aurelia-loader';\nimport { inject, Container, resolver } from 'aurelia-dependency-injection';\nimport { Binding, createOverrideContext, ValueConverterResource, BindingBehaviorResource, subscriberCollection, bindingMode, ObserverLocator, EventManager } from 'aurelia-binding';\nimport { TaskQueue } from 'aurelia-task-queue';\n\nexport const animationEvent = {\n  enterBegin: 'animation:enter:begin',\n  enterActive: 'animation:enter:active',\n  enterDone: 'animation:enter:done',\n  enterTimeout: 'animation:enter:timeout',\n\n  leaveBegin: 'animation:leave:begin',\n  leaveActive: 'animation:leave:active',\n  leaveDone: 'animation:leave:done',\n  leaveTimeout: 'animation:leave:timeout',\n\n  staggerNext: 'animation:stagger:next',\n\n  removeClassBegin: 'animation:remove-class:begin',\n  removeClassActive: 'animation:remove-class:active',\n  removeClassDone: 'animation:remove-class:done',\n  removeClassTimeout: 'animation:remove-class:timeout',\n\n  addClassBegin: 'animation:add-class:begin',\n  addClassActive: 'animation:add-class:active',\n  addClassDone: 'animation:add-class:done',\n  addClassTimeout: 'animation:add-class:timeout',\n\n  animateBegin: 'animation:animate:begin',\n  animateActive: 'animation:animate:active',\n  animateDone: 'animation:animate:done',\n  animateTimeout: 'animation:animate:timeout',\n\n  sequenceBegin: 'animation:sequence:begin',\n  sequenceDone: 'animation:sequence:done'\n};\n\nexport let Animator = class Animator {\n  enter(element) {\n    return Promise.resolve(false);\n  }\n\n  leave(element) {\n    return Promise.resolve(false);\n  }\n\n  removeClass(element, className) {\n    element.classList.remove(className);\n    return Promise.resolve(false);\n  }\n\n  addClass(element, className) {\n    element.classList.add(className);\n    return Promise.resolve(false);\n  }\n\n  animate(element, className) {\n    return Promise.resolve(false);\n  }\n\n  runSequence(animations) {}\n\n  registerEffect(effectName, properties) {}\n\n  unregisterEffect(effectName) {}\n};\n\nexport let CompositionTransactionNotifier = class CompositionTransactionNotifier {\n  constructor(owner) {\n    this.owner = owner;\n    this.owner._compositionCount++;\n  }\n\n  done() {\n    this.owner._compositionCount--;\n    this.owner._tryCompleteTransaction();\n  }\n};\n\nexport let CompositionTransactionOwnershipToken = class CompositionTransactionOwnershipToken {\n  constructor(owner) {\n    this.owner = owner;\n    this.owner._ownershipToken = this;\n    this.thenable = this._createThenable();\n  }\n\n  waitForCompositionComplete() {\n    this.owner._tryCompleteTransaction();\n    return this.thenable;\n  }\n\n  resolve() {\n    this._resolveCallback();\n  }\n\n  _createThenable() {\n    return new Promise((resolve, reject) => {\n      this._resolveCallback = resolve;\n    });\n  }\n};\n\nexport let CompositionTransaction = class CompositionTransaction {\n  constructor() {\n    this._ownershipToken = null;\n    this._compositionCount = 0;\n  }\n\n  tryCapture() {\n    return this._ownershipToken === null ? new CompositionTransactionOwnershipToken(this) : null;\n  }\n\n  enlist() {\n    return new CompositionTransactionNotifier(this);\n  }\n\n  _tryCompleteTransaction() {\n    if (this._compositionCount <= 0) {\n      this._compositionCount = 0;\n\n      if (this._ownershipToken !== null) {\n        let token = this._ownershipToken;\n        this._ownershipToken = null;\n        token.resolve();\n      }\n    }\n  }\n};\n\nconst capitalMatcher = /([A-Z])/g;\n\nfunction addHyphenAndLower(char) {\n  return '-' + char.toLowerCase();\n}\n\nexport function _hyphenate(name) {\n  return (name.charAt(0).toLowerCase() + name.slice(1)).replace(capitalMatcher, addHyphenAndLower);\n}\n\nexport function _isAllWhitespace(node) {\n  return !(node.auInterpolationTarget || /[^\\t\\n\\r ]/.test(node.textContent));\n}\n\nexport let ViewEngineHooksResource = class ViewEngineHooksResource {\n  constructor() {}\n\n  initialize(container, target) {\n    this.instance = container.get(target);\n  }\n\n  register(registry, name) {\n    registry.registerViewEngineHooks(this.instance);\n  }\n\n  load(container, target) {}\n\n  static convention(name) {\n    if (name.endsWith('ViewEngineHooks')) {\n      return new ViewEngineHooksResource();\n    }\n  }\n};\n\nexport function viewEngineHooks(target) {\n  let deco = function (t) {\n    metadata.define(metadata.resource, new ViewEngineHooksResource(), t);\n  };\n\n  return target ? deco(target) : deco;\n}\n\nexport let ElementEvents = class ElementEvents {\n  constructor(element) {\n    this.element = element;\n    this.subscriptions = {};\n  }\n\n  _enqueueHandler(handler) {\n    this.subscriptions[handler.eventName] = this.subscriptions[handler.eventName] || [];\n    this.subscriptions[handler.eventName].push(handler);\n  }\n\n  _dequeueHandler(handler) {\n    let index;\n    let subscriptions = this.subscriptions[handler.eventName];\n    if (subscriptions) {\n      index = subscriptions.indexOf(handler);\n      if (index > -1) {\n        subscriptions.splice(index, 1);\n      }\n    }\n    return handler;\n  }\n\n  publish(eventName, detail = {}, bubbles = true, cancelable = true) {\n    let event = DOM.createCustomEvent(eventName, { cancelable, bubbles, detail });\n    this.element.dispatchEvent(event);\n  }\n\n  subscribe(eventName, handler, bubbles = true) {\n    if (handler && typeof handler === 'function') {\n      handler.eventName = eventName;\n      handler.handler = handler;\n      handler.bubbles = bubbles;\n      handler.dispose = () => {\n        this.element.removeEventListener(eventName, handler, bubbles);\n        this._dequeueHandler(handler);\n      };\n      this.element.addEventListener(eventName, handler, bubbles);\n      this._enqueueHandler(handler);\n      return handler;\n    }\n\n    return undefined;\n  }\n\n  subscribeOnce(eventName, handler, bubbles = true) {\n    if (handler && typeof handler === 'function') {\n      let _handler = event => {\n        handler(event);\n        _handler.dispose();\n      };\n      return this.subscribe(eventName, _handler, bubbles);\n    }\n\n    return undefined;\n  }\n\n  dispose(eventName) {\n    if (eventName && typeof eventName === 'string') {\n      let subscriptions = this.subscriptions[eventName];\n      if (subscriptions) {\n        while (subscriptions.length) {\n          let subscription = subscriptions.pop();\n          if (subscription) {\n            subscription.dispose();\n          }\n        }\n      }\n    } else {\n      this.disposeAll();\n    }\n  }\n\n  disposeAll() {\n    for (let key in this.subscriptions) {\n      this.dispose(key);\n    }\n  }\n};\n\nexport let ResourceLoadContext = class ResourceLoadContext {\n  constructor() {\n    this.dependencies = {};\n  }\n\n  addDependency(url) {\n    this.dependencies[url] = true;\n  }\n\n  hasDependency(url) {\n    return url in this.dependencies;\n  }\n};\n\nexport let ViewCompileInstruction = class ViewCompileInstruction {\n  constructor(targetShadowDOM = false, compileSurrogate = false) {\n    this.targetShadowDOM = targetShadowDOM;\n    this.compileSurrogate = compileSurrogate;\n    this.associatedModuleId = null;\n  }\n};\n\nViewCompileInstruction.normal = new ViewCompileInstruction();\n\nexport let BehaviorInstruction = class BehaviorInstruction {\n  static enhance() {\n    let instruction = new BehaviorInstruction();\n    instruction.enhance = true;\n    return instruction;\n  }\n\n  static unitTest(type, attributes) {\n    let instruction = new BehaviorInstruction();\n    instruction.type = type;\n    instruction.attributes = attributes || {};\n    return instruction;\n  }\n\n  static element(node, type) {\n    let instruction = new BehaviorInstruction();\n    instruction.type = type;\n    instruction.attributes = {};\n    instruction.anchorIsContainer = !(node.hasAttribute('containerless') || type.containerless);\n    instruction.initiatedByBehavior = true;\n    return instruction;\n  }\n\n  static attribute(attrName, type) {\n    let instruction = new BehaviorInstruction();\n    instruction.attrName = attrName;\n    instruction.type = type || null;\n    instruction.attributes = {};\n    return instruction;\n  }\n\n  static dynamic(host, viewModel, viewFactory) {\n    let instruction = new BehaviorInstruction();\n    instruction.host = host;\n    instruction.viewModel = viewModel;\n    instruction.viewFactory = viewFactory;\n    instruction.inheritBindingContext = true;\n    return instruction;\n  }\n\n  constructor() {\n    this.initiatedByBehavior = false;\n    this.enhance = false;\n    this.partReplacements = null;\n    this.viewFactory = null;\n    this.originalAttrName = null;\n    this.skipContentProcessing = false;\n    this.contentFactory = null;\n    this.viewModel = null;\n    this.anchorIsContainer = false;\n    this.host = null;\n    this.attributes = null;\n    this.type = null;\n    this.attrName = null;\n    this.inheritBindingContext = false;\n  }\n};\n\nBehaviorInstruction.normal = new BehaviorInstruction();\n\nexport let TargetInstruction = (_temp = _class = class TargetInstruction {\n  static shadowSlot(parentInjectorId) {\n    let instruction = new TargetInstruction();\n    instruction.parentInjectorId = parentInjectorId;\n    instruction.shadowSlot = true;\n    return instruction;\n  }\n\n  static contentExpression(expression) {\n    let instruction = new TargetInstruction();\n    instruction.contentExpression = expression;\n    return instruction;\n  }\n\n  static lifting(parentInjectorId, liftingInstruction) {\n    let instruction = new TargetInstruction();\n    instruction.parentInjectorId = parentInjectorId;\n    instruction.expressions = TargetInstruction.noExpressions;\n    instruction.behaviorInstructions = [liftingInstruction];\n    instruction.viewFactory = liftingInstruction.viewFactory;\n    instruction.providers = [liftingInstruction.type.target];\n    instruction.lifting = true;\n    return instruction;\n  }\n\n  static normal(injectorId, parentInjectorId, providers, behaviorInstructions, expressions, elementInstruction) {\n    let instruction = new TargetInstruction();\n    instruction.injectorId = injectorId;\n    instruction.parentInjectorId = parentInjectorId;\n    instruction.providers = providers;\n    instruction.behaviorInstructions = behaviorInstructions;\n    instruction.expressions = expressions;\n    instruction.anchorIsContainer = elementInstruction ? elementInstruction.anchorIsContainer : true;\n    instruction.elementInstruction = elementInstruction;\n    return instruction;\n  }\n\n  static surrogate(providers, behaviorInstructions, expressions, values) {\n    let instruction = new TargetInstruction();\n    instruction.expressions = expressions;\n    instruction.behaviorInstructions = behaviorInstructions;\n    instruction.providers = providers;\n    instruction.values = values;\n    return instruction;\n  }\n\n  constructor() {\n    this.injectorId = null;\n    this.parentInjectorId = null;\n\n    this.shadowSlot = false;\n    this.slotName = null;\n    this.slotFallbackFactory = null;\n\n    this.contentExpression = null;\n\n    this.expressions = null;\n    this.behaviorInstructions = null;\n    this.providers = null;\n\n    this.viewFactory = null;\n\n    this.anchorIsContainer = false;\n    this.elementInstruction = null;\n    this.lifting = false;\n\n    this.values = null;\n  }\n}, _class.noExpressions = Object.freeze([]), _temp);\n\nexport const viewStrategy = protocol.create('aurelia:view-strategy', {\n  validate(target) {\n    if (!(typeof target.loadViewFactory === 'function')) {\n      return 'View strategies must implement: loadViewFactory(viewEngine: ViewEngine, compileInstruction: ViewCompileInstruction, loadContext?: ResourceLoadContext): Promise<ViewFactory>';\n    }\n\n    return true;\n  },\n  compose(target) {\n    if (!(typeof target.makeRelativeTo === 'function')) {\n      target.makeRelativeTo = PLATFORM.noop;\n    }\n  }\n});\n\nexport let RelativeViewStrategy = (_dec = viewStrategy(), _dec(_class2 = class RelativeViewStrategy {\n  constructor(path) {\n    this.path = path;\n    this.absolutePath = null;\n  }\n\n  loadViewFactory(viewEngine, compileInstruction, loadContext, target) {\n    if (this.absolutePath === null && this.moduleId) {\n      this.absolutePath = relativeToFile(this.path, this.moduleId);\n    }\n\n    compileInstruction.associatedModuleId = this.moduleId;\n    return viewEngine.loadViewFactory(this.absolutePath || this.path, compileInstruction, loadContext, target);\n  }\n\n  makeRelativeTo(file) {\n    if (this.absolutePath === null) {\n      this.absolutePath = relativeToFile(this.path, file);\n    }\n  }\n}) || _class2);\n\nexport let ConventionalViewStrategy = (_dec2 = viewStrategy(), _dec2(_class3 = class ConventionalViewStrategy {\n  constructor(viewLocator, origin) {\n    this.moduleId = origin.moduleId;\n    this.viewUrl = viewLocator.convertOriginToViewUrl(origin);\n  }\n\n  loadViewFactory(viewEngine, compileInstruction, loadContext, target) {\n    compileInstruction.associatedModuleId = this.moduleId;\n    return viewEngine.loadViewFactory(this.viewUrl, compileInstruction, loadContext, target);\n  }\n}) || _class3);\n\nexport let NoViewStrategy = (_dec3 = viewStrategy(), _dec3(_class4 = class NoViewStrategy {\n  constructor(dependencies, dependencyBaseUrl) {\n    this.dependencies = dependencies || null;\n    this.dependencyBaseUrl = dependencyBaseUrl || '';\n  }\n\n  loadViewFactory(viewEngine, compileInstruction, loadContext, target) {\n    let entry = this.entry;\n    let dependencies = this.dependencies;\n\n    if (entry && entry.factoryIsReady) {\n      return Promise.resolve(null);\n    }\n\n    this.entry = entry = new TemplateRegistryEntry(this.moduleId || this.dependencyBaseUrl);\n\n    entry.dependencies = [];\n    entry.templateIsLoaded = true;\n\n    if (dependencies !== null) {\n      for (let i = 0, ii = dependencies.length; i < ii; ++i) {\n        let current = dependencies[i];\n\n        if (typeof current === 'string' || typeof current === 'function') {\n          entry.addDependency(current);\n        } else {\n          entry.addDependency(current.from, current.as);\n        }\n      }\n    }\n\n    compileInstruction.associatedModuleId = this.moduleId;\n\n    return viewEngine.loadViewFactory(entry, compileInstruction, loadContext, target);\n  }\n}) || _class4);\n\nexport let TemplateRegistryViewStrategy = (_dec4 = viewStrategy(), _dec4(_class5 = class TemplateRegistryViewStrategy {\n  constructor(moduleId, entry) {\n    this.moduleId = moduleId;\n    this.entry = entry;\n  }\n\n  loadViewFactory(viewEngine, compileInstruction, loadContext, target) {\n    let entry = this.entry;\n\n    if (entry.factoryIsReady) {\n      return Promise.resolve(entry.factory);\n    }\n\n    compileInstruction.associatedModuleId = this.moduleId;\n    return viewEngine.loadViewFactory(entry, compileInstruction, loadContext, target);\n  }\n}) || _class5);\n\nexport let InlineViewStrategy = (_dec5 = viewStrategy(), _dec5(_class6 = class InlineViewStrategy {\n  constructor(markup, dependencies, dependencyBaseUrl) {\n    this.markup = markup;\n    this.dependencies = dependencies || null;\n    this.dependencyBaseUrl = dependencyBaseUrl || '';\n  }\n\n  loadViewFactory(viewEngine, compileInstruction, loadContext, target) {\n    let entry = this.entry;\n    let dependencies = this.dependencies;\n\n    if (entry && entry.factoryIsReady) {\n      return Promise.resolve(entry.factory);\n    }\n\n    this.entry = entry = new TemplateRegistryEntry(this.moduleId || this.dependencyBaseUrl);\n    entry.template = DOM.createTemplateFromMarkup(this.markup);\n\n    if (dependencies !== null) {\n      for (let i = 0, ii = dependencies.length; i < ii; ++i) {\n        let current = dependencies[i];\n\n        if (typeof current === 'string' || typeof current === 'function') {\n          entry.addDependency(current);\n        } else {\n          entry.addDependency(current.from, current.as);\n        }\n      }\n    }\n\n    compileInstruction.associatedModuleId = this.moduleId;\n    return viewEngine.loadViewFactory(entry, compileInstruction, loadContext, target);\n  }\n}) || _class6);\n\nexport let ViewLocator = (_temp2 = _class7 = class ViewLocator {\n  getViewStrategy(value) {\n    if (!value) {\n      return null;\n    }\n\n    if (typeof value === 'object' && 'getViewStrategy' in value) {\n      let origin = Origin.get(value.constructor);\n\n      value = value.getViewStrategy();\n\n      if (typeof value === 'string') {\n        value = new RelativeViewStrategy(value);\n      }\n\n      viewStrategy.assert(value);\n\n      if (origin.moduleId) {\n        value.makeRelativeTo(origin.moduleId);\n      }\n\n      return value;\n    }\n\n    if (typeof value === 'string') {\n      value = new RelativeViewStrategy(value);\n    }\n\n    if (viewStrategy.validate(value)) {\n      return value;\n    }\n\n    if (typeof value !== 'function') {\n      value = value.constructor;\n    }\n\n    let origin = Origin.get(value);\n    let strategy = metadata.get(ViewLocator.viewStrategyMetadataKey, value);\n\n    if (!strategy) {\n      if (!origin.moduleId) {\n        throw new Error('Cannot determine default view strategy for object.', value);\n      }\n\n      strategy = this.createFallbackViewStrategy(origin);\n    } else if (origin.moduleId) {\n      strategy.moduleId = origin.moduleId;\n    }\n\n    return strategy;\n  }\n\n  createFallbackViewStrategy(origin) {\n    return new ConventionalViewStrategy(this, origin);\n  }\n\n  convertOriginToViewUrl(origin) {\n    let moduleId = origin.moduleId;\n    let id = moduleId.endsWith('.js') || moduleId.endsWith('.ts') ? moduleId.substring(0, moduleId.length - 3) : moduleId;\n    return id + '.html';\n  }\n}, _class7.viewStrategyMetadataKey = 'aurelia:view-strategy', _temp2);\n\nfunction mi(name) {\n  throw new Error(`BindingLanguage must implement ${ name }().`);\n}\n\nexport let BindingLanguage = class BindingLanguage {\n  inspectAttribute(resources, elementName, attrName, attrValue) {\n    mi('inspectAttribute');\n  }\n\n  createAttributeInstruction(resources, element, info, existingInstruction) {\n    mi('createAttributeInstruction');\n  }\n\n  inspectTextContent(resources, value) {\n    mi('inspectTextContent');\n  }\n};\n\nlet noNodes = Object.freeze([]);\n\nexport let SlotCustomAttribute = (_dec6 = inject(DOM.Element), _dec6(_class8 = class SlotCustomAttribute {\n  constructor(element) {\n    this.element = element;\n    this.element.auSlotAttribute = this;\n  }\n\n  valueChanged(newValue, oldValue) {}\n}) || _class8);\n\nexport let PassThroughSlot = class PassThroughSlot {\n  constructor(anchor, name, destinationName, fallbackFactory) {\n    this.anchor = anchor;\n    this.anchor.viewSlot = this;\n    this.name = name;\n    this.destinationName = destinationName;\n    this.fallbackFactory = fallbackFactory;\n    this.destinationSlot = null;\n    this.projections = 0;\n    this.contentView = null;\n\n    let attr = new SlotCustomAttribute(this.anchor);\n    attr.value = this.destinationName;\n  }\n\n  get needsFallbackRendering() {\n    return this.fallbackFactory && this.projections === 0;\n  }\n\n  renderFallbackContent(view, nodes, projectionSource, index) {\n    if (this.contentView === null) {\n      this.contentView = this.fallbackFactory.create(this.ownerView.container);\n      this.contentView.bind(this.ownerView.bindingContext, this.ownerView.overrideContext);\n\n      let slots = Object.create(null);\n      slots[this.destinationSlot.name] = this.destinationSlot;\n\n      ShadowDOM.distributeView(this.contentView, slots, projectionSource, index, this.destinationSlot.name);\n    }\n  }\n\n  passThroughTo(destinationSlot) {\n    this.destinationSlot = destinationSlot;\n  }\n\n  addNode(view, node, projectionSource, index) {\n    if (this.contentView !== null) {\n      this.contentView.removeNodes();\n      this.contentView.detached();\n      this.contentView.unbind();\n      this.contentView = null;\n    }\n\n    if (node.viewSlot instanceof PassThroughSlot) {\n      node.viewSlot.passThroughTo(this);\n      return;\n    }\n\n    this.projections++;\n    this.destinationSlot.addNode(view, node, projectionSource, index);\n  }\n\n  removeView(view, projectionSource) {\n    this.projections--;\n    this.destinationSlot.removeView(view, projectionSource);\n\n    if (this.needsFallbackRendering) {\n      this.renderFallbackContent(null, noNodes, projectionSource);\n    }\n  }\n\n  removeAll(projectionSource) {\n    this.projections = 0;\n    this.destinationSlot.removeAll(projectionSource);\n\n    if (this.needsFallbackRendering) {\n      this.renderFallbackContent(null, noNodes, projectionSource);\n    }\n  }\n\n  projectFrom(view, projectionSource) {\n    this.destinationSlot.projectFrom(view, projectionSource);\n  }\n\n  created(ownerView) {\n    this.ownerView = ownerView;\n  }\n\n  bind(view) {\n    if (this.contentView) {\n      this.contentView.bind(view.bindingContext, view.overrideContext);\n    }\n  }\n\n  attached() {\n    if (this.contentView) {\n      this.contentView.attached();\n    }\n  }\n\n  detached() {\n    if (this.contentView) {\n      this.contentView.detached();\n    }\n  }\n\n  unbind() {\n    if (this.contentView) {\n      this.contentView.unbind();\n    }\n  }\n};\n\nexport let ShadowSlot = class ShadowSlot {\n  constructor(anchor, name, fallbackFactory) {\n    this.anchor = anchor;\n    this.anchor.isContentProjectionSource = true;\n    this.anchor.viewSlot = this;\n    this.name = name;\n    this.fallbackFactory = fallbackFactory;\n    this.contentView = null;\n    this.projections = 0;\n    this.children = [];\n    this.projectFromAnchors = null;\n    this.destinationSlots = null;\n  }\n\n  get needsFallbackRendering() {\n    return this.fallbackFactory && this.projections === 0;\n  }\n\n  addNode(view, node, projectionSource, index, destination) {\n    if (this.contentView !== null) {\n      this.contentView.removeNodes();\n      this.contentView.detached();\n      this.contentView.unbind();\n      this.contentView = null;\n    }\n\n    if (node.viewSlot instanceof PassThroughSlot) {\n      node.viewSlot.passThroughTo(this);\n      return;\n    }\n\n    if (this.destinationSlots !== null) {\n      ShadowDOM.distributeNodes(view, [node], this.destinationSlots, this, index);\n    } else {\n      node.auOwnerView = view;\n      node.auProjectionSource = projectionSource;\n      node.auAssignedSlot = this;\n\n      let anchor = this._findAnchor(view, node, projectionSource, index);\n      let parent = anchor.parentNode;\n\n      parent.insertBefore(node, anchor);\n      this.children.push(node);\n      this.projections++;\n    }\n  }\n\n  removeView(view, projectionSource) {\n    if (this.destinationSlots !== null) {\n      ShadowDOM.undistributeView(view, this.destinationSlots, this);\n    } else if (this.contentView && this.contentView.hasSlots) {\n      ShadowDOM.undistributeView(view, this.contentView.slots, projectionSource);\n    } else {\n      let found = this.children.find(x => x.auSlotProjectFrom === projectionSource);\n      if (found) {\n        let children = found.auProjectionChildren;\n\n        for (let i = 0, ii = children.length; i < ii; ++i) {\n          let child = children[i];\n\n          if (child.auOwnerView === view) {\n            children.splice(i, 1);\n            view.fragment.appendChild(child);\n            i--;ii--;\n            this.projections--;\n          }\n        }\n\n        if (this.needsFallbackRendering) {\n          this.renderFallbackContent(view, noNodes, projectionSource);\n        }\n      }\n    }\n  }\n\n  removeAll(projectionSource) {\n    if (this.destinationSlots !== null) {\n      ShadowDOM.undistributeAll(this.destinationSlots, this);\n    } else if (this.contentView && this.contentView.hasSlots) {\n      ShadowDOM.undistributeAll(this.contentView.slots, projectionSource);\n    } else {\n      let found = this.children.find(x => x.auSlotProjectFrom === projectionSource);\n\n      if (found) {\n        let children = found.auProjectionChildren;\n        for (let i = 0, ii = children.length; i < ii; ++i) {\n          let child = children[i];\n          child.auOwnerView.fragment.appendChild(child);\n          this.projections--;\n        }\n\n        found.auProjectionChildren = [];\n\n        if (this.needsFallbackRendering) {\n          this.renderFallbackContent(null, noNodes, projectionSource);\n        }\n      }\n    }\n  }\n\n  _findAnchor(view, node, projectionSource, index) {\n    if (projectionSource) {\n      let found = this.children.find(x => x.auSlotProjectFrom === projectionSource);\n      if (found) {\n        if (index !== undefined) {\n          let children = found.auProjectionChildren;\n          let viewIndex = -1;\n          let lastView;\n\n          for (let i = 0, ii = children.length; i < ii; ++i) {\n            let current = children[i];\n\n            if (current.auOwnerView !== lastView) {\n              viewIndex++;\n              lastView = current.auOwnerView;\n\n              if (viewIndex >= index && lastView !== view) {\n                children.splice(i, 0, node);\n                return current;\n              }\n            }\n          }\n        }\n\n        found.auProjectionChildren.push(node);\n        return found;\n      }\n    }\n\n    return this.anchor;\n  }\n\n  projectTo(slots) {\n    this.destinationSlots = slots;\n  }\n\n  projectFrom(view, projectionSource) {\n    let anchor = DOM.createComment('anchor');\n    let parent = this.anchor.parentNode;\n    anchor.auSlotProjectFrom = projectionSource;\n    anchor.auOwnerView = view;\n    anchor.auProjectionChildren = [];\n    parent.insertBefore(anchor, this.anchor);\n    this.children.push(anchor);\n\n    if (this.projectFromAnchors === null) {\n      this.projectFromAnchors = [];\n    }\n\n    this.projectFromAnchors.push(anchor);\n  }\n\n  renderFallbackContent(view, nodes, projectionSource, index) {\n    if (this.contentView === null) {\n      this.contentView = this.fallbackFactory.create(this.ownerView.container);\n      this.contentView.bind(this.ownerView.bindingContext, this.ownerView.overrideContext);\n      this.contentView.insertNodesBefore(this.anchor);\n    }\n\n    if (this.contentView.hasSlots) {\n      let slots = this.contentView.slots;\n      let projectFromAnchors = this.projectFromAnchors;\n\n      if (projectFromAnchors !== null) {\n        for (let slotName in slots) {\n          let slot = slots[slotName];\n\n          for (let i = 0, ii = projectFromAnchors.length; i < ii; ++i) {\n            let anchor = projectFromAnchors[i];\n            slot.projectFrom(anchor.auOwnerView, anchor.auSlotProjectFrom);\n          }\n        }\n      }\n\n      this.fallbackSlots = slots;\n      ShadowDOM.distributeNodes(view, nodes, slots, projectionSource, index);\n    }\n  }\n\n  created(ownerView) {\n    this.ownerView = ownerView;\n  }\n\n  bind(view) {\n    if (this.contentView) {\n      this.contentView.bind(view.bindingContext, view.overrideContext);\n    }\n  }\n\n  attached() {\n    if (this.contentView) {\n      this.contentView.attached();\n    }\n  }\n\n  detached() {\n    if (this.contentView) {\n      this.contentView.detached();\n    }\n  }\n\n  unbind() {\n    if (this.contentView) {\n      this.contentView.unbind();\n    }\n  }\n};\n\nexport let ShadowDOM = (_temp3 = _class9 = class ShadowDOM {\n\n  static getSlotName(node) {\n    if (node.auSlotAttribute === undefined) {\n      return ShadowDOM.defaultSlotKey;\n    }\n\n    return node.auSlotAttribute.value;\n  }\n\n  static distributeView(view, slots, projectionSource, index, destinationOverride) {\n    let nodes;\n\n    if (view === null) {\n      nodes = noNodes;\n    } else {\n      let childNodes = view.fragment.childNodes;\n      let ii = childNodes.length;\n      nodes = new Array(ii);\n\n      for (let i = 0; i < ii; ++i) {\n        nodes[i] = childNodes[i];\n      }\n    }\n\n    ShadowDOM.distributeNodes(view, nodes, slots, projectionSource, index, destinationOverride);\n  }\n\n  static undistributeView(view, slots, projectionSource) {\n    for (let slotName in slots) {\n      slots[slotName].removeView(view, projectionSource);\n    }\n  }\n\n  static undistributeAll(slots, projectionSource) {\n    for (let slotName in slots) {\n      slots[slotName].removeAll(projectionSource);\n    }\n  }\n\n  static distributeNodes(view, nodes, slots, projectionSource, index, destinationOverride) {\n    for (let i = 0, ii = nodes.length; i < ii; ++i) {\n      let currentNode = nodes[i];\n      let nodeType = currentNode.nodeType;\n\n      if (currentNode.isContentProjectionSource) {\n        currentNode.viewSlot.projectTo(slots);\n\n        for (let slotName in slots) {\n          slots[slotName].projectFrom(view, currentNode.viewSlot);\n        }\n\n        nodes.splice(i, 1);\n        ii--;i--;\n      } else if (nodeType === 1 || nodeType === 3 || currentNode.viewSlot instanceof PassThroughSlot) {\n        if (nodeType === 3 && _isAllWhitespace(currentNode)) {\n          nodes.splice(i, 1);\n          ii--;i--;\n        } else {\n          let found = slots[destinationOverride || ShadowDOM.getSlotName(currentNode)];\n\n          if (found) {\n            found.addNode(view, currentNode, projectionSource, index);\n            nodes.splice(i, 1);\n            ii--;i--;\n          }\n        }\n      } else {\n        nodes.splice(i, 1);\n        ii--;i--;\n      }\n    }\n\n    for (let slotName in slots) {\n      let slot = slots[slotName];\n\n      if (slot.needsFallbackRendering) {\n        slot.renderFallbackContent(view, nodes, projectionSource, index);\n      }\n    }\n  }\n}, _class9.defaultSlotKey = '__au-default-slot-key__', _temp3);\n\nfunction register(lookup, name, resource, type) {\n  if (!name) {\n    return;\n  }\n\n  let existing = lookup[name];\n  if (existing) {\n    if (existing !== resource) {\n      throw new Error(`Attempted to register ${ type } when one with the same name already exists. Name: ${ name }.`);\n    }\n\n    return;\n  }\n\n  lookup[name] = resource;\n}\n\nexport let ViewResources = class ViewResources {\n  constructor(parent, viewUrl) {\n    this.bindingLanguage = null;\n\n    this.parent = parent || null;\n    this.hasParent = this.parent !== null;\n    this.viewUrl = viewUrl || '';\n    this.lookupFunctions = {\n      valueConverters: this.getValueConverter.bind(this),\n      bindingBehaviors: this.getBindingBehavior.bind(this)\n    };\n    this.attributes = Object.create(null);\n    this.elements = Object.create(null);\n    this.valueConverters = Object.create(null);\n    this.bindingBehaviors = Object.create(null);\n    this.attributeMap = Object.create(null);\n    this.values = Object.create(null);\n    this.beforeCompile = this.afterCompile = this.beforeCreate = this.afterCreate = this.beforeBind = this.beforeUnbind = false;\n  }\n\n  _tryAddHook(obj, name) {\n    if (typeof obj[name] === 'function') {\n      let func = obj[name].bind(obj);\n      let counter = 1;\n      let callbackName;\n\n      while (this[callbackName = name + counter.toString()] !== undefined) {\n        counter++;\n      }\n\n      this[name] = true;\n      this[callbackName] = func;\n    }\n  }\n\n  _invokeHook(name, one, two, three, four) {\n    if (this.hasParent) {\n      this.parent._invokeHook(name, one, two, three, four);\n    }\n\n    if (this[name]) {\n      this[name + '1'](one, two, three, four);\n\n      let callbackName = name + '2';\n      if (this[callbackName]) {\n        this[callbackName](one, two, three, four);\n\n        callbackName = name + '3';\n        if (this[callbackName]) {\n          this[callbackName](one, two, three, four);\n\n          let counter = 4;\n\n          while (this[callbackName = name + counter.toString()] !== undefined) {\n            this[callbackName](one, two, three, four);\n            counter++;\n          }\n        }\n      }\n    }\n  }\n\n  registerViewEngineHooks(hooks) {\n    this._tryAddHook(hooks, 'beforeCompile');\n    this._tryAddHook(hooks, 'afterCompile');\n    this._tryAddHook(hooks, 'beforeCreate');\n    this._tryAddHook(hooks, 'afterCreate');\n    this._tryAddHook(hooks, 'beforeBind');\n    this._tryAddHook(hooks, 'beforeUnbind');\n  }\n\n  getBindingLanguage(bindingLanguageFallback) {\n    return this.bindingLanguage || (this.bindingLanguage = bindingLanguageFallback);\n  }\n\n  patchInParent(newParent) {\n    let originalParent = this.parent;\n\n    this.parent = newParent || null;\n    this.hasParent = this.parent !== null;\n\n    if (newParent.parent === null) {\n      newParent.parent = originalParent;\n      newParent.hasParent = originalParent !== null;\n    }\n  }\n\n  relativeToView(path) {\n    return relativeToFile(path, this.viewUrl);\n  }\n\n  registerElement(tagName, behavior) {\n    register(this.elements, tagName, behavior, 'an Element');\n  }\n\n  getElement(tagName) {\n    return this.elements[tagName] || (this.hasParent ? this.parent.getElement(tagName) : null);\n  }\n\n  mapAttribute(attribute) {\n    return this.attributeMap[attribute] || (this.hasParent ? this.parent.mapAttribute(attribute) : null);\n  }\n\n  registerAttribute(attribute, behavior, knownAttribute) {\n    this.attributeMap[attribute] = knownAttribute;\n    register(this.attributes, attribute, behavior, 'an Attribute');\n  }\n\n  getAttribute(attribute) {\n    return this.attributes[attribute] || (this.hasParent ? this.parent.getAttribute(attribute) : null);\n  }\n\n  registerValueConverter(name, valueConverter) {\n    register(this.valueConverters, name, valueConverter, 'a ValueConverter');\n  }\n\n  getValueConverter(name) {\n    return this.valueConverters[name] || (this.hasParent ? this.parent.getValueConverter(name) : null);\n  }\n\n  registerBindingBehavior(name, bindingBehavior) {\n    register(this.bindingBehaviors, name, bindingBehavior, 'a BindingBehavior');\n  }\n\n  getBindingBehavior(name) {\n    return this.bindingBehaviors[name] || (this.hasParent ? this.parent.getBindingBehavior(name) : null);\n  }\n\n  registerValue(name, value) {\n    register(this.values, name, value, 'a value');\n  }\n\n  getValue(name) {\n    return this.values[name] || (this.hasParent ? this.parent.getValue(name) : null);\n  }\n};\n\nexport let View = class View {\n  constructor(container, viewFactory, fragment, controllers, bindings, children, slots) {\n    this.container = container;\n    this.viewFactory = viewFactory;\n    this.resources = viewFactory.resources;\n    this.fragment = fragment;\n    this.firstChild = fragment.firstChild;\n    this.lastChild = fragment.lastChild;\n    this.controllers = controllers;\n    this.bindings = bindings;\n    this.children = children;\n    this.slots = slots;\n    this.hasSlots = false;\n    this.fromCache = false;\n    this.isBound = false;\n    this.isAttached = false;\n    this.bindingContext = null;\n    this.overrideContext = null;\n    this.controller = null;\n    this.viewModelScope = null;\n    this.animatableElement = undefined;\n    this._isUserControlled = false;\n    this.contentView = null;\n\n    for (let key in slots) {\n      this.hasSlots = true;\n      break;\n    }\n  }\n\n  returnToCache() {\n    this.viewFactory.returnViewToCache(this);\n  }\n\n  created() {\n    let i;\n    let ii;\n    let controllers = this.controllers;\n\n    for (i = 0, ii = controllers.length; i < ii; ++i) {\n      controllers[i].created(this);\n    }\n  }\n\n  bind(bindingContext, overrideContext, _systemUpdate) {\n    let controllers;\n    let bindings;\n    let children;\n    let i;\n    let ii;\n\n    if (_systemUpdate && this._isUserControlled) {\n      return;\n    }\n\n    if (this.isBound) {\n      if (this.bindingContext === bindingContext) {\n        return;\n      }\n\n      this.unbind();\n    }\n\n    this.isBound = true;\n    this.bindingContext = bindingContext;\n    this.overrideContext = overrideContext || createOverrideContext(bindingContext);\n\n    this.resources._invokeHook('beforeBind', this);\n\n    bindings = this.bindings;\n    for (i = 0, ii = bindings.length; i < ii; ++i) {\n      bindings[i].bind(this);\n    }\n\n    if (this.viewModelScope !== null) {\n      bindingContext.bind(this.viewModelScope.bindingContext, this.viewModelScope.overrideContext);\n      this.viewModelScope = null;\n    }\n\n    controllers = this.controllers;\n    for (i = 0, ii = controllers.length; i < ii; ++i) {\n      controllers[i].bind(this);\n    }\n\n    children = this.children;\n    for (i = 0, ii = children.length; i < ii; ++i) {\n      children[i].bind(bindingContext, overrideContext, true);\n    }\n\n    if (this.hasSlots) {\n      ShadowDOM.distributeView(this.contentView, this.slots);\n    }\n  }\n\n  addBinding(binding) {\n    this.bindings.push(binding);\n\n    if (this.isBound) {\n      binding.bind(this);\n    }\n  }\n\n  unbind() {\n    let controllers;\n    let bindings;\n    let children;\n    let i;\n    let ii;\n\n    if (this.isBound) {\n      this.isBound = false;\n      this.resources._invokeHook('beforeUnbind', this);\n\n      if (this.controller !== null) {\n        this.controller.unbind();\n      }\n\n      bindings = this.bindings;\n      for (i = 0, ii = bindings.length; i < ii; ++i) {\n        bindings[i].unbind();\n      }\n\n      controllers = this.controllers;\n      for (i = 0, ii = controllers.length; i < ii; ++i) {\n        controllers[i].unbind();\n      }\n\n      children = this.children;\n      for (i = 0, ii = children.length; i < ii; ++i) {\n        children[i].unbind();\n      }\n\n      this.bindingContext = null;\n      this.overrideContext = null;\n    }\n  }\n\n  insertNodesBefore(refNode) {\n    refNode.parentNode.insertBefore(this.fragment, refNode);\n  }\n\n  appendNodesTo(parent) {\n    parent.appendChild(this.fragment);\n  }\n\n  removeNodes() {\n    let fragment = this.fragment;\n    let current = this.firstChild;\n    let end = this.lastChild;\n    let next;\n\n    while (current) {\n      next = current.nextSibling;\n      fragment.appendChild(current);\n\n      if (current === end) {\n        break;\n      }\n\n      current = next;\n    }\n  }\n\n  attached() {\n    let controllers;\n    let children;\n    let i;\n    let ii;\n\n    if (this.isAttached) {\n      return;\n    }\n\n    this.isAttached = true;\n\n    if (this.controller !== null) {\n      this.controller.attached();\n    }\n\n    controllers = this.controllers;\n    for (i = 0, ii = controllers.length; i < ii; ++i) {\n      controllers[i].attached();\n    }\n\n    children = this.children;\n    for (i = 0, ii = children.length; i < ii; ++i) {\n      children[i].attached();\n    }\n  }\n\n  detached() {\n    let controllers;\n    let children;\n    let i;\n    let ii;\n\n    if (this.isAttached) {\n      this.isAttached = false;\n\n      if (this.controller !== null) {\n        this.controller.detached();\n      }\n\n      controllers = this.controllers;\n      for (i = 0, ii = controllers.length; i < ii; ++i) {\n        controllers[i].detached();\n      }\n\n      children = this.children;\n      for (i = 0, ii = children.length; i < ii; ++i) {\n        children[i].detached();\n      }\n    }\n  }\n};\n\nfunction getAnimatableElement(view) {\n  if (view.animatableElement !== undefined) {\n    return view.animatableElement;\n  }\n\n  let current = view.firstChild;\n\n  while (current && current.nodeType !== 1) {\n    current = current.nextSibling;\n  }\n\n  if (current && current.nodeType === 1) {\n    return view.animatableElement = current.classList.contains('au-animate') ? current : null;\n  }\n\n  return view.animatableElement = null;\n}\n\nexport let ViewSlot = class ViewSlot {\n  constructor(anchor, anchorIsContainer, animator = Animator.instance) {\n    this.anchor = anchor;\n    this.anchorIsContainer = anchorIsContainer;\n    this.bindingContext = null;\n    this.overrideContext = null;\n    this.animator = animator;\n    this.children = [];\n    this.isBound = false;\n    this.isAttached = false;\n    this.contentSelectors = null;\n    anchor.viewSlot = this;\n    anchor.isContentProjectionSource = false;\n  }\n\n  animateView(view, direction = 'enter') {\n    let animatableElement = getAnimatableElement(view);\n\n    if (animatableElement !== null) {\n      switch (direction) {\n        case 'enter':\n          return this.animator.enter(animatableElement);\n        case 'leave':\n          return this.animator.leave(animatableElement);\n        default:\n          throw new Error('Invalid animation direction: ' + direction);\n      }\n    }\n  }\n\n  transformChildNodesIntoView() {\n    let parent = this.anchor;\n\n    this.children.push({\n      fragment: parent,\n      firstChild: parent.firstChild,\n      lastChild: parent.lastChild,\n      returnToCache() {},\n      removeNodes() {\n        let last;\n\n        while (last = parent.lastChild) {\n          parent.removeChild(last);\n        }\n      },\n      created() {},\n      bind() {},\n      unbind() {},\n      attached() {},\n      detached() {}\n    });\n  }\n\n  bind(bindingContext, overrideContext) {\n    let i;\n    let ii;\n    let children;\n\n    if (this.isBound) {\n      if (this.bindingContext === bindingContext) {\n        return;\n      }\n\n      this.unbind();\n    }\n\n    this.isBound = true;\n    this.bindingContext = bindingContext = bindingContext || this.bindingContext;\n    this.overrideContext = overrideContext = overrideContext || this.overrideContext;\n\n    children = this.children;\n    for (i = 0, ii = children.length; i < ii; ++i) {\n      children[i].bind(bindingContext, overrideContext, true);\n    }\n  }\n\n  unbind() {\n    if (this.isBound) {\n      let i;\n      let ii;\n      let children = this.children;\n\n      this.isBound = false;\n      this.bindingContext = null;\n      this.overrideContext = null;\n\n      for (i = 0, ii = children.length; i < ii; ++i) {\n        children[i].unbind();\n      }\n    }\n  }\n\n  add(view) {\n    if (this.anchorIsContainer) {\n      view.appendNodesTo(this.anchor);\n    } else {\n      view.insertNodesBefore(this.anchor);\n    }\n\n    this.children.push(view);\n\n    if (this.isAttached) {\n      view.attached();\n      return this.animateView(view, 'enter');\n    }\n  }\n\n  insert(index, view) {\n    let children = this.children;\n    let length = children.length;\n\n    if (index === 0 && length === 0 || index >= length) {\n      return this.add(view);\n    }\n\n    view.insertNodesBefore(children[index].firstChild);\n    children.splice(index, 0, view);\n\n    if (this.isAttached) {\n      view.attached();\n      return this.animateView(view, 'enter');\n    }\n  }\n\n  move(sourceIndex, targetIndex) {\n    if (sourceIndex === targetIndex) {\n      return;\n    }\n\n    const children = this.children;\n    const view = children[sourceIndex];\n\n    view.removeNodes();\n    view.insertNodesBefore(children[targetIndex].firstChild);\n    children.splice(sourceIndex, 1);\n    children.splice(targetIndex, 0, view);\n  }\n\n  remove(view, returnToCache, skipAnimation) {\n    return this.removeAt(this.children.indexOf(view), returnToCache, skipAnimation);\n  }\n\n  removeMany(viewsToRemove, returnToCache, skipAnimation) {\n    const children = this.children;\n    let ii = viewsToRemove.length;\n    let i;\n    let rmPromises = [];\n\n    viewsToRemove.forEach(child => {\n      if (skipAnimation) {\n        child.removeNodes();\n        return;\n      }\n\n      let animation = this.animateView(child, 'leave');\n      if (animation) {\n        rmPromises.push(animation.then(() => child.removeNodes()));\n      } else {\n        child.removeNodes();\n      }\n    });\n\n    let removeAction = () => {\n      if (this.isAttached) {\n        for (i = 0; i < ii; ++i) {\n          viewsToRemove[i].detached();\n        }\n      }\n\n      if (returnToCache) {\n        for (i = 0; i < ii; ++i) {\n          viewsToRemove[i].returnToCache();\n        }\n      }\n\n      for (i = 0; i < ii; ++i) {\n        const index = children.indexOf(viewsToRemove[i]);\n        if (index >= 0) {\n          children.splice(index, 1);\n        }\n      }\n    };\n\n    if (rmPromises.length > 0) {\n      return Promise.all(rmPromises).then(() => removeAction());\n    }\n\n    return removeAction();\n  }\n\n  removeAt(index, returnToCache, skipAnimation) {\n    let view = this.children[index];\n\n    let removeAction = () => {\n      index = this.children.indexOf(view);\n      view.removeNodes();\n      this.children.splice(index, 1);\n\n      if (this.isAttached) {\n        view.detached();\n      }\n\n      if (returnToCache) {\n        view.returnToCache();\n      }\n\n      return view;\n    };\n\n    if (!skipAnimation) {\n      let animation = this.animateView(view, 'leave');\n      if (animation) {\n        return animation.then(() => removeAction());\n      }\n    }\n\n    return removeAction();\n  }\n\n  removeAll(returnToCache, skipAnimation) {\n    let children = this.children;\n    let ii = children.length;\n    let i;\n    let rmPromises = [];\n\n    children.forEach(child => {\n      if (skipAnimation) {\n        child.removeNodes();\n        return;\n      }\n\n      let animation = this.animateView(child, 'leave');\n      if (animation) {\n        rmPromises.push(animation.then(() => child.removeNodes()));\n      } else {\n        child.removeNodes();\n      }\n    });\n\n    let removeAction = () => {\n      if (this.isAttached) {\n        for (i = 0; i < ii; ++i) {\n          children[i].detached();\n        }\n      }\n\n      if (returnToCache) {\n        for (i = 0; i < ii; ++i) {\n          const child = children[i];\n\n          if (child) {\n            child.returnToCache();\n          }\n        }\n      }\n\n      this.children = [];\n    };\n\n    if (rmPromises.length > 0) {\n      return Promise.all(rmPromises).then(() => removeAction());\n    }\n\n    return removeAction();\n  }\n\n  attached() {\n    let i;\n    let ii;\n    let children;\n    let child;\n\n    if (this.isAttached) {\n      return;\n    }\n\n    this.isAttached = true;\n\n    children = this.children;\n    for (i = 0, ii = children.length; i < ii; ++i) {\n      child = children[i];\n      child.attached();\n      this.animateView(child, 'enter');\n    }\n  }\n\n  detached() {\n    let i;\n    let ii;\n    let children;\n\n    if (this.isAttached) {\n      this.isAttached = false;\n      children = this.children;\n      for (i = 0, ii = children.length; i < ii; ++i) {\n        children[i].detached();\n      }\n    }\n  }\n\n  projectTo(slots) {\n    this.projectToSlots = slots;\n    this.add = this._projectionAdd;\n    this.insert = this._projectionInsert;\n    this.move = this._projectionMove;\n    this.remove = this._projectionRemove;\n    this.removeAt = this._projectionRemoveAt;\n    this.removeMany = this._projectionRemoveMany;\n    this.removeAll = this._projectionRemoveAll;\n    this.children.forEach(view => ShadowDOM.distributeView(view, slots, this));\n  }\n\n  _projectionAdd(view) {\n    ShadowDOM.distributeView(view, this.projectToSlots, this);\n\n    this.children.push(view);\n\n    if (this.isAttached) {\n      view.attached();\n    }\n  }\n\n  _projectionInsert(index, view) {\n    if (index === 0 && !this.children.length || index >= this.children.length) {\n      this.add(view);\n    } else {\n      ShadowDOM.distributeView(view, this.projectToSlots, this, index);\n\n      this.children.splice(index, 0, view);\n\n      if (this.isAttached) {\n        view.attached();\n      }\n    }\n  }\n\n  _projectionMove(sourceIndex, targetIndex) {\n    if (sourceIndex === targetIndex) {\n      return;\n    }\n\n    const children = this.children;\n    const view = children[sourceIndex];\n\n    ShadowDOM.undistributeView(view, this.projectToSlots, this);\n    ShadowDOM.distributeView(view, this.projectToSlots, this, targetIndex);\n\n    children.splice(sourceIndex, 1);\n    children.splice(targetIndex, 0, view);\n  }\n\n  _projectionRemove(view, returnToCache) {\n    ShadowDOM.undistributeView(view, this.projectToSlots, this);\n    this.children.splice(this.children.indexOf(view), 1);\n\n    if (this.isAttached) {\n      view.detached();\n    }\n  }\n\n  _projectionRemoveAt(index, returnToCache) {\n    let view = this.children[index];\n\n    ShadowDOM.undistributeView(view, this.projectToSlots, this);\n    this.children.splice(index, 1);\n\n    if (this.isAttached) {\n      view.detached();\n    }\n  }\n\n  _projectionRemoveMany(viewsToRemove, returnToCache) {\n    viewsToRemove.forEach(view => this.remove(view, returnToCache));\n  }\n\n  _projectionRemoveAll(returnToCache) {\n    ShadowDOM.undistributeAll(this.projectToSlots, this);\n\n    let children = this.children;\n\n    if (this.isAttached) {\n      for (let i = 0, ii = children.length; i < ii; ++i) {\n        children[i].detached();\n      }\n    }\n\n    this.children = [];\n  }\n};\n\nlet ProviderResolver = resolver(_class11 = class ProviderResolver {\n  get(container, key) {\n    let id = key.__providerId__;\n    return id in container ? container[id] : container[id] = container.invoke(key);\n  }\n}) || _class11;\n\nlet providerResolverInstance = new ProviderResolver();\n\nfunction elementContainerGet(key) {\n  if (key === DOM.Element) {\n    return this.element;\n  }\n\n  if (key === BoundViewFactory) {\n    if (this.boundViewFactory) {\n      return this.boundViewFactory;\n    }\n\n    let factory = this.instruction.viewFactory;\n    let partReplacements = this.partReplacements;\n\n    if (partReplacements) {\n      factory = partReplacements[factory.part] || factory;\n    }\n\n    this.boundViewFactory = new BoundViewFactory(this, factory, partReplacements);\n    return this.boundViewFactory;\n  }\n\n  if (key === ViewSlot) {\n    if (this.viewSlot === undefined) {\n      this.viewSlot = new ViewSlot(this.element, this.instruction.anchorIsContainer);\n      this.element.isContentProjectionSource = this.instruction.lifting;\n      this.children.push(this.viewSlot);\n    }\n\n    return this.viewSlot;\n  }\n\n  if (key === ElementEvents) {\n    return this.elementEvents || (this.elementEvents = new ElementEvents(this.element));\n  }\n\n  if (key === CompositionTransaction) {\n    return this.compositionTransaction || (this.compositionTransaction = this.parent.get(key));\n  }\n\n  if (key === ViewResources) {\n    return this.viewResources;\n  }\n\n  if (key === TargetInstruction) {\n    return this.instruction;\n  }\n\n  return this.superGet(key);\n}\n\nfunction createElementContainer(parent, element, instruction, children, partReplacements, resources) {\n  let container = parent.createChild();\n  let providers;\n  let i;\n\n  container.element = element;\n  container.instruction = instruction;\n  container.children = children;\n  container.viewResources = resources;\n  container.partReplacements = partReplacements;\n\n  providers = instruction.providers;\n  i = providers.length;\n\n  while (i--) {\n    container._resolvers.set(providers[i], providerResolverInstance);\n  }\n\n  container.superGet = container.get;\n  container.get = elementContainerGet;\n\n  return container;\n}\n\nfunction hasAttribute(name) {\n  return this._element.hasAttribute(name);\n}\n\nfunction getAttribute(name) {\n  return this._element.getAttribute(name);\n}\n\nfunction setAttribute(name, value) {\n  this._element.setAttribute(name, value);\n}\n\nfunction makeElementIntoAnchor(element, elementInstruction) {\n  let anchor = DOM.createComment('anchor');\n\n  if (elementInstruction) {\n    let firstChild = element.firstChild;\n\n    if (firstChild && firstChild.tagName === 'AU-CONTENT') {\n      anchor.contentElement = firstChild;\n    }\n\n    anchor._element = element;\n\n    anchor.hasAttribute = hasAttribute;\n    anchor.getAttribute = getAttribute;\n    anchor.setAttribute = setAttribute;\n  }\n\n  DOM.replaceNode(anchor, element);\n\n  return anchor;\n}\n\nfunction applyInstructions(containers, element, instruction, controllers, bindings, children, shadowSlots, partReplacements, resources) {\n  let behaviorInstructions = instruction.behaviorInstructions;\n  let expressions = instruction.expressions;\n  let elementContainer;\n  let i;\n  let ii;\n  let current;\n  let instance;\n\n  if (instruction.contentExpression) {\n    bindings.push(instruction.contentExpression.createBinding(element.nextSibling));\n    element.nextSibling.auInterpolationTarget = true;\n    element.parentNode.removeChild(element);\n    return;\n  }\n\n  if (instruction.shadowSlot) {\n    let commentAnchor = DOM.createComment('slot');\n    let slot;\n\n    if (instruction.slotDestination) {\n      slot = new PassThroughSlot(commentAnchor, instruction.slotName, instruction.slotDestination, instruction.slotFallbackFactory);\n    } else {\n      slot = new ShadowSlot(commentAnchor, instruction.slotName, instruction.slotFallbackFactory);\n    }\n\n    DOM.replaceNode(commentAnchor, element);\n    shadowSlots[instruction.slotName] = slot;\n    controllers.push(slot);\n    return;\n  }\n\n  if (behaviorInstructions.length) {\n    if (!instruction.anchorIsContainer) {\n      element = makeElementIntoAnchor(element, instruction.elementInstruction);\n    }\n\n    containers[instruction.injectorId] = elementContainer = createElementContainer(containers[instruction.parentInjectorId], element, instruction, children, partReplacements, resources);\n\n    for (i = 0, ii = behaviorInstructions.length; i < ii; ++i) {\n      current = behaviorInstructions[i];\n      instance = current.type.create(elementContainer, current, element, bindings);\n      controllers.push(instance);\n    }\n  }\n\n  for (i = 0, ii = expressions.length; i < ii; ++i) {\n    bindings.push(expressions[i].createBinding(element));\n  }\n}\n\nfunction styleStringToObject(style, target) {\n  let attributes = style.split(';');\n  let firstIndexOfColon;\n  let i;\n  let current;\n  let key;\n  let value;\n\n  target = target || {};\n\n  for (i = 0; i < attributes.length; i++) {\n    current = attributes[i];\n    firstIndexOfColon = current.indexOf(':');\n    key = current.substring(0, firstIndexOfColon).trim();\n    value = current.substring(firstIndexOfColon + 1).trim();\n    target[key] = value;\n  }\n\n  return target;\n}\n\nfunction styleObjectToString(obj) {\n  let result = '';\n\n  for (let key in obj) {\n    result += key + ':' + obj[key] + ';';\n  }\n\n  return result;\n}\n\nfunction applySurrogateInstruction(container, element, instruction, controllers, bindings, children) {\n  let behaviorInstructions = instruction.behaviorInstructions;\n  let expressions = instruction.expressions;\n  let providers = instruction.providers;\n  let values = instruction.values;\n  let i;\n  let ii;\n  let current;\n  let instance;\n  let currentAttributeValue;\n\n  i = providers.length;\n  while (i--) {\n    container._resolvers.set(providers[i], providerResolverInstance);\n  }\n\n  for (let key in values) {\n    currentAttributeValue = element.getAttribute(key);\n\n    if (currentAttributeValue) {\n      if (key === 'class') {\n        element.setAttribute('class', currentAttributeValue + ' ' + values[key]);\n      } else if (key === 'style') {\n        let styleObject = styleStringToObject(values[key]);\n        styleStringToObject(currentAttributeValue, styleObject);\n        element.setAttribute('style', styleObjectToString(styleObject));\n      }\n    } else {\n      element.setAttribute(key, values[key]);\n    }\n  }\n\n  if (behaviorInstructions.length) {\n    for (i = 0, ii = behaviorInstructions.length; i < ii; ++i) {\n      current = behaviorInstructions[i];\n      instance = current.type.create(container, current, element, bindings);\n\n      if (instance.contentView) {\n        children.push(instance.contentView);\n      }\n\n      controllers.push(instance);\n    }\n  }\n\n  for (i = 0, ii = expressions.length; i < ii; ++i) {\n    bindings.push(expressions[i].createBinding(element));\n  }\n}\n\nexport let BoundViewFactory = class BoundViewFactory {\n  constructor(parentContainer, viewFactory, partReplacements) {\n    this.parentContainer = parentContainer;\n    this.viewFactory = viewFactory;\n    this.factoryCreateInstruction = { partReplacements: partReplacements };\n  }\n\n  create() {\n    let view = this.viewFactory.create(this.parentContainer.createChild(), this.factoryCreateInstruction);\n    view._isUserControlled = true;\n    return view;\n  }\n\n  get isCaching() {\n    return this.viewFactory.isCaching;\n  }\n\n  setCacheSize(size, doNotOverrideIfAlreadySet) {\n    this.viewFactory.setCacheSize(size, doNotOverrideIfAlreadySet);\n  }\n\n  getCachedView() {\n    return this.viewFactory.getCachedView();\n  }\n\n  returnViewToCache(view) {\n    this.viewFactory.returnViewToCache(view);\n  }\n};\n\nexport let ViewFactory = class ViewFactory {\n  constructor(template, instructions, resources) {\n    this.isCaching = false;\n\n    this.template = template;\n    this.instructions = instructions;\n    this.resources = resources;\n    this.cacheSize = -1;\n    this.cache = null;\n  }\n\n  setCacheSize(size, doNotOverrideIfAlreadySet) {\n    if (size) {\n      if (size === '*') {\n        size = Number.MAX_VALUE;\n      } else if (typeof size === 'string') {\n        size = parseInt(size, 10);\n      }\n    }\n\n    if (this.cacheSize === -1 || !doNotOverrideIfAlreadySet) {\n      this.cacheSize = size;\n    }\n\n    if (this.cacheSize > 0) {\n      this.cache = [];\n    } else {\n      this.cache = null;\n    }\n\n    this.isCaching = this.cacheSize > 0;\n  }\n\n  getCachedView() {\n    return this.cache !== null ? this.cache.pop() || null : null;\n  }\n\n  returnViewToCache(view) {\n    if (view.isAttached) {\n      view.detached();\n    }\n\n    if (view.isBound) {\n      view.unbind();\n    }\n\n    if (this.cache !== null && this.cache.length < this.cacheSize) {\n      view.fromCache = true;\n      this.cache.push(view);\n    }\n  }\n\n  create(container, createInstruction, element) {\n    createInstruction = createInstruction || BehaviorInstruction.normal;\n\n    let cachedView = this.getCachedView();\n    if (cachedView !== null) {\n      return cachedView;\n    }\n\n    let fragment = createInstruction.enhance ? this.template : this.template.cloneNode(true);\n    let instructables = fragment.querySelectorAll('.au-target');\n    let instructions = this.instructions;\n    let resources = this.resources;\n    let controllers = [];\n    let bindings = [];\n    let children = [];\n    let shadowSlots = Object.create(null);\n    let containers = { root: container };\n    let partReplacements = createInstruction.partReplacements;\n    let i;\n    let ii;\n    let view;\n    let instructable;\n    let instruction;\n\n    this.resources._invokeHook('beforeCreate', this, container, fragment, createInstruction);\n\n    if (element && this.surrogateInstruction !== null) {\n      applySurrogateInstruction(container, element, this.surrogateInstruction, controllers, bindings, children);\n    }\n\n    if (createInstruction.enhance && fragment.hasAttribute('au-target-id')) {\n      instructable = fragment;\n      instruction = instructions[instructable.getAttribute('au-target-id')];\n      applyInstructions(containers, instructable, instruction, controllers, bindings, children, shadowSlots, partReplacements, resources);\n    }\n\n    for (i = 0, ii = instructables.length; i < ii; ++i) {\n      instructable = instructables[i];\n      instruction = instructions[instructable.getAttribute('au-target-id')];\n      applyInstructions(containers, instructable, instruction, controllers, bindings, children, shadowSlots, partReplacements, resources);\n    }\n\n    view = new View(container, this, fragment, controllers, bindings, children, shadowSlots);\n\n    if (!createInstruction.initiatedByBehavior) {\n      view.created();\n    }\n\n    this.resources._invokeHook('afterCreate', view);\n\n    return view;\n  }\n};\n\nlet nextInjectorId = 0;\nfunction getNextInjectorId() {\n  return ++nextInjectorId;\n}\n\nlet lastAUTargetID = 0;\nfunction getNextAUTargetID() {\n  return (++lastAUTargetID).toString();\n}\n\nfunction makeIntoInstructionTarget(element) {\n  let value = element.getAttribute('class');\n  let auTargetID = getNextAUTargetID();\n\n  element.setAttribute('class', value ? value + ' au-target' : 'au-target');\n  element.setAttribute('au-target-id', auTargetID);\n\n  return auTargetID;\n}\n\nfunction makeShadowSlot(compiler, resources, node, instructions, parentInjectorId) {\n  let auShadowSlot = DOM.createElement('au-shadow-slot');\n  DOM.replaceNode(auShadowSlot, node);\n\n  let auTargetID = makeIntoInstructionTarget(auShadowSlot);\n  let instruction = TargetInstruction.shadowSlot(parentInjectorId);\n\n  instruction.slotName = node.getAttribute('name') || ShadowDOM.defaultSlotKey;\n  instruction.slotDestination = node.getAttribute('slot');\n\n  if (node.innerHTML.trim()) {\n    let fragment = DOM.createDocumentFragment();\n    let child;\n\n    while (child = node.firstChild) {\n      fragment.appendChild(child);\n    }\n\n    instruction.slotFallbackFactory = compiler.compile(fragment, resources);\n  }\n\n  instructions[auTargetID] = instruction;\n\n  return auShadowSlot;\n}\n\nexport let ViewCompiler = (_dec7 = inject(BindingLanguage, ViewResources), _dec7(_class13 = class ViewCompiler {\n  constructor(bindingLanguage, resources) {\n    this.bindingLanguage = bindingLanguage;\n    this.resources = resources;\n  }\n\n  compile(source, resources, compileInstruction) {\n    resources = resources || this.resources;\n    compileInstruction = compileInstruction || ViewCompileInstruction.normal;\n    source = typeof source === 'string' ? DOM.createTemplateFromMarkup(source) : source;\n\n    let content;\n    let part;\n    let cacheSize;\n\n    if (source.content) {\n      part = source.getAttribute('part');\n      cacheSize = source.getAttribute('view-cache');\n      content = DOM.adoptNode(source.content);\n    } else {\n      content = source;\n    }\n\n    compileInstruction.targetShadowDOM = compileInstruction.targetShadowDOM && FEATURE.shadowDOM;\n    resources._invokeHook('beforeCompile', content, resources, compileInstruction);\n\n    let instructions = {};\n    this._compileNode(content, resources, instructions, source, 'root', !compileInstruction.targetShadowDOM);\n\n    let firstChild = content.firstChild;\n    if (firstChild && firstChild.nodeType === 1) {\n      let targetId = firstChild.getAttribute('au-target-id');\n      if (targetId) {\n        let ins = instructions[targetId];\n\n        if (ins.shadowSlot || ins.lifting || ins.elementInstruction && !ins.elementInstruction.anchorIsContainer) {\n          content.insertBefore(DOM.createComment('view'), firstChild);\n        }\n      }\n    }\n\n    let factory = new ViewFactory(content, instructions, resources);\n\n    factory.surrogateInstruction = compileInstruction.compileSurrogate ? this._compileSurrogate(source, resources) : null;\n    factory.part = part;\n\n    if (cacheSize) {\n      factory.setCacheSize(cacheSize);\n    }\n\n    resources._invokeHook('afterCompile', factory);\n\n    return factory;\n  }\n\n  _compileNode(node, resources, instructions, parentNode, parentInjectorId, targetLightDOM) {\n    switch (node.nodeType) {\n      case 1:\n        return this._compileElement(node, resources, instructions, parentNode, parentInjectorId, targetLightDOM);\n      case 3:\n        let expression = resources.getBindingLanguage(this.bindingLanguage).inspectTextContent(resources, node.wholeText);\n        if (expression) {\n          let marker = DOM.createElement('au-marker');\n          let auTargetID = makeIntoInstructionTarget(marker);\n          (node.parentNode || parentNode).insertBefore(marker, node);\n          node.textContent = ' ';\n          instructions[auTargetID] = TargetInstruction.contentExpression(expression);\n\n          while (node.nextSibling && node.nextSibling.nodeType === 3) {\n            (node.parentNode || parentNode).removeChild(node.nextSibling);\n          }\n        } else {\n          while (node.nextSibling && node.nextSibling.nodeType === 3) {\n            node = node.nextSibling;\n          }\n        }\n        return node.nextSibling;\n      case 11:\n        let currentChild = node.firstChild;\n        while (currentChild) {\n          currentChild = this._compileNode(currentChild, resources, instructions, node, parentInjectorId, targetLightDOM);\n        }\n        break;\n      default:\n        break;\n    }\n\n    return node.nextSibling;\n  }\n\n  _compileSurrogate(node, resources) {\n    let tagName = node.tagName.toLowerCase();\n    let attributes = node.attributes;\n    let bindingLanguage = resources.getBindingLanguage(this.bindingLanguage);\n    let knownAttribute;\n    let property;\n    let instruction;\n    let i;\n    let ii;\n    let attr;\n    let attrName;\n    let attrValue;\n    let info;\n    let type;\n    let expressions = [];\n    let expression;\n    let behaviorInstructions = [];\n    let values = {};\n    let hasValues = false;\n    let providers = [];\n\n    for (i = 0, ii = attributes.length; i < ii; ++i) {\n      attr = attributes[i];\n      attrName = attr.name;\n      attrValue = attr.value;\n\n      info = bindingLanguage.inspectAttribute(resources, tagName, attrName, attrValue);\n      type = resources.getAttribute(info.attrName);\n\n      if (type) {\n        knownAttribute = resources.mapAttribute(info.attrName);\n        if (knownAttribute) {\n          property = type.attributes[knownAttribute];\n\n          if (property) {\n            info.defaultBindingMode = property.defaultBindingMode;\n\n            if (!info.command && !info.expression) {\n              info.command = property.hasOptions ? 'options' : null;\n            }\n\n            if (info.command && info.command !== 'options' && type.primaryProperty) {\n              const primaryProperty = type.primaryProperty;\n              attrName = info.attrName = primaryProperty.name;\n\n              info.defaultBindingMode = primaryProperty.defaultBindingMode;\n            }\n          }\n        }\n      }\n\n      instruction = bindingLanguage.createAttributeInstruction(resources, node, info, undefined, type);\n\n      if (instruction) {\n        if (instruction.alteredAttr) {\n          type = resources.getAttribute(instruction.attrName);\n        }\n\n        if (instruction.discrete) {\n          expressions.push(instruction);\n        } else {\n          if (type) {\n            instruction.type = type;\n            this._configureProperties(instruction, resources);\n\n            if (type.liftsContent) {\n              throw new Error('You cannot place a template controller on a surrogate element.');\n            } else {\n              behaviorInstructions.push(instruction);\n            }\n          } else {\n            expressions.push(instruction.attributes[instruction.attrName]);\n          }\n        }\n      } else {\n        if (type) {\n          instruction = BehaviorInstruction.attribute(attrName, type);\n          instruction.attributes[resources.mapAttribute(attrName)] = attrValue;\n\n          if (type.liftsContent) {\n            throw new Error('You cannot place a template controller on a surrogate element.');\n          } else {\n            behaviorInstructions.push(instruction);\n          }\n        } else if (attrName !== 'id' && attrName !== 'part' && attrName !== 'replace-part') {\n          hasValues = true;\n          values[attrName] = attrValue;\n        }\n      }\n    }\n\n    if (expressions.length || behaviorInstructions.length || hasValues) {\n      for (i = 0, ii = behaviorInstructions.length; i < ii; ++i) {\n        instruction = behaviorInstructions[i];\n        instruction.type.compile(this, resources, node, instruction);\n        providers.push(instruction.type.target);\n      }\n\n      for (i = 0, ii = expressions.length; i < ii; ++i) {\n        expression = expressions[i];\n        if (expression.attrToRemove !== undefined) {\n          node.removeAttribute(expression.attrToRemove);\n        }\n      }\n\n      return TargetInstruction.surrogate(providers, behaviorInstructions, expressions, values);\n    }\n\n    return null;\n  }\n\n  _compileElement(node, resources, instructions, parentNode, parentInjectorId, targetLightDOM) {\n    let tagName = node.tagName.toLowerCase();\n    let attributes = node.attributes;\n    let expressions = [];\n    let expression;\n    let behaviorInstructions = [];\n    let providers = [];\n    let bindingLanguage = resources.getBindingLanguage(this.bindingLanguage);\n    let liftingInstruction;\n    let viewFactory;\n    let type;\n    let elementInstruction;\n    let elementProperty;\n    let i;\n    let ii;\n    let attr;\n    let attrName;\n    let attrValue;\n    let instruction;\n    let info;\n    let property;\n    let knownAttribute;\n    let auTargetID;\n    let injectorId;\n\n    if (tagName === 'slot') {\n      if (targetLightDOM) {\n        node = makeShadowSlot(this, resources, node, instructions, parentInjectorId);\n      }\n      return node.nextSibling;\n    } else if (tagName === 'template') {\n      viewFactory = this.compile(node, resources);\n      viewFactory.part = node.getAttribute('part');\n    } else {\n      type = resources.getElement(node.getAttribute('as-element') || tagName);\n      if (type) {\n        elementInstruction = BehaviorInstruction.element(node, type);\n        type.processAttributes(this, resources, node, attributes, elementInstruction);\n        behaviorInstructions.push(elementInstruction);\n      }\n    }\n\n    for (i = 0, ii = attributes.length; i < ii; ++i) {\n      attr = attributes[i];\n      attrName = attr.name;\n      attrValue = attr.value;\n      info = bindingLanguage.inspectAttribute(resources, tagName, attrName, attrValue);\n\n      if (targetLightDOM && info.attrName === 'slot') {\n        info.attrName = attrName = 'au-slot';\n      }\n\n      type = resources.getAttribute(info.attrName);\n      elementProperty = null;\n\n      if (type) {\n        knownAttribute = resources.mapAttribute(info.attrName);\n        if (knownAttribute) {\n          property = type.attributes[knownAttribute];\n\n          if (property) {\n            info.defaultBindingMode = property.defaultBindingMode;\n\n            if (!info.command && !info.expression) {\n              info.command = property.hasOptions ? 'options' : null;\n            }\n\n            if (info.command && info.command !== 'options' && type.primaryProperty) {\n              const primaryProperty = type.primaryProperty;\n              attrName = info.attrName = primaryProperty.name;\n\n              info.defaultBindingMode = primaryProperty.defaultBindingMode;\n            }\n          }\n        }\n      } else if (elementInstruction) {\n        elementProperty = elementInstruction.type.attributes[info.attrName];\n        if (elementProperty) {\n          info.defaultBindingMode = elementProperty.defaultBindingMode;\n        }\n      }\n\n      if (elementProperty) {\n        instruction = bindingLanguage.createAttributeInstruction(resources, node, info, elementInstruction);\n      } else {\n        instruction = bindingLanguage.createAttributeInstruction(resources, node, info, undefined, type);\n      }\n\n      if (instruction) {\n        if (instruction.alteredAttr) {\n          type = resources.getAttribute(instruction.attrName);\n        }\n\n        if (instruction.discrete) {\n          expressions.push(instruction);\n        } else {\n          if (type) {\n            instruction.type = type;\n            this._configureProperties(instruction, resources);\n\n            if (type.liftsContent) {\n              instruction.originalAttrName = attrName;\n              liftingInstruction = instruction;\n              break;\n            } else {\n              behaviorInstructions.push(instruction);\n            }\n          } else if (elementProperty) {\n            elementInstruction.attributes[info.attrName].targetProperty = elementProperty.name;\n          } else {\n            expressions.push(instruction.attributes[instruction.attrName]);\n          }\n        }\n      } else {\n        if (type) {\n          instruction = BehaviorInstruction.attribute(attrName, type);\n          instruction.attributes[resources.mapAttribute(attrName)] = attrValue;\n\n          if (type.liftsContent) {\n            instruction.originalAttrName = attrName;\n            liftingInstruction = instruction;\n            break;\n          } else {\n            behaviorInstructions.push(instruction);\n          }\n        } else if (elementProperty) {\n          elementInstruction.attributes[attrName] = attrValue;\n        }\n      }\n    }\n\n    if (liftingInstruction) {\n      liftingInstruction.viewFactory = viewFactory;\n      node = liftingInstruction.type.compile(this, resources, node, liftingInstruction, parentNode);\n      auTargetID = makeIntoInstructionTarget(node);\n      instructions[auTargetID] = TargetInstruction.lifting(parentInjectorId, liftingInstruction);\n    } else {\n      if (expressions.length || behaviorInstructions.length) {\n        injectorId = behaviorInstructions.length ? getNextInjectorId() : false;\n\n        for (i = 0, ii = behaviorInstructions.length; i < ii; ++i) {\n          instruction = behaviorInstructions[i];\n          instruction.type.compile(this, resources, node, instruction, parentNode);\n          providers.push(instruction.type.target);\n        }\n\n        for (i = 0, ii = expressions.length; i < ii; ++i) {\n          expression = expressions[i];\n          if (expression.attrToRemove !== undefined) {\n            node.removeAttribute(expression.attrToRemove);\n          }\n        }\n\n        auTargetID = makeIntoInstructionTarget(node);\n        instructions[auTargetID] = TargetInstruction.normal(injectorId, parentInjectorId, providers, behaviorInstructions, expressions, elementInstruction);\n      }\n\n      if (elementInstruction && elementInstruction.skipContentProcessing) {\n        return node.nextSibling;\n      }\n\n      let currentChild = node.firstChild;\n      while (currentChild) {\n        currentChild = this._compileNode(currentChild, resources, instructions, node, injectorId || parentInjectorId, targetLightDOM);\n      }\n    }\n\n    return node.nextSibling;\n  }\n\n  _configureProperties(instruction, resources) {\n    let type = instruction.type;\n    let attrName = instruction.attrName;\n    let attributes = instruction.attributes;\n    let property;\n    let key;\n    let value;\n\n    let knownAttribute = resources.mapAttribute(attrName);\n    if (knownAttribute && attrName in attributes && knownAttribute !== attrName) {\n      attributes[knownAttribute] = attributes[attrName];\n      delete attributes[attrName];\n    }\n\n    for (key in attributes) {\n      value = attributes[key];\n\n      if (value !== null && typeof value === 'object') {\n        property = type.attributes[key];\n\n        if (property !== undefined) {\n          value.targetProperty = property.name;\n        } else {\n          value.targetProperty = key;\n        }\n      }\n    }\n  }\n}) || _class13);\n\nexport let ResourceModule = class ResourceModule {\n  constructor(moduleId) {\n    this.id = moduleId;\n    this.moduleInstance = null;\n    this.mainResource = null;\n    this.resources = null;\n    this.viewStrategy = null;\n    this.isInitialized = false;\n    this.onLoaded = null;\n    this.loadContext = null;\n  }\n\n  initialize(container) {\n    let current = this.mainResource;\n    let resources = this.resources;\n    let vs = this.viewStrategy;\n\n    if (this.isInitialized) {\n      return;\n    }\n\n    this.isInitialized = true;\n\n    if (current !== undefined) {\n      current.metadata.viewStrategy = vs;\n      current.initialize(container);\n    }\n\n    for (let i = 0, ii = resources.length; i < ii; ++i) {\n      current = resources[i];\n      current.metadata.viewStrategy = vs;\n      current.initialize(container);\n    }\n  }\n\n  register(registry, name) {\n    let main = this.mainResource;\n    let resources = this.resources;\n\n    if (main !== undefined) {\n      main.register(registry, name);\n      name = null;\n    }\n\n    for (let i = 0, ii = resources.length; i < ii; ++i) {\n      resources[i].register(registry, name);\n      name = null;\n    }\n  }\n\n  load(container, loadContext) {\n    if (this.onLoaded !== null) {\n      return this.loadContext === loadContext ? Promise.resolve() : this.onLoaded;\n    }\n\n    let main = this.mainResource;\n    let resources = this.resources;\n    let loads;\n\n    if (main !== undefined) {\n      loads = new Array(resources.length + 1);\n      loads[0] = main.load(container, loadContext);\n      for (let i = 0, ii = resources.length; i < ii; ++i) {\n        loads[i + 1] = resources[i].load(container, loadContext);\n      }\n    } else {\n      loads = new Array(resources.length);\n      for (let i = 0, ii = resources.length; i < ii; ++i) {\n        loads[i] = resources[i].load(container, loadContext);\n      }\n    }\n\n    this.loadContext = loadContext;\n    this.onLoaded = Promise.all(loads);\n    return this.onLoaded;\n  }\n};\n\nexport let ResourceDescription = class ResourceDescription {\n  constructor(key, exportedValue, resourceTypeMeta) {\n    if (!resourceTypeMeta) {\n      resourceTypeMeta = metadata.get(metadata.resource, exportedValue);\n\n      if (!resourceTypeMeta) {\n        resourceTypeMeta = new HtmlBehaviorResource();\n        resourceTypeMeta.elementName = _hyphenate(key);\n        metadata.define(metadata.resource, resourceTypeMeta, exportedValue);\n      }\n    }\n\n    if (resourceTypeMeta instanceof HtmlBehaviorResource) {\n      if (resourceTypeMeta.elementName === undefined) {\n        resourceTypeMeta.elementName = _hyphenate(key);\n      } else if (resourceTypeMeta.attributeName === undefined) {\n        resourceTypeMeta.attributeName = _hyphenate(key);\n      } else if (resourceTypeMeta.attributeName === null && resourceTypeMeta.elementName === null) {\n        HtmlBehaviorResource.convention(key, resourceTypeMeta);\n      }\n    } else if (!resourceTypeMeta.name) {\n      resourceTypeMeta.name = _hyphenate(key);\n    }\n\n    this.metadata = resourceTypeMeta;\n    this.value = exportedValue;\n  }\n\n  initialize(container) {\n    this.metadata.initialize(container, this.value);\n  }\n\n  register(registry, name) {\n    this.metadata.register(registry, name);\n  }\n\n  load(container, loadContext) {\n    return this.metadata.load(container, this.value, loadContext);\n  }\n};\n\nexport let ModuleAnalyzer = class ModuleAnalyzer {\n  constructor() {\n    this.cache = Object.create(null);\n  }\n\n  getAnalysis(moduleId) {\n    return this.cache[moduleId];\n  }\n\n  analyze(moduleId, moduleInstance, mainResourceKey) {\n    let mainResource;\n    let fallbackValue;\n    let fallbackKey;\n    let resourceTypeMeta;\n    let key;\n    let exportedValue;\n    let resources = [];\n    let conventional;\n    let vs;\n    let resourceModule;\n\n    resourceModule = this.cache[moduleId];\n    if (resourceModule) {\n      return resourceModule;\n    }\n\n    resourceModule = new ResourceModule(moduleId);\n    this.cache[moduleId] = resourceModule;\n\n    if (typeof moduleInstance === 'function') {\n      moduleInstance = { 'default': moduleInstance };\n    }\n\n    if (mainResourceKey) {\n      mainResource = new ResourceDescription(mainResourceKey, moduleInstance[mainResourceKey]);\n    }\n\n    for (key in moduleInstance) {\n      exportedValue = moduleInstance[key];\n\n      if (key === mainResourceKey || typeof exportedValue !== 'function') {\n        continue;\n      }\n\n      resourceTypeMeta = metadata.get(metadata.resource, exportedValue);\n\n      if (resourceTypeMeta) {\n        if (resourceTypeMeta.attributeName === null && resourceTypeMeta.elementName === null) {\n          HtmlBehaviorResource.convention(key, resourceTypeMeta);\n        }\n\n        if (resourceTypeMeta.attributeName === null && resourceTypeMeta.elementName === null) {\n          resourceTypeMeta.elementName = _hyphenate(key);\n        }\n\n        if (!mainResource && resourceTypeMeta instanceof HtmlBehaviorResource && resourceTypeMeta.elementName !== null) {\n          mainResource = new ResourceDescription(key, exportedValue, resourceTypeMeta);\n        } else {\n          resources.push(new ResourceDescription(key, exportedValue, resourceTypeMeta));\n        }\n      } else if (viewStrategy.decorates(exportedValue)) {\n        vs = exportedValue;\n      } else if (exportedValue instanceof TemplateRegistryEntry) {\n        vs = new TemplateRegistryViewStrategy(moduleId, exportedValue);\n      } else {\n        if (conventional = HtmlBehaviorResource.convention(key)) {\n          if (conventional.elementName !== null && !mainResource) {\n            mainResource = new ResourceDescription(key, exportedValue, conventional);\n          } else {\n            resources.push(new ResourceDescription(key, exportedValue, conventional));\n          }\n\n          metadata.define(metadata.resource, conventional, exportedValue);\n        } else if (conventional = ValueConverterResource.convention(key) || BindingBehaviorResource.convention(key) || ViewEngineHooksResource.convention(key)) {\n          resources.push(new ResourceDescription(key, exportedValue, conventional));\n          metadata.define(metadata.resource, conventional, exportedValue);\n        } else if (!fallbackValue) {\n          fallbackValue = exportedValue;\n          fallbackKey = key;\n        }\n      }\n    }\n\n    if (!mainResource && fallbackValue) {\n      mainResource = new ResourceDescription(fallbackKey, fallbackValue);\n    }\n\n    resourceModule.moduleInstance = moduleInstance;\n    resourceModule.mainResource = mainResource;\n    resourceModule.resources = resources;\n    resourceModule.viewStrategy = vs;\n\n    return resourceModule;\n  }\n};\n\nlet logger = LogManager.getLogger('templating');\n\nfunction ensureRegistryEntry(loader, urlOrRegistryEntry) {\n  if (urlOrRegistryEntry instanceof TemplateRegistryEntry) {\n    return Promise.resolve(urlOrRegistryEntry);\n  }\n\n  return loader.loadTemplate(urlOrRegistryEntry);\n}\n\nlet ProxyViewFactory = class ProxyViewFactory {\n  constructor(promise) {\n    promise.then(x => this.viewFactory = x);\n  }\n\n  create(container, bindingContext, createInstruction, element) {\n    return this.viewFactory.create(container, bindingContext, createInstruction, element);\n  }\n\n  get isCaching() {\n    return this.viewFactory.isCaching;\n  }\n\n  setCacheSize(size, doNotOverrideIfAlreadySet) {\n    this.viewFactory.setCacheSize(size, doNotOverrideIfAlreadySet);\n  }\n\n  getCachedView() {\n    return this.viewFactory.getCachedView();\n  }\n\n  returnViewToCache(view) {\n    this.viewFactory.returnViewToCache(view);\n  }\n};\n\nexport let ViewEngine = (_dec8 = inject(Loader, Container, ViewCompiler, ModuleAnalyzer, ViewResources), _dec8(_class14 = (_temp4 = _class15 = class ViewEngine {\n  constructor(loader, container, viewCompiler, moduleAnalyzer, appResources) {\n    this.loader = loader;\n    this.container = container;\n    this.viewCompiler = viewCompiler;\n    this.moduleAnalyzer = moduleAnalyzer;\n    this.appResources = appResources;\n    this._pluginMap = {};\n\n    let auSlotBehavior = new HtmlBehaviorResource();\n    auSlotBehavior.attributeName = 'au-slot';\n    auSlotBehavior.initialize(container, SlotCustomAttribute);\n    auSlotBehavior.register(appResources);\n  }\n\n  addResourcePlugin(extension, implementation) {\n    let name = extension.replace('.', '') + '-resource-plugin';\n    this._pluginMap[extension] = name;\n    this.loader.addPlugin(name, implementation);\n  }\n\n  loadViewFactory(urlOrRegistryEntry, compileInstruction, loadContext, target) {\n    loadContext = loadContext || new ResourceLoadContext();\n\n    return ensureRegistryEntry(this.loader, urlOrRegistryEntry).then(registryEntry => {\n      if (registryEntry.onReady) {\n        if (!loadContext.hasDependency(urlOrRegistryEntry)) {\n          loadContext.addDependency(urlOrRegistryEntry);\n          return registryEntry.onReady;\n        }\n\n        if (registryEntry.template === null) {\n          return registryEntry.onReady;\n        }\n\n        return Promise.resolve(new ProxyViewFactory(registryEntry.onReady));\n      }\n\n      loadContext.addDependency(urlOrRegistryEntry);\n\n      registryEntry.onReady = this.loadTemplateResources(registryEntry, compileInstruction, loadContext, target).then(resources => {\n        registryEntry.resources = resources;\n\n        if (registryEntry.template === null) {\n          return registryEntry.factory = null;\n        }\n\n        let viewFactory = this.viewCompiler.compile(registryEntry.template, resources, compileInstruction);\n        return registryEntry.factory = viewFactory;\n      });\n\n      return registryEntry.onReady;\n    });\n  }\n\n  loadTemplateResources(registryEntry, compileInstruction, loadContext, target) {\n    let resources = new ViewResources(this.appResources, registryEntry.address);\n    let dependencies = registryEntry.dependencies;\n    let importIds;\n    let names;\n\n    compileInstruction = compileInstruction || ViewCompileInstruction.normal;\n\n    if (dependencies.length === 0 && !compileInstruction.associatedModuleId) {\n      return Promise.resolve(resources);\n    }\n\n    importIds = dependencies.map(x => x.src);\n    names = dependencies.map(x => x.name);\n    logger.debug(`importing resources for ${ registryEntry.address }`, importIds);\n\n    if (target) {\n      let viewModelRequires = metadata.get(ViewEngine.viewModelRequireMetadataKey, target);\n      if (viewModelRequires) {\n        let templateImportCount = importIds.length;\n        for (let i = 0, ii = viewModelRequires.length; i < ii; ++i) {\n          let req = viewModelRequires[i];\n          let importId = typeof req === 'function' ? Origin.get(req).moduleId : relativeToFile(req.src || req, registryEntry.address);\n\n          if (importIds.indexOf(importId) === -1) {\n            importIds.push(importId);\n            names.push(req.as);\n          }\n        }\n        logger.debug(`importing ViewModel resources for ${ compileInstruction.associatedModuleId }`, importIds.slice(templateImportCount));\n      }\n    }\n\n    return this.importViewResources(importIds, names, resources, compileInstruction, loadContext);\n  }\n\n  importViewModelResource(moduleImport, moduleMember) {\n    return this.loader.loadModule(moduleImport).then(viewModelModule => {\n      let normalizedId = Origin.get(viewModelModule).moduleId;\n      let resourceModule = this.moduleAnalyzer.analyze(normalizedId, viewModelModule, moduleMember);\n\n      if (!resourceModule.mainResource) {\n        throw new Error(`No view model found in module \"${ moduleImport }\".`);\n      }\n\n      resourceModule.initialize(this.container);\n\n      return resourceModule.mainResource;\n    });\n  }\n\n  importViewResources(moduleIds, names, resources, compileInstruction, loadContext) {\n    loadContext = loadContext || new ResourceLoadContext();\n    compileInstruction = compileInstruction || ViewCompileInstruction.normal;\n\n    moduleIds = moduleIds.map(x => this._applyLoaderPlugin(x));\n\n    return this.loader.loadAllModules(moduleIds).then(imports => {\n      let i;\n      let ii;\n      let analysis;\n      let normalizedId;\n      let current;\n      let associatedModule;\n      let container = this.container;\n      let moduleAnalyzer = this.moduleAnalyzer;\n      let allAnalysis = new Array(imports.length);\n\n      for (i = 0, ii = imports.length; i < ii; ++i) {\n        current = imports[i];\n        normalizedId = Origin.get(current).moduleId;\n\n        analysis = moduleAnalyzer.analyze(normalizedId, current);\n        analysis.initialize(container);\n        analysis.register(resources, names[i]);\n\n        allAnalysis[i] = analysis;\n      }\n\n      if (compileInstruction.associatedModuleId) {\n        associatedModule = moduleAnalyzer.getAnalysis(compileInstruction.associatedModuleId);\n\n        if (associatedModule) {\n          associatedModule.register(resources);\n        }\n      }\n\n      for (i = 0, ii = allAnalysis.length; i < ii; ++i) {\n        allAnalysis[i] = allAnalysis[i].load(container, loadContext);\n      }\n\n      return Promise.all(allAnalysis).then(() => resources);\n    });\n  }\n\n  _applyLoaderPlugin(id) {\n    let index = id.lastIndexOf('.');\n    if (index !== -1) {\n      let ext = id.substring(index);\n      let pluginName = this._pluginMap[ext];\n\n      if (pluginName === undefined) {\n        return id;\n      }\n\n      return this.loader.applyPluginToUrl(id, pluginName);\n    }\n\n    return id;\n  }\n}, _class15.viewModelRequireMetadataKey = 'aurelia:view-model-require', _temp4)) || _class14);\n\nexport let Controller = class Controller {\n  constructor(behavior, instruction, viewModel, container) {\n    this.behavior = behavior;\n    this.instruction = instruction;\n    this.viewModel = viewModel;\n    this.isAttached = false;\n    this.view = null;\n    this.isBound = false;\n    this.scope = null;\n    this.container = container;\n    this.elementEvents = container.elementEvents || null;\n\n    let observerLookup = behavior.observerLocator.getOrCreateObserversLookup(viewModel);\n    let handlesBind = behavior.handlesBind;\n    let attributes = instruction.attributes;\n    let boundProperties = this.boundProperties = [];\n    let properties = behavior.properties;\n    let i;\n    let ii;\n\n    behavior._ensurePropertiesDefined(viewModel, observerLookup);\n\n    for (i = 0, ii = properties.length; i < ii; ++i) {\n      properties[i]._initialize(viewModel, observerLookup, attributes, handlesBind, boundProperties);\n    }\n  }\n\n  created(owningView) {\n    if (this.behavior.handlesCreated) {\n      this.viewModel.created(owningView, this.view);\n    }\n  }\n\n  automate(overrideContext, owningView) {\n    this.view.bindingContext = this.viewModel;\n    this.view.overrideContext = overrideContext || createOverrideContext(this.viewModel);\n    this.view._isUserControlled = true;\n\n    if (this.behavior.handlesCreated) {\n      this.viewModel.created(owningView || null, this.view);\n    }\n\n    this.bind(this.view);\n  }\n\n  bind(scope) {\n    let skipSelfSubscriber = this.behavior.handlesBind;\n    let boundProperties = this.boundProperties;\n    let i;\n    let ii;\n    let x;\n    let observer;\n    let selfSubscriber;\n\n    if (this.isBound) {\n      if (this.scope === scope) {\n        return;\n      }\n\n      this.unbind();\n    }\n\n    this.isBound = true;\n    this.scope = scope;\n\n    for (i = 0, ii = boundProperties.length; i < ii; ++i) {\n      x = boundProperties[i];\n      observer = x.observer;\n      selfSubscriber = observer.selfSubscriber;\n      observer.publishing = false;\n\n      if (skipSelfSubscriber) {\n        observer.selfSubscriber = null;\n      }\n\n      x.binding.bind(scope);\n      observer.call();\n\n      observer.publishing = true;\n      observer.selfSubscriber = selfSubscriber;\n    }\n\n    let overrideContext;\n    if (this.view !== null) {\n      if (skipSelfSubscriber) {\n        this.view.viewModelScope = scope;\n      }\n\n      if (this.viewModel === scope.overrideContext.bindingContext) {\n        overrideContext = scope.overrideContext;\n      } else if (this.instruction.inheritBindingContext) {\n        overrideContext = createOverrideContext(this.viewModel, scope.overrideContext);\n      } else {\n        overrideContext = createOverrideContext(this.viewModel);\n        overrideContext.__parentOverrideContext = scope.overrideContext;\n      }\n\n      this.view.bind(this.viewModel, overrideContext);\n    } else if (skipSelfSubscriber) {\n      overrideContext = scope.overrideContext;\n\n      if (scope.overrideContext.__parentOverrideContext !== undefined && this.viewModel.viewFactory && this.viewModel.viewFactory.factoryCreateInstruction.partReplacements) {\n        overrideContext = Object.assign({}, scope.overrideContext);\n        overrideContext.parentOverrideContext = scope.overrideContext.__parentOverrideContext;\n      }\n      this.viewModel.bind(scope.bindingContext, overrideContext);\n    }\n  }\n\n  unbind() {\n    if (this.isBound) {\n      let boundProperties = this.boundProperties;\n      let i;\n      let ii;\n\n      this.isBound = false;\n      this.scope = null;\n\n      if (this.view !== null) {\n        this.view.unbind();\n      }\n\n      if (this.behavior.handlesUnbind) {\n        this.viewModel.unbind();\n      }\n\n      if (this.elementEvents !== null) {\n        this.elementEvents.disposeAll();\n      }\n\n      for (i = 0, ii = boundProperties.length; i < ii; ++i) {\n        boundProperties[i].binding.unbind();\n      }\n    }\n  }\n\n  attached() {\n    if (this.isAttached) {\n      return;\n    }\n\n    this.isAttached = true;\n\n    if (this.behavior.handlesAttached) {\n      this.viewModel.attached();\n    }\n\n    if (this.view !== null) {\n      this.view.attached();\n    }\n  }\n\n  detached() {\n    if (this.isAttached) {\n      this.isAttached = false;\n\n      if (this.view !== null) {\n        this.view.detached();\n      }\n\n      if (this.behavior.handlesDetached) {\n        this.viewModel.detached();\n      }\n    }\n  }\n};\n\nexport let BehaviorPropertyObserver = (_dec9 = subscriberCollection(), _dec9(_class16 = class BehaviorPropertyObserver {\n  constructor(taskQueue, obj, propertyName, selfSubscriber, initialValue) {\n    this.taskQueue = taskQueue;\n    this.obj = obj;\n    this.propertyName = propertyName;\n    this.notqueued = true;\n    this.publishing = false;\n    this.selfSubscriber = selfSubscriber;\n    this.currentValue = this.oldValue = initialValue;\n  }\n\n  getValue() {\n    return this.currentValue;\n  }\n\n  setValue(newValue) {\n    let oldValue = this.currentValue;\n\n    if (oldValue !== newValue) {\n      this.oldValue = oldValue;\n      this.currentValue = newValue;\n\n      if (this.publishing && this.notqueued) {\n        if (this.taskQueue.flushing) {\n          this.call();\n        } else {\n          this.notqueued = false;\n          this.taskQueue.queueMicroTask(this);\n        }\n      }\n    }\n  }\n\n  call() {\n    let oldValue = this.oldValue;\n    let newValue = this.currentValue;\n\n    this.notqueued = true;\n\n    if (newValue === oldValue) {\n      return;\n    }\n\n    if (this.selfSubscriber) {\n      this.selfSubscriber(newValue, oldValue);\n    }\n\n    this.callSubscribers(newValue, oldValue);\n    this.oldValue = newValue;\n  }\n\n  subscribe(context, callable) {\n    this.addSubscriber(context, callable);\n  }\n\n  unsubscribe(context, callable) {\n    this.removeSubscriber(context, callable);\n  }\n}) || _class16);\n\nfunction getObserver(behavior, instance, name) {\n  let lookup = instance.__observers__;\n\n  if (lookup === undefined) {\n    if (!behavior.isInitialized) {\n      behavior.initialize(Container.instance || new Container(), instance.constructor);\n    }\n\n    lookup = behavior.observerLocator.getOrCreateObserversLookup(instance);\n    behavior._ensurePropertiesDefined(instance, lookup);\n  }\n\n  return lookup[name];\n}\n\nexport let BindableProperty = class BindableProperty {\n  constructor(nameOrConfig) {\n    if (typeof nameOrConfig === 'string') {\n      this.name = nameOrConfig;\n    } else {\n      Object.assign(this, nameOrConfig);\n    }\n\n    this.attribute = this.attribute || _hyphenate(this.name);\n    if (this.defaultBindingMode === null || this.defaultBindingMode === undefined) {\n      this.defaultBindingMode = bindingMode.oneWay;\n    }\n    this.changeHandler = this.changeHandler || null;\n    this.owner = null;\n    this.descriptor = null;\n  }\n\n  registerWith(target, behavior, descriptor) {\n    behavior.properties.push(this);\n    behavior.attributes[this.attribute] = this;\n    this.owner = behavior;\n\n    if (descriptor) {\n      this.descriptor = descriptor;\n      return this._configureDescriptor(behavior, descriptor);\n    }\n\n    return undefined;\n  }\n\n  _configureDescriptor(behavior, descriptor) {\n    let name = this.name;\n\n    descriptor.configurable = true;\n    descriptor.enumerable = true;\n\n    if ('initializer' in descriptor) {\n      this.defaultValue = descriptor.initializer;\n      delete descriptor.initializer;\n      delete descriptor.writable;\n    }\n\n    if ('value' in descriptor) {\n      this.defaultValue = descriptor.value;\n      delete descriptor.value;\n      delete descriptor.writable;\n    }\n\n    descriptor.get = function () {\n      return getObserver(behavior, this, name).getValue();\n    };\n\n    descriptor.set = function (value) {\n      getObserver(behavior, this, name).setValue(value);\n    };\n\n    descriptor.get.getObserver = function (obj) {\n      return getObserver(behavior, obj, name);\n    };\n\n    return descriptor;\n  }\n\n  defineOn(target, behavior) {\n    let name = this.name;\n    let handlerName;\n\n    if (this.changeHandler === null) {\n      handlerName = name + 'Changed';\n      if (handlerName in target.prototype) {\n        this.changeHandler = handlerName;\n      }\n    }\n\n    if (this.descriptor === null) {\n      Object.defineProperty(target.prototype, name, this._configureDescriptor(behavior, {}));\n    }\n  }\n\n  createObserver(viewModel) {\n    let selfSubscriber = null;\n    let defaultValue = this.defaultValue;\n    let changeHandlerName = this.changeHandler;\n    let name = this.name;\n    let initialValue;\n\n    if (this.hasOptions) {\n      return undefined;\n    }\n\n    if (changeHandlerName in viewModel) {\n      if ('propertyChanged' in viewModel) {\n        selfSubscriber = (newValue, oldValue) => {\n          viewModel[changeHandlerName](newValue, oldValue);\n          viewModel.propertyChanged(name, newValue, oldValue);\n        };\n      } else {\n        selfSubscriber = (newValue, oldValue) => viewModel[changeHandlerName](newValue, oldValue);\n      }\n    } else if ('propertyChanged' in viewModel) {\n      selfSubscriber = (newValue, oldValue) => viewModel.propertyChanged(name, newValue, oldValue);\n    } else if (changeHandlerName !== null) {\n      throw new Error(`Change handler ${ changeHandlerName } was specified but not declared on the class.`);\n    }\n\n    if (defaultValue !== undefined) {\n      initialValue = typeof defaultValue === 'function' ? defaultValue.call(viewModel) : defaultValue;\n    }\n\n    return new BehaviorPropertyObserver(this.owner.taskQueue, viewModel, this.name, selfSubscriber, initialValue);\n  }\n\n  _initialize(viewModel, observerLookup, attributes, behaviorHandlesBind, boundProperties) {\n    let selfSubscriber;\n    let observer;\n    let attribute;\n    let defaultValue = this.defaultValue;\n\n    if (this.isDynamic) {\n      for (let key in attributes) {\n        this._createDynamicProperty(viewModel, observerLookup, behaviorHandlesBind, key, attributes[key], boundProperties);\n      }\n    } else if (!this.hasOptions) {\n      observer = observerLookup[this.name];\n\n      if (attributes !== null) {\n        selfSubscriber = observer.selfSubscriber;\n        attribute = attributes[this.attribute];\n\n        if (behaviorHandlesBind) {\n          observer.selfSubscriber = null;\n        }\n\n        if (typeof attribute === 'string') {\n          viewModel[this.name] = attribute;\n          observer.call();\n        } else if (attribute) {\n          boundProperties.push({ observer: observer, binding: attribute.createBinding(viewModel) });\n        } else if (defaultValue !== undefined) {\n          observer.call();\n        }\n\n        observer.selfSubscriber = selfSubscriber;\n      }\n\n      observer.publishing = true;\n    }\n  }\n\n  _createDynamicProperty(viewModel, observerLookup, behaviorHandlesBind, name, attribute, boundProperties) {\n    let changeHandlerName = name + 'Changed';\n    let selfSubscriber = null;\n    let observer;\n    let info;\n\n    if (changeHandlerName in viewModel) {\n      if ('propertyChanged' in viewModel) {\n        selfSubscriber = (newValue, oldValue) => {\n          viewModel[changeHandlerName](newValue, oldValue);\n          viewModel.propertyChanged(name, newValue, oldValue);\n        };\n      } else {\n        selfSubscriber = (newValue, oldValue) => viewModel[changeHandlerName](newValue, oldValue);\n      }\n    } else if ('propertyChanged' in viewModel) {\n      selfSubscriber = (newValue, oldValue) => viewModel.propertyChanged(name, newValue, oldValue);\n    }\n\n    observer = observerLookup[name] = new BehaviorPropertyObserver(this.owner.taskQueue, viewModel, name, selfSubscriber);\n\n    Object.defineProperty(viewModel, name, {\n      configurable: true,\n      enumerable: true,\n      get: observer.getValue.bind(observer),\n      set: observer.setValue.bind(observer)\n    });\n\n    if (behaviorHandlesBind) {\n      observer.selfSubscriber = null;\n    }\n\n    if (typeof attribute === 'string') {\n      viewModel[name] = attribute;\n      observer.call();\n    } else if (attribute) {\n      info = { observer: observer, binding: attribute.createBinding(viewModel) };\n      boundProperties.push(info);\n    }\n\n    observer.publishing = true;\n    observer.selfSubscriber = selfSubscriber;\n  }\n};\n\nlet lastProviderId = 0;\n\nfunction nextProviderId() {\n  return ++lastProviderId;\n}\n\nfunction doProcessContent() {\n  return true;\n}\nfunction doProcessAttributes() {}\n\nexport let HtmlBehaviorResource = class HtmlBehaviorResource {\n  constructor() {\n    this.elementName = null;\n    this.attributeName = null;\n    this.attributeDefaultBindingMode = undefined;\n    this.liftsContent = false;\n    this.targetShadowDOM = false;\n    this.shadowDOMOptions = null;\n    this.processAttributes = doProcessAttributes;\n    this.processContent = doProcessContent;\n    this.usesShadowDOM = false;\n    this.childBindings = null;\n    this.hasDynamicOptions = false;\n    this.containerless = false;\n    this.properties = [];\n    this.attributes = {};\n    this.isInitialized = false;\n    this.primaryProperty = null;\n  }\n\n  static convention(name, existing) {\n    let behavior;\n\n    if (name.endsWith('CustomAttribute')) {\n      behavior = existing || new HtmlBehaviorResource();\n      behavior.attributeName = _hyphenate(name.substring(0, name.length - 15));\n    }\n\n    if (name.endsWith('CustomElement')) {\n      behavior = existing || new HtmlBehaviorResource();\n      behavior.elementName = _hyphenate(name.substring(0, name.length - 13));\n    }\n\n    return behavior;\n  }\n\n  addChildBinding(behavior) {\n    if (this.childBindings === null) {\n      this.childBindings = [];\n    }\n\n    this.childBindings.push(behavior);\n  }\n\n  initialize(container, target) {\n    let proto = target.prototype;\n    let properties = this.properties;\n    let attributeName = this.attributeName;\n    let attributeDefaultBindingMode = this.attributeDefaultBindingMode;\n    let i;\n    let ii;\n    let current;\n\n    if (this.isInitialized) {\n      return;\n    }\n\n    this.isInitialized = true;\n    target.__providerId__ = nextProviderId();\n\n    this.observerLocator = container.get(ObserverLocator);\n    this.taskQueue = container.get(TaskQueue);\n\n    this.target = target;\n    this.usesShadowDOM = this.targetShadowDOM && FEATURE.shadowDOM;\n    this.handlesCreated = 'created' in proto;\n    this.handlesBind = 'bind' in proto;\n    this.handlesUnbind = 'unbind' in proto;\n    this.handlesAttached = 'attached' in proto;\n    this.handlesDetached = 'detached' in proto;\n    this.htmlName = this.elementName || this.attributeName;\n\n    if (attributeName !== null) {\n      if (properties.length === 0) {\n        new BindableProperty({\n          name: 'value',\n          changeHandler: 'valueChanged' in proto ? 'valueChanged' : null,\n          attribute: attributeName,\n          defaultBindingMode: attributeDefaultBindingMode\n        }).registerWith(target, this);\n      }\n\n      current = properties[0];\n\n      if (properties.length === 1 && current.name === 'value') {\n        current.isDynamic = current.hasOptions = this.hasDynamicOptions;\n        current.defineOn(target, this);\n      } else {\n        for (i = 0, ii = properties.length; i < ii; ++i) {\n          properties[i].defineOn(target, this);\n          if (properties[i].primaryProperty) {\n            if (this.primaryProperty) {\n              throw new Error('Only one bindable property on a custom element can be defined as the default');\n            }\n            this.primaryProperty = properties[i];\n          }\n        }\n\n        current = new BindableProperty({\n          name: 'value',\n          changeHandler: 'valueChanged' in proto ? 'valueChanged' : null,\n          attribute: attributeName,\n          defaultBindingMode: attributeDefaultBindingMode\n        });\n\n        current.hasOptions = true;\n        current.registerWith(target, this);\n      }\n    } else {\n      for (i = 0, ii = properties.length; i < ii; ++i) {\n        properties[i].defineOn(target, this);\n      }\n    }\n  }\n\n  register(registry, name) {\n    if (this.attributeName !== null) {\n      registry.registerAttribute(name || this.attributeName, this, this.attributeName);\n\n      if (Array.isArray(this.aliases)) {\n        this.aliases.forEach(alias => {\n          registry.registerAttribute(alias, this, this.attributeName);\n        });\n      }\n    }\n\n    if (this.elementName !== null) {\n      registry.registerElement(name || this.elementName, this);\n    }\n  }\n\n  load(container, target, loadContext, viewStrategy, transientView) {\n    let options;\n\n    if (this.elementName !== null) {\n      viewStrategy = container.get(ViewLocator).getViewStrategy(viewStrategy || this.viewStrategy || target);\n      options = new ViewCompileInstruction(this.targetShadowDOM, true);\n\n      if (!viewStrategy.moduleId) {\n        viewStrategy.moduleId = Origin.get(target).moduleId;\n      }\n\n      return viewStrategy.loadViewFactory(container.get(ViewEngine), options, loadContext, target).then(viewFactory => {\n        if (!transientView || !this.viewFactory) {\n          this.viewFactory = viewFactory;\n        }\n\n        return viewFactory;\n      });\n    }\n\n    return Promise.resolve(this);\n  }\n\n  compile(compiler, resources, node, instruction, parentNode) {\n    if (this.liftsContent) {\n      if (!instruction.viewFactory) {\n        let template = DOM.createElement('template');\n        let fragment = DOM.createDocumentFragment();\n        let cacheSize = node.getAttribute('view-cache');\n        let part = node.getAttribute('part');\n\n        node.removeAttribute(instruction.originalAttrName);\n        DOM.replaceNode(template, node, parentNode);\n        fragment.appendChild(node);\n        instruction.viewFactory = compiler.compile(fragment, resources);\n\n        if (part) {\n          instruction.viewFactory.part = part;\n          node.removeAttribute('part');\n        }\n\n        if (cacheSize) {\n          instruction.viewFactory.setCacheSize(cacheSize);\n          node.removeAttribute('view-cache');\n        }\n\n        node = template;\n      }\n    } else if (this.elementName !== null) {\n      let partReplacements = {};\n\n      if (this.processContent(compiler, resources, node, instruction) && node.hasChildNodes()) {\n        let currentChild = node.firstChild;\n        let contentElement = this.usesShadowDOM ? null : DOM.createElement('au-content');\n        let nextSibling;\n        let toReplace;\n\n        while (currentChild) {\n          nextSibling = currentChild.nextSibling;\n\n          if (currentChild.tagName === 'TEMPLATE' && (toReplace = currentChild.getAttribute('replace-part'))) {\n            partReplacements[toReplace] = compiler.compile(currentChild, resources);\n            DOM.removeNode(currentChild, parentNode);\n            instruction.partReplacements = partReplacements;\n          } else if (contentElement !== null) {\n            if (currentChild.nodeType === 3 && _isAllWhitespace(currentChild)) {\n              DOM.removeNode(currentChild, parentNode);\n            } else {\n              contentElement.appendChild(currentChild);\n            }\n          }\n\n          currentChild = nextSibling;\n        }\n\n        if (contentElement !== null && contentElement.hasChildNodes()) {\n          node.appendChild(contentElement);\n        }\n\n        instruction.skipContentProcessing = false;\n      } else {\n        instruction.skipContentProcessing = true;\n      }\n    }\n\n    return node;\n  }\n\n  create(container, instruction, element, bindings) {\n    let viewHost;\n    let au = null;\n\n    instruction = instruction || BehaviorInstruction.normal;\n    element = element || null;\n    bindings = bindings || null;\n\n    if (this.elementName !== null && element) {\n      if (this.usesShadowDOM) {\n        viewHost = element.attachShadow(this.shadowDOMOptions);\n        container.registerInstance(DOM.boundary, viewHost);\n      } else {\n        viewHost = element;\n        if (this.targetShadowDOM) {\n          container.registerInstance(DOM.boundary, viewHost);\n        }\n      }\n    }\n\n    if (element !== null) {\n      element.au = au = element.au || {};\n    }\n\n    let viewModel = instruction.viewModel || container.get(this.target);\n    let controller = new Controller(this, instruction, viewModel, container);\n    let childBindings = this.childBindings;\n    let viewFactory;\n\n    if (this.liftsContent) {\n      au.controller = controller;\n    } else if (this.elementName !== null) {\n      viewFactory = instruction.viewFactory || this.viewFactory;\n      container.viewModel = viewModel;\n\n      if (viewFactory) {\n        controller.view = viewFactory.create(container, instruction, element);\n      }\n\n      if (element !== null) {\n        au.controller = controller;\n\n        if (controller.view) {\n          if (!this.usesShadowDOM && (element.childNodes.length === 1 || element.contentElement)) {\n            let contentElement = element.childNodes[0] || element.contentElement;\n            controller.view.contentView = { fragment: contentElement };\n            contentElement.parentNode && DOM.removeNode(contentElement);\n          }\n\n          if (instruction.anchorIsContainer) {\n            if (childBindings !== null) {\n              for (let i = 0, ii = childBindings.length; i < ii; ++i) {\n                controller.view.addBinding(childBindings[i].create(element, viewModel, controller));\n              }\n            }\n\n            controller.view.appendNodesTo(viewHost);\n          } else {\n            controller.view.insertNodesBefore(viewHost);\n          }\n        } else if (childBindings !== null) {\n          for (let i = 0, ii = childBindings.length; i < ii; ++i) {\n            bindings.push(childBindings[i].create(element, viewModel, controller));\n          }\n        }\n      } else if (controller.view) {\n        controller.view.controller = controller;\n\n        if (childBindings !== null) {\n          for (let i = 0, ii = childBindings.length; i < ii; ++i) {\n            controller.view.addBinding(childBindings[i].create(instruction.host, viewModel, controller));\n          }\n        }\n      } else if (childBindings !== null) {\n        for (let i = 0, ii = childBindings.length; i < ii; ++i) {\n          bindings.push(childBindings[i].create(instruction.host, viewModel, controller));\n        }\n      }\n    } else if (childBindings !== null) {\n      for (let i = 0, ii = childBindings.length; i < ii; ++i) {\n        bindings.push(childBindings[i].create(element, viewModel, controller));\n      }\n    }\n\n    if (au !== null) {\n      au[this.htmlName] = controller;\n    }\n\n    if (instruction.initiatedByBehavior && viewFactory) {\n      controller.view.created();\n    }\n\n    return controller;\n  }\n\n  _ensurePropertiesDefined(instance, lookup) {\n    let properties;\n    let i;\n    let ii;\n    let observer;\n\n    if ('__propertiesDefined__' in lookup) {\n      return;\n    }\n\n    lookup.__propertiesDefined__ = true;\n    properties = this.properties;\n\n    for (i = 0, ii = properties.length; i < ii; ++i) {\n      observer = properties[i].createObserver(instance);\n\n      if (observer !== undefined) {\n        lookup[observer.propertyName] = observer;\n      }\n    }\n  }\n};\n\nfunction createChildObserverDecorator(selectorOrConfig, all) {\n  return function (target, key, descriptor) {\n    let actualTarget = typeof key === 'string' ? target.constructor : target;\n    let r = metadata.getOrCreateOwn(metadata.resource, HtmlBehaviorResource, actualTarget);\n\n    if (typeof selectorOrConfig === 'string') {\n      selectorOrConfig = {\n        selector: selectorOrConfig,\n        name: key\n      };\n    }\n\n    if (descriptor) {\n      descriptor.writable = true;\n      descriptor.configurable = true;\n    }\n\n    selectorOrConfig.all = all;\n    r.addChildBinding(new ChildObserver(selectorOrConfig));\n  };\n}\n\nexport function children(selectorOrConfig) {\n  return createChildObserverDecorator(selectorOrConfig, true);\n}\n\nexport function child(selectorOrConfig) {\n  return createChildObserverDecorator(selectorOrConfig, false);\n}\n\nlet ChildObserver = class ChildObserver {\n  constructor(config) {\n    this.name = config.name;\n    this.changeHandler = config.changeHandler || this.name + 'Changed';\n    this.selector = config.selector;\n    this.all = config.all;\n  }\n\n  create(viewHost, viewModel, controller) {\n    return new ChildObserverBinder(this.selector, viewHost, this.name, viewModel, controller, this.changeHandler, this.all);\n  }\n};\n\n\nconst noMutations = [];\n\nfunction trackMutation(groupedMutations, binder, record) {\n  let mutations = groupedMutations.get(binder);\n\n  if (!mutations) {\n    mutations = [];\n    groupedMutations.set(binder, mutations);\n  }\n\n  mutations.push(record);\n}\n\nfunction onChildChange(mutations, observer) {\n  let binders = observer.binders;\n  let bindersLength = binders.length;\n  let groupedMutations = new Map();\n\n  for (let i = 0, ii = mutations.length; i < ii; ++i) {\n    let record = mutations[i];\n    let added = record.addedNodes;\n    let removed = record.removedNodes;\n\n    for (let j = 0, jj = removed.length; j < jj; ++j) {\n      let node = removed[j];\n      if (node.nodeType === 1) {\n        for (let k = 0; k < bindersLength; ++k) {\n          let binder = binders[k];\n          if (binder.onRemove(node)) {\n            trackMutation(groupedMutations, binder, record);\n          }\n        }\n      }\n    }\n\n    for (let j = 0, jj = added.length; j < jj; ++j) {\n      let node = added[j];\n      if (node.nodeType === 1) {\n        for (let k = 0; k < bindersLength; ++k) {\n          let binder = binders[k];\n          if (binder.onAdd(node)) {\n            trackMutation(groupedMutations, binder, record);\n          }\n        }\n      }\n    }\n  }\n\n  groupedMutations.forEach((value, key) => {\n    if (key.changeHandler !== null) {\n      key.viewModel[key.changeHandler](value);\n    }\n  });\n}\n\nlet ChildObserverBinder = class ChildObserverBinder {\n  constructor(selector, viewHost, property, viewModel, controller, changeHandler, all) {\n    this.selector = selector;\n    this.viewHost = viewHost;\n    this.property = property;\n    this.viewModel = viewModel;\n    this.controller = controller;\n    this.changeHandler = changeHandler in viewModel ? changeHandler : null;\n    this.usesShadowDOM = controller.behavior.usesShadowDOM;\n    this.all = all;\n\n    if (!this.usesShadowDOM && controller.view && controller.view.contentView) {\n      this.contentView = controller.view.contentView;\n    } else {\n      this.contentView = null;\n    }\n  }\n\n  matches(element) {\n    if (element.matches(this.selector)) {\n      if (this.contentView === null) {\n        return true;\n      }\n\n      let contentView = this.contentView;\n      let assignedSlot = element.auAssignedSlot;\n\n      if (assignedSlot && assignedSlot.projectFromAnchors) {\n        let anchors = assignedSlot.projectFromAnchors;\n\n        for (let i = 0, ii = anchors.length; i < ii; ++i) {\n          if (anchors[i].auOwnerView === contentView) {\n            return true;\n          }\n        }\n\n        return false;\n      }\n\n      return element.auOwnerView === contentView;\n    }\n\n    return false;\n  }\n\n  bind(source) {\n    let viewHost = this.viewHost;\n    let viewModel = this.viewModel;\n    let observer = viewHost.__childObserver__;\n\n    if (!observer) {\n      observer = viewHost.__childObserver__ = DOM.createMutationObserver(onChildChange);\n\n      let options = {\n        childList: true,\n        subtree: !this.usesShadowDOM\n      };\n\n      observer.observe(viewHost, options);\n      observer.binders = [];\n    }\n\n    observer.binders.push(this);\n\n    if (this.usesShadowDOM) {\n      let current = viewHost.firstElementChild;\n\n      if (this.all) {\n        let items = viewModel[this.property];\n        if (!items) {\n          items = viewModel[this.property] = [];\n        } else {\n          items.length = 0;\n        }\n\n        while (current) {\n          if (this.matches(current)) {\n            items.push(current.au && current.au.controller ? current.au.controller.viewModel : current);\n          }\n\n          current = current.nextElementSibling;\n        }\n\n        if (this.changeHandler !== null) {\n          this.viewModel[this.changeHandler](noMutations);\n        }\n      } else {\n        while (current) {\n          if (this.matches(current)) {\n            let value = current.au && current.au.controller ? current.au.controller.viewModel : current;\n            this.viewModel[this.property] = value;\n\n            if (this.changeHandler !== null) {\n              this.viewModel[this.changeHandler](value);\n            }\n\n            break;\n          }\n\n          current = current.nextElementSibling;\n        }\n      }\n    }\n  }\n\n  onRemove(element) {\n    if (this.matches(element)) {\n      let value = element.au && element.au.controller ? element.au.controller.viewModel : element;\n\n      if (this.all) {\n        let items = this.viewModel[this.property] || (this.viewModel[this.property] = []);\n        let index = items.indexOf(value);\n\n        if (index !== -1) {\n          items.splice(index, 1);\n        }\n\n        return true;\n      }\n\n      return false;\n    }\n\n    return false;\n  }\n\n  onAdd(element) {\n    if (this.matches(element)) {\n      let value = element.au && element.au.controller ? element.au.controller.viewModel : element;\n\n      if (this.all) {\n        let items = this.viewModel[this.property] || (this.viewModel[this.property] = []);\n        let index = 0;\n        let prev = element.previousElementSibling;\n\n        while (prev) {\n          if (this.matches(prev)) {\n            index++;\n          }\n\n          prev = prev.previousElementSibling;\n        }\n\n        items.splice(index, 0, value);\n        return true;\n      }\n\n      this.viewModel[this.property] = value;\n\n      if (this.changeHandler !== null) {\n        this.viewModel[this.changeHandler](value);\n      }\n    }\n\n    return false;\n  }\n\n  unbind() {\n    if (this.viewHost.__childObserver__) {\n      this.viewHost.__childObserver__.disconnect();\n      this.viewHost.__childObserver__ = null;\n    }\n  }\n};\n\n\nfunction remove(viewSlot, previous) {\n  return Array.isArray(previous) ? viewSlot.removeMany(previous, true) : viewSlot.remove(previous, true);\n}\n\nexport const SwapStrategies = {\n  before(viewSlot, previous, callback) {\n    return previous === undefined ? callback() : callback().then(() => remove(viewSlot, previous));\n  },\n\n  with(viewSlot, previous, callback) {\n    return previous === undefined ? callback() : Promise.all([remove(viewSlot, previous), callback()]);\n  },\n\n  after(viewSlot, previous, callback) {\n    return Promise.resolve(viewSlot.removeAll(true)).then(callback);\n  }\n};\n\nfunction tryActivateViewModel(context) {\n  if (context.skipActivation || typeof context.viewModel.activate !== 'function') {\n    return Promise.resolve();\n  }\n\n  return context.viewModel.activate(context.model) || Promise.resolve();\n}\n\nexport let CompositionEngine = (_dec10 = inject(ViewEngine, ViewLocator), _dec10(_class17 = class CompositionEngine {\n  constructor(viewEngine, viewLocator) {\n    this.viewEngine = viewEngine;\n    this.viewLocator = viewLocator;\n  }\n\n  _swap(context, view) {\n    let swapStrategy = SwapStrategies[context.swapOrder] || SwapStrategies.after;\n    let previousViews = context.viewSlot.children.slice();\n\n    return swapStrategy(context.viewSlot, previousViews, () => {\n      return Promise.resolve(context.viewSlot.add(view)).then(() => {\n        if (context.currentController) {\n          context.currentController.unbind();\n        }\n      });\n    }).then(() => {\n      if (context.compositionTransactionNotifier) {\n        context.compositionTransactionNotifier.done();\n      }\n    });\n  }\n\n  _createControllerAndSwap(context) {\n    return this.createController(context).then(controller => {\n      controller.automate(context.overrideContext, context.owningView);\n\n      if (context.compositionTransactionOwnershipToken) {\n        return context.compositionTransactionOwnershipToken.waitForCompositionComplete().then(() => this._swap(context, controller.view)).then(() => controller);\n      }\n\n      return this._swap(context, controller.view).then(() => controller);\n    });\n  }\n\n  createController(context) {\n    let childContainer;\n    let viewModel;\n    let viewModelResource;\n    let m;\n\n    return this.ensureViewModel(context).then(tryActivateViewModel).then(() => {\n      childContainer = context.childContainer;\n      viewModel = context.viewModel;\n      viewModelResource = context.viewModelResource;\n      m = viewModelResource.metadata;\n\n      let viewStrategy = this.viewLocator.getViewStrategy(context.view || viewModel);\n\n      if (context.viewResources) {\n        viewStrategy.makeRelativeTo(context.viewResources.viewUrl);\n      }\n\n      return m.load(childContainer, viewModelResource.value, null, viewStrategy, true);\n    }).then(viewFactory => m.create(childContainer, BehaviorInstruction.dynamic(context.host, viewModel, viewFactory)));\n  }\n\n  ensureViewModel(context) {\n    let childContainer = context.childContainer = context.childContainer || context.container.createChild();\n\n    if (typeof context.viewModel === 'string') {\n      context.viewModel = context.viewResources ? context.viewResources.relativeToView(context.viewModel) : context.viewModel;\n\n      return this.viewEngine.importViewModelResource(context.viewModel).then(viewModelResource => {\n        childContainer.autoRegister(viewModelResource.value);\n\n        if (context.host) {\n          childContainer.registerInstance(DOM.Element, context.host);\n        }\n\n        context.viewModel = childContainer.viewModel = childContainer.get(viewModelResource.value);\n        context.viewModelResource = viewModelResource;\n        return context;\n      });\n    }\n\n    let m = metadata.getOrCreateOwn(metadata.resource, HtmlBehaviorResource, context.viewModel.constructor);\n    m.elementName = m.elementName || 'dynamic-element';\n    m.initialize(context.container || childContainer, context.viewModel.constructor);\n    context.viewModelResource = { metadata: m, value: context.viewModel.constructor };\n    childContainer.viewModel = context.viewModel;\n    return Promise.resolve(context);\n  }\n\n  compose(context) {\n    context.childContainer = context.childContainer || context.container.createChild();\n    context.view = this.viewLocator.getViewStrategy(context.view);\n\n    let transaction = context.childContainer.get(CompositionTransaction);\n    let compositionTransactionOwnershipToken = transaction.tryCapture();\n\n    if (compositionTransactionOwnershipToken) {\n      context.compositionTransactionOwnershipToken = compositionTransactionOwnershipToken;\n    } else {\n      context.compositionTransactionNotifier = transaction.enlist();\n    }\n\n    if (context.viewModel) {\n      return this._createControllerAndSwap(context);\n    } else if (context.view) {\n      if (context.viewResources) {\n        context.view.makeRelativeTo(context.viewResources.viewUrl);\n      }\n\n      return context.view.loadViewFactory(this.viewEngine, new ViewCompileInstruction()).then(viewFactory => {\n        let result = viewFactory.create(context.childContainer);\n        result.bind(context.bindingContext, context.overrideContext);\n\n        if (context.compositionTransactionOwnershipToken) {\n          return context.compositionTransactionOwnershipToken.waitForCompositionComplete().then(() => this._swap(context, result)).then(() => result);\n        }\n\n        return this._swap(context, result).then(() => result);\n      });\n    } else if (context.viewSlot) {\n      context.viewSlot.removeAll();\n\n      if (context.compositionTransactionNotifier) {\n        context.compositionTransactionNotifier.done();\n      }\n\n      return Promise.resolve(null);\n    }\n\n    return Promise.resolve(null);\n  }\n}) || _class17);\n\nexport let ElementConfigResource = class ElementConfigResource {\n  initialize(container, target) {}\n\n  register(registry, name) {}\n\n  load(container, target) {\n    let config = new target();\n    let eventManager = container.get(EventManager);\n    eventManager.registerElementConfig(config);\n  }\n};\n\nfunction validateBehaviorName(name, type) {\n  if (/[A-Z]/.test(name)) {\n    let newName = _hyphenate(name);\n    LogManager.getLogger('templating').warn(`'${ name }' is not a valid ${ type } name and has been converted to '${ newName }'. Upper-case letters are not allowed because the DOM is not case-sensitive.`);\n    return newName;\n  }\n  return name;\n}\n\nexport function resource(instance) {\n  return function (target) {\n    metadata.define(metadata.resource, instance, target);\n  };\n}\n\nexport function behavior(override) {\n  return function (target) {\n    if (override instanceof HtmlBehaviorResource) {\n      metadata.define(metadata.resource, override, target);\n    } else {\n      let r = metadata.getOrCreateOwn(metadata.resource, HtmlBehaviorResource, target);\n      Object.assign(r, override);\n    }\n  };\n}\n\nexport function customElement(name) {\n  return function (target) {\n    let r = metadata.getOrCreateOwn(metadata.resource, HtmlBehaviorResource, target);\n    r.elementName = validateBehaviorName(name, 'custom element');\n  };\n}\n\nexport function customAttribute(name, defaultBindingMode, aliases) {\n  return function (target) {\n    let r = metadata.getOrCreateOwn(metadata.resource, HtmlBehaviorResource, target);\n    r.attributeName = validateBehaviorName(name, 'custom attribute');\n    r.attributeDefaultBindingMode = defaultBindingMode;\n    r.aliases = aliases;\n  };\n}\n\nexport function templateController(target) {\n  let deco = function (t) {\n    let r = metadata.getOrCreateOwn(metadata.resource, HtmlBehaviorResource, t);\n    r.liftsContent = true;\n  };\n\n  return target ? deco(target) : deco;\n}\n\nexport function bindable(nameOrConfigOrTarget, key, descriptor) {\n  let deco = function (target, key2, descriptor2) {\n    let actualTarget = key2 ? target.constructor : target;\n    let r = metadata.getOrCreateOwn(metadata.resource, HtmlBehaviorResource, actualTarget);\n    let prop;\n\n    if (key2) {\n      nameOrConfigOrTarget = nameOrConfigOrTarget || {};\n      nameOrConfigOrTarget.name = key2;\n    }\n\n    prop = new BindableProperty(nameOrConfigOrTarget);\n    return prop.registerWith(actualTarget, r, descriptor2);\n  };\n\n  if (!nameOrConfigOrTarget) {\n    return deco;\n  }\n\n  if (key) {\n    let target = nameOrConfigOrTarget;\n    nameOrConfigOrTarget = null;\n    return deco(target, key, descriptor);\n  }\n\n  return deco;\n}\n\nexport function dynamicOptions(target) {\n  let deco = function (t) {\n    let r = metadata.getOrCreateOwn(metadata.resource, HtmlBehaviorResource, t);\n    r.hasDynamicOptions = true;\n  };\n\n  return target ? deco(target) : deco;\n}\n\nconst defaultShadowDOMOptions = { mode: 'open' };\n\nexport function useShadowDOM(targetOrOptions) {\n  let options = typeof targetOrOptions === 'function' || !targetOrOptions ? defaultShadowDOMOptions : targetOrOptions;\n\n  let deco = function (t) {\n    let r = metadata.getOrCreateOwn(metadata.resource, HtmlBehaviorResource, t);\n    r.targetShadowDOM = true;\n    r.shadowDOMOptions = options;\n  };\n\n  return typeof targetOrOptions === 'function' ? deco(targetOrOptions) : deco;\n}\n\nexport function processAttributes(processor) {\n  return function (t) {\n    let r = metadata.getOrCreateOwn(metadata.resource, HtmlBehaviorResource, t);\n    r.processAttributes = function (compiler, resources, node, attributes, elementInstruction) {\n      try {\n        processor(compiler, resources, node, attributes, elementInstruction);\n      } catch (error) {\n        LogManager.getLogger('templating').error(error);\n      }\n    };\n  };\n}\n\nfunction doNotProcessContent() {\n  return false;\n}\n\nexport function processContent(processor) {\n  return function (t) {\n    let r = metadata.getOrCreateOwn(metadata.resource, HtmlBehaviorResource, t);\n    r.processContent = processor ? function (compiler, resources, node, instruction) {\n      try {\n        return processor(compiler, resources, node, instruction);\n      } catch (error) {\n        LogManager.getLogger('templating').error(error);\n        return false;\n      }\n    } : doNotProcessContent;\n  };\n}\n\nexport function containerless(target) {\n  let deco = function (t) {\n    let r = metadata.getOrCreateOwn(metadata.resource, HtmlBehaviorResource, t);\n    r.containerless = true;\n  };\n\n  return target ? deco(target) : deco;\n}\n\nexport function useViewStrategy(strategy) {\n  return function (target) {\n    metadata.define(ViewLocator.viewStrategyMetadataKey, strategy, target);\n  };\n}\n\nexport function useView(path) {\n  return useViewStrategy(new RelativeViewStrategy(path));\n}\n\nexport function inlineView(markup, dependencies, dependencyBaseUrl) {\n  return useViewStrategy(new InlineViewStrategy(markup, dependencies, dependencyBaseUrl));\n}\n\nexport function noView(targetOrDependencies, dependencyBaseUrl) {\n  let target;\n  let dependencies;\n  if (typeof targetOrDependencies === 'function') {\n    target = targetOrDependencies;\n  } else {\n    dependencies = targetOrDependencies;\n    target = undefined;\n  }\n\n  let deco = function (t) {\n    metadata.define(ViewLocator.viewStrategyMetadataKey, new NoViewStrategy(dependencies, dependencyBaseUrl), t);\n  };\n\n  return target ? deco(target) : deco;\n}\n\nexport function elementConfig(target) {\n  let deco = function (t) {\n    metadata.define(metadata.resource, new ElementConfigResource(), t);\n  };\n\n  return target ? deco(target) : deco;\n}\n\nexport function viewResources(...resources) {\n  return function (target) {\n    metadata.define(ViewEngine.viewModelRequireMetadataKey, resources, target);\n  };\n}\n\nexport let TemplatingEngine = (_dec11 = inject(Container, ModuleAnalyzer, ViewCompiler, CompositionEngine), _dec11(_class18 = class TemplatingEngine {\n  constructor(container, moduleAnalyzer, viewCompiler, compositionEngine) {\n    this._container = container;\n    this._moduleAnalyzer = moduleAnalyzer;\n    this._viewCompiler = viewCompiler;\n    this._compositionEngine = compositionEngine;\n    container.registerInstance(Animator, Animator.instance = new Animator());\n  }\n\n  configureAnimator(animator) {\n    this._container.unregister(Animator);\n    this._container.registerInstance(Animator, Animator.instance = animator);\n  }\n\n  compose(context) {\n    return this._compositionEngine.compose(context);\n  }\n\n  enhance(instruction) {\n    if (instruction instanceof DOM.Element) {\n      instruction = { element: instruction };\n    }\n\n    let compilerInstructions = {};\n    let resources = instruction.resources || this._container.get(ViewResources);\n\n    this._viewCompiler._compileNode(instruction.element, resources, compilerInstructions, instruction.element.parentNode, 'root', true);\n\n    let factory = new ViewFactory(instruction.element, compilerInstructions, resources);\n    let container = instruction.container || this._container.createChild();\n    let view = factory.create(container, BehaviorInstruction.enhance());\n\n    view.bind(instruction.bindingContext || {}, instruction.overrideContext);\n\n    view.firstChild = view.lastChild = view.fragment;\n    view.fragment = DOM.createDocumentFragment();\n    view.attached();\n\n    return view;\n  }\n}) || _class18);\n","export * from './aurelia-templating';\nexport function configure(config) {\n  //config.globalResources([]);\n}\n","import {bindable} from \"aurelia-framework\";\n\nexport class ChildElementCustomElement {\n\n  @bindable text;\n\n}\n","import '../bower_components/font-awesome/font-awesome';\n\nimport \"./widget.css!\";\nimport {bindable} from \"aurelia-framework\";\n\nexport class WidgetCustomElement {\n\t@bindable title;\n\t@bindable icon;\n\t@bindable show;\n\n\tbind(bindingContext) {\n\t  this.$parent = bindingContext;\n\t}\n}\n"],"sourceRoot":".."}