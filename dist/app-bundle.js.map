{"version":3,"sources":["src/app.js","src/child-element.js","src/environment.js","src/main.js","src/utility.js","src/web-api.js","src/widget.js","src/resources/aurelia-templating.js","src/resources/index.js"],"names":["App","message","ChildElementCustomElement","bind","bindingContext","$parent","debug","testing","configure","aurelia","use","standardConfiguration","feature","developmentLogging","plugin","start","then","setRoot","areEqual","obj1","obj2","Object","keys","every","key","hasOwnProperty","latency","id","getId","contacts","firstName","lastName","email","phoneNumber","WebAPI","isRequesting","getContactList","Promise","setTimeout","results","map","x","resolve","getContactDetails","found","filter","JSON","parse","stringify","saveContact","contact","instance","index","indexOf","push","WidgetCustomElement","_hyphenate","_isAllWhitespace","viewEngineHooks","children","child","resource","behavior","customElement","customAttribute","templateController","bindable","dynamicOptions","useShadowDOM","processAttributes","processContent","containerless","useViewStrategy","useView","inlineView","noView","elementConfig","viewResources","LogManager","_class","_temp","_dec","_class2","_dec2","_class3","_dec3","_class4","_dec4","_class5","_dec5","_class6","_class7","_temp2","_dec6","_class8","_class9","_temp3","_class11","_dec7","_class13","_dec8","_class14","_class15","_temp4","_dec9","_class16","_dec10","_class17","_dec11","_class18","animationEvent","enterBegin","enterActive","enterDone","enterTimeout","leaveBegin","leaveActive","leaveDone","leaveTimeout","staggerNext","removeClassBegin","removeClassActive","removeClassDone","removeClassTimeout","addClassBegin","addClassActive","addClassDone","addClassTimeout","animateBegin","animateActive","animateDone","animateTimeout","sequenceBegin","sequenceDone","Animator","enter","element","leave","removeClass","className","classList","remove","addClass","add","animate","runSequence","animations","registerEffect","effectName","properties","unregisterEffect","CompositionTransactionNotifier","owner","_compositionCount","done","_tryCompleteTransaction","CompositionTransactionOwnershipToken","_ownershipToken","thenable","_createThenable","waitForCompositionComplete","_resolveCallback","reject","CompositionTransaction","tryCapture","enlist","token","capitalMatcher","addHyphenAndLower","char","toLowerCase","name","charAt","slice","replace","node","auInterpolationTarget","test","textContent","ViewEngineHooksResource","initialize","container","target","get","register","registry","registerViewEngineHooks","load","convention","endsWith","deco","t","define","ElementEvents","subscriptions","_enqueueHandler","handler","eventName","_dequeueHandler","splice","publish","detail","bubbles","cancelable","event","createCustomEvent","dispatchEvent","subscribe","dispose","removeEventListener","addEventListener","undefined","subscribeOnce","_handler","length","subscription","pop","disposeAll","ResourceLoadContext","dependencies","addDependency","url","hasDependency","ViewCompileInstruction","targetShadowDOM","compileSurrogate","associatedModuleId","normal","BehaviorInstruction","enhance","instruction","unitTest","type","attributes","anchorIsContainer","hasAttribute","initiatedByBehavior","attribute","attrName","dynamic","host","viewModel","viewFactory","inheritBindingContext","partReplacements","originalAttrName","skipContentProcessing","contentFactory","TargetInstruction","shadowSlot","parentInjectorId","contentExpression","expression","lifting","liftingInstruction","expressions","noExpressions","behaviorInstructions","providers","injectorId","elementInstruction","surrogate","values","slotName","slotFallbackFactory","freeze","viewStrategy","create","validate","loadViewFactory","compose","makeRelativeTo","noop","RelativeViewStrategy","path","absolutePath","viewEngine","compileInstruction","loadContext","moduleId","file","ConventionalViewStrategy","viewLocator","origin","viewUrl","convertOriginToViewUrl","NoViewStrategy","dependencyBaseUrl","entry","factoryIsReady","templateIsLoaded","i","ii","current","from","as","TemplateRegistryViewStrategy","factory","InlineViewStrategy","markup","template","createTemplateFromMarkup","ViewLocator","getViewStrategy","value","constructor","assert","strategy","viewStrategyMetadataKey","Error","createFallbackViewStrategy","substring","mi","BindingLanguage","inspectAttribute","resources","elementName","attrValue","createAttributeInstruction","info","existingInstruction","inspectTextContent","noNodes","SlotCustomAttribute","Element","auSlotAttribute","valueChanged","newValue","oldValue","PassThroughSlot","anchor","destinationName","fallbackFactory","viewSlot","destinationSlot","projections","contentView","attr","renderFallbackContent","view","nodes","projectionSource","ownerView","overrideContext","slots","ShadowDOM","distributeView","passThroughTo","addNode","removeNodes","detached","unbind","removeView","needsFallbackRendering","removeAll","projectFrom","created","attached","ShadowSlot","isContentProjectionSource","projectFromAnchors","destinationSlots","destination","distributeNodes","auOwnerView","auProjectionSource","auAssignedSlot","_findAnchor","parent","parentNode","insertBefore","undistributeView","hasSlots","find","auSlotProjectFrom","auProjectionChildren","fragment","appendChild","undistributeAll","viewIndex","lastView","projectTo","createComment","insertNodesBefore","slot","fallbackSlots","getSlotName","defaultSlotKey","destinationOverride","childNodes","Array","currentNode","nodeType","lookup","existing","ViewResources","bindingLanguage","hasParent","lookupFunctions","valueConverters","getValueConverter","bindingBehaviors","getBindingBehavior","elements","attributeMap","beforeCompile","afterCompile","beforeCreate","afterCreate","beforeBind","beforeUnbind","_tryAddHook","obj","func","counter","callbackName","toString","_invokeHook","one","two","three","four","hooks","getBindingLanguage","bindingLanguageFallback","patchInParent","newParent","originalParent","relativeToView","registerElement","tagName","getElement","mapAttribute","registerAttribute","knownAttribute","getAttribute","registerValueConverter","valueConverter","registerBindingBehavior","bindingBehavior","registerValue","getValue","View","controllers","bindings","firstChild","lastChild","fromCache","isBound","isAttached","controller","viewModelScope","animatableElement","_isUserControlled","returnToCache","returnViewToCache","_systemUpdate","addBinding","binding","refNode","appendNodesTo","end","next","nextSibling","getAnimatableElement","contains","ViewSlot","animator","contentSelectors","animateView","direction","transformChildNodesIntoView","last","removeChild","insert","move","sourceIndex","targetIndex","skipAnimation","removeAt","removeMany","viewsToRemove","rmPromises","forEach","animation","removeAction","all","projectToSlots","_projectionAdd","_projectionInsert","_projectionMove","_projectionRemove","_projectionRemoveAt","_projectionRemoveMany","_projectionRemoveAll","ProviderResolver","__providerId__","invoke","providerResolverInstance","elementContainerGet","BoundViewFactory","boundViewFactory","part","elementEvents","compositionTransaction","superGet","createElementContainer","createChild","_resolvers","set","_element","setAttribute","makeElementIntoAnchor","contentElement","replaceNode","applyInstructions","containers","shadowSlots","elementContainer","createBinding","commentAnchor","slotDestination","styleStringToObject","style","split","firstIndexOfColon","trim","styleObjectToString","result","applySurrogateInstruction","currentAttributeValue","styleObject","parentContainer","factoryCreateInstruction","setCacheSize","size","doNotOverrideIfAlreadySet","getCachedView","isCaching","ViewFactory","instructions","cacheSize","cache","Number","MAX_VALUE","parseInt","createInstruction","cachedView","cloneNode","instructables","querySelectorAll","root","instructable","surrogateInstruction","nextInjectorId","getNextInjectorId","lastAUTargetID","getNextAUTargetID","makeIntoInstructionTarget","auTargetID","makeShadowSlot","compiler","auShadowSlot","createElement","innerHTML","createDocumentFragment","compile","ViewCompiler","source","content","adoptNode","shadowDOM","_compileNode","targetId","ins","_compileSurrogate","targetLightDOM","_compileElement","wholeText","marker","currentChild","property","hasValues","defaultBindingMode","command","hasOptions","primaryProperty","alteredAttr","discrete","_configureProperties","liftsContent","attrToRemove","removeAttribute","elementProperty","targetProperty","ResourceModule","moduleInstance","mainResource","isInitialized","onLoaded","vs","metadata","main","loads","ResourceDescription","exportedValue","resourceTypeMeta","HtmlBehaviorResource","attributeName","ModuleAnalyzer","getAnalysis","analyze","mainResourceKey","fallbackValue","fallbackKey","conventional","resourceModule","decorates","logger","getLogger","ensureRegistryEntry","loader","urlOrRegistryEntry","loadTemplate","ProxyViewFactory","promise","ViewEngine","viewCompiler","moduleAnalyzer","appResources","_pluginMap","auSlotBehavior","addResourcePlugin","extension","implementation","addPlugin","registryEntry","onReady","loadTemplateResources","address","importIds","names","src","viewModelRequires","viewModelRequireMetadataKey","templateImportCount","req","importId","importViewResources","importViewModelResource","moduleImport","moduleMember","loadModule","normalizedId","viewModelModule","moduleIds","_applyLoaderPlugin","loadAllModules","analysis","associatedModule","allAnalysis","imports","lastIndexOf","ext","pluginName","applyPluginToUrl","Controller","scope","observerLookup","observerLocator","getOrCreateObserversLookup","handlesBind","boundProperties","_ensurePropertiesDefined","_initialize","owningView","handlesCreated","automate","skipSelfSubscriber","observer","selfSubscriber","publishing","call","__parentOverrideContext","assign","parentOverrideContext","handlesUnbind","handlesAttached","handlesDetached","BehaviorPropertyObserver","taskQueue","propertyName","initialValue","notqueued","currentValue","setValue","flushing","queueMicroTask","callSubscribers","context","callable","addSubscriber","unsubscribe","removeSubscriber","getObserver","__observers__","BindableProperty","nameOrConfig","oneWay","changeHandler","descriptor","registerWith","_configureDescriptor","configurable","enumerable","defaultValue","initializer","writable","defineOn","handlerName","prototype","defineProperty","createObserver","changeHandlerName","propertyChanged","behaviorHandlesBind","isDynamic","_createDynamicProperty","lastProviderId","nextProviderId","doProcessContent","doProcessAttributes","attributeDefaultBindingMode","shadowDOMOptions","usesShadowDOM","childBindings","hasDynamicOptions","addChildBinding","proto","htmlName","isArray","aliases","alias","transientView","options","hasChildNodes","toReplace","removeNode","viewHost","au","attachShadow","registerInstance","boundary","__propertiesDefined__","createChildObserverDecorator","selectorOrConfig","actualTarget","r","getOrCreateOwn","selector","ChildObserver","config","ChildObserverBinder","noMutations","trackMutation","groupedMutations","binder","record","mutations","onChildChange","binders","bindersLength","Map","added","addedNodes","removed","removedNodes","j","jj","k","onRemove","onAdd","matches","assignedSlot","anchors","__childObserver__","createMutationObserver","childList","subtree","observe","firstElementChild","items","nextElementSibling","prev","previousElementSibling","disconnect","previous","SwapStrategies","before","callback","with","after","tryActivateViewModel","skipActivation","activate","model","CompositionEngine","_swap","swapStrategy","swapOrder","previousViews","currentController","compositionTransactionNotifier","_createControllerAndSwap","createController","compositionTransactionOwnershipToken","childContainer","viewModelResource","m","ensureViewModel","autoRegister","transaction","ElementConfigResource","eventManager","registerElementConfig","validateBehaviorName","newName","warn","override","nameOrConfigOrTarget","key2","descriptor2","prop","defaultShadowDOMOptions","mode","targetOrOptions","processor","error","doNotProcessContent","targetOrDependencies","TemplatingEngine","compositionEngine","_container","_moduleAnalyzer","_viewCompiler","_compositionEngine","configureAnimator","unregister","compilerInstructions"],"mappings":"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","file":"app-bundle.js","sourcesContent":["import {bindable} from \"aurelia-framework\";\n\nexport class App {\n  constructor() {\n  // changing this property definition to a @bindable throws and exception\n  this.message = \"This is some data that I'll pass to the child of the widget.\";\n\n  }\n}\n","import {bindable} from \"aurelia-framework\";\n\nexport class ChildElementCustomElement {\n\tbind(bindingContext) {\n\t   this.$parent = bindingContext;\n\t}\n  @bindable text;\n\n}\n","export default {\n  debug: true,\n  testing: true\n};\n","import environment from './environment';\n\nexport function configure(aurelia) {\n  aurelia.use\n    .standardConfiguration()\n    .feature('resources');\n\n  if (environment.debug) {\n    aurelia.use.developmentLogging();\n  }\n\n  if (environment.testing) {\n    aurelia.use.plugin('aurelia-testing');\n  }\n\n  aurelia.start().then(() => aurelia.setRoot());\n}\n","export function areEqual(obj1, obj2) {\n\treturn Object.keys(obj1).every((key) => obj2.hasOwnProperty(key) && (obj1[key] === obj2[key]));\n};","let latency = 200;\nlet id = 0;\n\nfunction getId(){\n  return ++id;\n}\n\nlet contacts = [\n  {\n    id:getId(),\n    firstName:'John',\n    lastName:'Tolkien',\n    email:'tolkien@inklings.com',\n    phoneNumber:'867-5309'\n  },\n  {\n    id:getId(),\n    firstName:'Clive',\n    lastName:'Lewis',\n    email:'lewis@inklings.com',\n    phoneNumber:'867-5309'\n  },\n  {\n    id:getId(),\n    firstName:'Owen',\n    lastName:'Barfield',\n    email:'barfield@inklings.com',\n    phoneNumber:'867-5309'\n  },\n  {\n    id:getId(),\n    firstName:'Charles',\n    lastName:'Williams',\n    email:'williams@inklings.com',\n    phoneNumber:'867-5309'\n  },\n  {\n    id:getId(),\n    firstName:'Roger',\n    lastName:'Green',\n    email:'green@inklings.com',\n    phoneNumber:'867-5309'\n  }\n];\n\nexport class WebAPI {\n  isRequesting = false;\n  \n  getContactList(){\n    this.isRequesting = true;\n    return new Promise(resolve => {\n      setTimeout(() => {\n        let results = contacts.map(x =>  { return {\n          id:x.id,\n          firstName:x.firstName,\n          lastName:x.lastName,\n          email:x.email\n        }});\n        resolve(results);\n        this.isRequesting = false;\n      }, latency);\n    });\n  }\n\n  getContactDetails(id){\n    this.isRequesting = true;\n    return new Promise(resolve => {\n      setTimeout(() => {\n        let found = contacts.filter(x => x.id == id)[0];\n        resolve(JSON.parse(JSON.stringify(found)));\n        this.isRequesting = false;\n      }, latency);\n    });\n  }\n\n  saveContact(contact){\n    this.isRequesting = true;\n    return new Promise(resolve => {\n      setTimeout(() => {\n        let instance = JSON.parse(JSON.stringify(contact));\n        let found = contacts.filter(x => x.id == contact.id)[0];\n\n        if(found){\n          let index = contacts.indexOf(found);\n          contacts[index] = instance;\n        }else{\n          instance.id = getId();\n          contacts.push(instance);\n        }\n\n        this.isRequesting = false;\n        resolve(instance);\n      }, latency);\n    });\n  }\n}\n","// @import '../bower_components/font-awesome/css/font-awesome.css.map';\n//\n// @import \"./widget.css\";\nimport {bindable} from \"aurelia-framework\";\n\nexport class WidgetCustomElement {\n\t@bindable title;\n\t@bindable icon;\n\t@bindable show;\n\n\tbind(bindingContext) {\n\t  this.$parent = bindingContext;\n\t}\n}\n","var _class, _temp, _dec, _class2, _dec2, _class3, _dec3, _class4, _dec4, _class5, _dec5, _class6, _class7, _temp2, _dec6, _class8, _class9, _temp3, _class11, _dec7, _class13, _dec8, _class14, _class15, _temp4, _dec9, _class16, _dec10, _class17, _dec11, _class18;\n\nimport * as LogManager from 'aurelia-logging';\nimport { metadata, Origin, protocol } from 'aurelia-metadata';\nimport { DOM, PLATFORM, FEATURE } from 'aurelia-pal';\nimport { relativeToFile } from 'aurelia-path';\nimport { TemplateRegistryEntry, Loader } from 'aurelia-loader';\nimport { inject, Container, resolver } from 'aurelia-dependency-injection';\nimport { Binding, createOverrideContext, ValueConverterResource, BindingBehaviorResource, subscriberCollection, bindingMode, ObserverLocator, EventManager } from 'aurelia-binding';\nimport { TaskQueue } from 'aurelia-task-queue';\n\nexport const animationEvent = {\n  enterBegin: 'animation:enter:begin',\n  enterActive: 'animation:enter:active',\n  enterDone: 'animation:enter:done',\n  enterTimeout: 'animation:enter:timeout',\n\n  leaveBegin: 'animation:leave:begin',\n  leaveActive: 'animation:leave:active',\n  leaveDone: 'animation:leave:done',\n  leaveTimeout: 'animation:leave:timeout',\n\n  staggerNext: 'animation:stagger:next',\n\n  removeClassBegin: 'animation:remove-class:begin',\n  removeClassActive: 'animation:remove-class:active',\n  removeClassDone: 'animation:remove-class:done',\n  removeClassTimeout: 'animation:remove-class:timeout',\n\n  addClassBegin: 'animation:add-class:begin',\n  addClassActive: 'animation:add-class:active',\n  addClassDone: 'animation:add-class:done',\n  addClassTimeout: 'animation:add-class:timeout',\n\n  animateBegin: 'animation:animate:begin',\n  animateActive: 'animation:animate:active',\n  animateDone: 'animation:animate:done',\n  animateTimeout: 'animation:animate:timeout',\n\n  sequenceBegin: 'animation:sequence:begin',\n  sequenceDone: 'animation:sequence:done'\n};\n\nexport let Animator = class Animator {\n  enter(element) {\n    return Promise.resolve(false);\n  }\n\n  leave(element) {\n    return Promise.resolve(false);\n  }\n\n  removeClass(element, className) {\n    element.classList.remove(className);\n    return Promise.resolve(false);\n  }\n\n  addClass(element, className) {\n    element.classList.add(className);\n    return Promise.resolve(false);\n  }\n\n  animate(element, className) {\n    return Promise.resolve(false);\n  }\n\n  runSequence(animations) {}\n\n  registerEffect(effectName, properties) {}\n\n  unregisterEffect(effectName) {}\n};\n\nexport let CompositionTransactionNotifier = class CompositionTransactionNotifier {\n  constructor(owner) {\n    this.owner = owner;\n    this.owner._compositionCount++;\n  }\n\n  done() {\n    this.owner._compositionCount--;\n    this.owner._tryCompleteTransaction();\n  }\n};\n\nexport let CompositionTransactionOwnershipToken = class CompositionTransactionOwnershipToken {\n  constructor(owner) {\n    this.owner = owner;\n    this.owner._ownershipToken = this;\n    this.thenable = this._createThenable();\n  }\n\n  waitForCompositionComplete() {\n    this.owner._tryCompleteTransaction();\n    return this.thenable;\n  }\n\n  resolve() {\n    this._resolveCallback();\n  }\n\n  _createThenable() {\n    return new Promise((resolve, reject) => {\n      this._resolveCallback = resolve;\n    });\n  }\n};\n\nexport let CompositionTransaction = class CompositionTransaction {\n  constructor() {\n    this._ownershipToken = null;\n    this._compositionCount = 0;\n  }\n\n  tryCapture() {\n    return this._ownershipToken === null ? new CompositionTransactionOwnershipToken(this) : null;\n  }\n\n  enlist() {\n    return new CompositionTransactionNotifier(this);\n  }\n\n  _tryCompleteTransaction() {\n    if (this._compositionCount <= 0) {\n      this._compositionCount = 0;\n\n      if (this._ownershipToken !== null) {\n        let token = this._ownershipToken;\n        this._ownershipToken = null;\n        token.resolve();\n      }\n    }\n  }\n};\n\nconst capitalMatcher = /([A-Z])/g;\n\nfunction addHyphenAndLower(char) {\n  return '-' + char.toLowerCase();\n}\n\nexport function _hyphenate(name) {\n  return (name.charAt(0).toLowerCase() + name.slice(1)).replace(capitalMatcher, addHyphenAndLower);\n}\n\nexport function _isAllWhitespace(node) {\n  return !(node.auInterpolationTarget || /[^\\t\\n\\r ]/.test(node.textContent));\n}\n\nexport let ViewEngineHooksResource = class ViewEngineHooksResource {\n  constructor() {}\n\n  initialize(container, target) {\n    this.instance = container.get(target);\n  }\n\n  register(registry, name) {\n    registry.registerViewEngineHooks(this.instance);\n  }\n\n  load(container, target) {}\n\n  static convention(name) {\n    if (name.endsWith('ViewEngineHooks')) {\n      return new ViewEngineHooksResource();\n    }\n  }\n};\n\nexport function viewEngineHooks(target) {\n  let deco = function (t) {\n    metadata.define(metadata.resource, new ViewEngineHooksResource(), t);\n  };\n\n  return target ? deco(target) : deco;\n}\n\nexport let ElementEvents = class ElementEvents {\n  constructor(element) {\n    this.element = element;\n    this.subscriptions = {};\n  }\n\n  _enqueueHandler(handler) {\n    this.subscriptions[handler.eventName] = this.subscriptions[handler.eventName] || [];\n    this.subscriptions[handler.eventName].push(handler);\n  }\n\n  _dequeueHandler(handler) {\n    let index;\n    let subscriptions = this.subscriptions[handler.eventName];\n    if (subscriptions) {\n      index = subscriptions.indexOf(handler);\n      if (index > -1) {\n        subscriptions.splice(index, 1);\n      }\n    }\n    return handler;\n  }\n\n  publish(eventName, detail = {}, bubbles = true, cancelable = true) {\n    let event = DOM.createCustomEvent(eventName, { cancelable, bubbles, detail });\n    this.element.dispatchEvent(event);\n  }\n\n  subscribe(eventName, handler, bubbles = true) {\n    if (handler && typeof handler === 'function') {\n      handler.eventName = eventName;\n      handler.handler = handler;\n      handler.bubbles = bubbles;\n      handler.dispose = () => {\n        this.element.removeEventListener(eventName, handler, bubbles);\n        this._dequeueHandler(handler);\n      };\n      this.element.addEventListener(eventName, handler, bubbles);\n      this._enqueueHandler(handler);\n      return handler;\n    }\n\n    return undefined;\n  }\n\n  subscribeOnce(eventName, handler, bubbles = true) {\n    if (handler && typeof handler === 'function') {\n      let _handler = event => {\n        handler(event);\n        _handler.dispose();\n      };\n      return this.subscribe(eventName, _handler, bubbles);\n    }\n\n    return undefined;\n  }\n\n  dispose(eventName) {\n    if (eventName && typeof eventName === 'string') {\n      let subscriptions = this.subscriptions[eventName];\n      if (subscriptions) {\n        while (subscriptions.length) {\n          let subscription = subscriptions.pop();\n          if (subscription) {\n            subscription.dispose();\n          }\n        }\n      }\n    } else {\n      this.disposeAll();\n    }\n  }\n\n  disposeAll() {\n    for (let key in this.subscriptions) {\n      this.dispose(key);\n    }\n  }\n};\n\nexport let ResourceLoadContext = class ResourceLoadContext {\n  constructor() {\n    this.dependencies = {};\n  }\n\n  addDependency(url) {\n    this.dependencies[url] = true;\n  }\n\n  hasDependency(url) {\n    return url in this.dependencies;\n  }\n};\n\nexport let ViewCompileInstruction = class ViewCompileInstruction {\n  constructor(targetShadowDOM = false, compileSurrogate = false) {\n    this.targetShadowDOM = targetShadowDOM;\n    this.compileSurrogate = compileSurrogate;\n    this.associatedModuleId = null;\n  }\n};\n\nViewCompileInstruction.normal = new ViewCompileInstruction();\n\nexport let BehaviorInstruction = class BehaviorInstruction {\n  static enhance() {\n    let instruction = new BehaviorInstruction();\n    instruction.enhance = true;\n    return instruction;\n  }\n\n  static unitTest(type, attributes) {\n    let instruction = new BehaviorInstruction();\n    instruction.type = type;\n    instruction.attributes = attributes || {};\n    return instruction;\n  }\n\n  static element(node, type) {\n    let instruction = new BehaviorInstruction();\n    instruction.type = type;\n    instruction.attributes = {};\n    instruction.anchorIsContainer = !(node.hasAttribute('containerless') || type.containerless);\n    instruction.initiatedByBehavior = true;\n    return instruction;\n  }\n\n  static attribute(attrName, type) {\n    let instruction = new BehaviorInstruction();\n    instruction.attrName = attrName;\n    instruction.type = type || null;\n    instruction.attributes = {};\n    return instruction;\n  }\n\n  static dynamic(host, viewModel, viewFactory) {\n    let instruction = new BehaviorInstruction();\n    instruction.host = host;\n    instruction.viewModel = viewModel;\n    instruction.viewFactory = viewFactory;\n    instruction.inheritBindingContext = true;\n    return instruction;\n  }\n\n  constructor() {\n    this.initiatedByBehavior = false;\n    this.enhance = false;\n    this.partReplacements = null;\n    this.viewFactory = null;\n    this.originalAttrName = null;\n    this.skipContentProcessing = false;\n    this.contentFactory = null;\n    this.viewModel = null;\n    this.anchorIsContainer = false;\n    this.host = null;\n    this.attributes = null;\n    this.type = null;\n    this.attrName = null;\n    this.inheritBindingContext = false;\n  }\n};\n\nBehaviorInstruction.normal = new BehaviorInstruction();\n\nexport let TargetInstruction = (_temp = _class = class TargetInstruction {\n  static shadowSlot(parentInjectorId) {\n    let instruction = new TargetInstruction();\n    instruction.parentInjectorId = parentInjectorId;\n    instruction.shadowSlot = true;\n    return instruction;\n  }\n\n  static contentExpression(expression) {\n    let instruction = new TargetInstruction();\n    instruction.contentExpression = expression;\n    return instruction;\n  }\n\n  static lifting(parentInjectorId, liftingInstruction) {\n    let instruction = new TargetInstruction();\n    instruction.parentInjectorId = parentInjectorId;\n    instruction.expressions = TargetInstruction.noExpressions;\n    instruction.behaviorInstructions = [liftingInstruction];\n    instruction.viewFactory = liftingInstruction.viewFactory;\n    instruction.providers = [liftingInstruction.type.target];\n    instruction.lifting = true;\n    return instruction;\n  }\n\n  static normal(injectorId, parentInjectorId, providers, behaviorInstructions, expressions, elementInstruction) {\n    let instruction = new TargetInstruction();\n    instruction.injectorId = injectorId;\n    instruction.parentInjectorId = parentInjectorId;\n    instruction.providers = providers;\n    instruction.behaviorInstructions = behaviorInstructions;\n    instruction.expressions = expressions;\n    instruction.anchorIsContainer = elementInstruction ? elementInstruction.anchorIsContainer : true;\n    instruction.elementInstruction = elementInstruction;\n    return instruction;\n  }\n\n  static surrogate(providers, behaviorInstructions, expressions, values) {\n    let instruction = new TargetInstruction();\n    instruction.expressions = expressions;\n    instruction.behaviorInstructions = behaviorInstructions;\n    instruction.providers = providers;\n    instruction.values = values;\n    return instruction;\n  }\n\n  constructor() {\n    this.injectorId = null;\n    this.parentInjectorId = null;\n\n    this.shadowSlot = false;\n    this.slotName = null;\n    this.slotFallbackFactory = null;\n\n    this.contentExpression = null;\n\n    this.expressions = null;\n    this.behaviorInstructions = null;\n    this.providers = null;\n\n    this.viewFactory = null;\n\n    this.anchorIsContainer = false;\n    this.elementInstruction = null;\n    this.lifting = false;\n\n    this.values = null;\n  }\n}, _class.noExpressions = Object.freeze([]), _temp);\n\nexport const viewStrategy = protocol.create('aurelia:view-strategy', {\n  validate(target) {\n    if (!(typeof target.loadViewFactory === 'function')) {\n      return 'View strategies must implement: loadViewFactory(viewEngine: ViewEngine, compileInstruction: ViewCompileInstruction, loadContext?: ResourceLoadContext): Promise<ViewFactory>';\n    }\n\n    return true;\n  },\n  compose(target) {\n    if (!(typeof target.makeRelativeTo === 'function')) {\n      target.makeRelativeTo = PLATFORM.noop;\n    }\n  }\n});\n\nexport let RelativeViewStrategy = (_dec = viewStrategy(), _dec(_class2 = class RelativeViewStrategy {\n  constructor(path) {\n    this.path = path;\n    this.absolutePath = null;\n  }\n\n  loadViewFactory(viewEngine, compileInstruction, loadContext, target) {\n    if (this.absolutePath === null && this.moduleId) {\n      this.absolutePath = relativeToFile(this.path, this.moduleId);\n    }\n\n    compileInstruction.associatedModuleId = this.moduleId;\n    return viewEngine.loadViewFactory(this.absolutePath || this.path, compileInstruction, loadContext, target);\n  }\n\n  makeRelativeTo(file) {\n    if (this.absolutePath === null) {\n      this.absolutePath = relativeToFile(this.path, file);\n    }\n  }\n}) || _class2);\n\nexport let ConventionalViewStrategy = (_dec2 = viewStrategy(), _dec2(_class3 = class ConventionalViewStrategy {\n  constructor(viewLocator, origin) {\n    this.moduleId = origin.moduleId;\n    this.viewUrl = viewLocator.convertOriginToViewUrl(origin);\n  }\n\n  loadViewFactory(viewEngine, compileInstruction, loadContext, target) {\n    compileInstruction.associatedModuleId = this.moduleId;\n    return viewEngine.loadViewFactory(this.viewUrl, compileInstruction, loadContext, target);\n  }\n}) || _class3);\n\nexport let NoViewStrategy = (_dec3 = viewStrategy(), _dec3(_class4 = class NoViewStrategy {\n  constructor(dependencies, dependencyBaseUrl) {\n    this.dependencies = dependencies || null;\n    this.dependencyBaseUrl = dependencyBaseUrl || '';\n  }\n\n  loadViewFactory(viewEngine, compileInstruction, loadContext, target) {\n    let entry = this.entry;\n    let dependencies = this.dependencies;\n\n    if (entry && entry.factoryIsReady) {\n      return Promise.resolve(null);\n    }\n\n    this.entry = entry = new TemplateRegistryEntry(this.moduleId || this.dependencyBaseUrl);\n\n    entry.dependencies = [];\n    entry.templateIsLoaded = true;\n\n    if (dependencies !== null) {\n      for (let i = 0, ii = dependencies.length; i < ii; ++i) {\n        let current = dependencies[i];\n\n        if (typeof current === 'string' || typeof current === 'function') {\n          entry.addDependency(current);\n        } else {\n          entry.addDependency(current.from, current.as);\n        }\n      }\n    }\n\n    compileInstruction.associatedModuleId = this.moduleId;\n\n    return viewEngine.loadViewFactory(entry, compileInstruction, loadContext, target);\n  }\n}) || _class4);\n\nexport let TemplateRegistryViewStrategy = (_dec4 = viewStrategy(), _dec4(_class5 = class TemplateRegistryViewStrategy {\n  constructor(moduleId, entry) {\n    this.moduleId = moduleId;\n    this.entry = entry;\n  }\n\n  loadViewFactory(viewEngine, compileInstruction, loadContext, target) {\n    let entry = this.entry;\n\n    if (entry.factoryIsReady) {\n      return Promise.resolve(entry.factory);\n    }\n\n    compileInstruction.associatedModuleId = this.moduleId;\n    return viewEngine.loadViewFactory(entry, compileInstruction, loadContext, target);\n  }\n}) || _class5);\n\nexport let InlineViewStrategy = (_dec5 = viewStrategy(), _dec5(_class6 = class InlineViewStrategy {\n  constructor(markup, dependencies, dependencyBaseUrl) {\n    this.markup = markup;\n    this.dependencies = dependencies || null;\n    this.dependencyBaseUrl = dependencyBaseUrl || '';\n  }\n\n  loadViewFactory(viewEngine, compileInstruction, loadContext, target) {\n    let entry = this.entry;\n    let dependencies = this.dependencies;\n\n    if (entry && entry.factoryIsReady) {\n      return Promise.resolve(entry.factory);\n    }\n\n    this.entry = entry = new TemplateRegistryEntry(this.moduleId || this.dependencyBaseUrl);\n    entry.template = DOM.createTemplateFromMarkup(this.markup);\n\n    if (dependencies !== null) {\n      for (let i = 0, ii = dependencies.length; i < ii; ++i) {\n        let current = dependencies[i];\n\n        if (typeof current === 'string' || typeof current === 'function') {\n          entry.addDependency(current);\n        } else {\n          entry.addDependency(current.from, current.as);\n        }\n      }\n    }\n\n    compileInstruction.associatedModuleId = this.moduleId;\n    return viewEngine.loadViewFactory(entry, compileInstruction, loadContext, target);\n  }\n}) || _class6);\n\nexport let ViewLocator = (_temp2 = _class7 = class ViewLocator {\n  getViewStrategy(value) {\n    if (!value) {\n      return null;\n    }\n\n    if (typeof value === 'object' && 'getViewStrategy' in value) {\n      let origin = Origin.get(value.constructor);\n\n      value = value.getViewStrategy();\n\n      if (typeof value === 'string') {\n        value = new RelativeViewStrategy(value);\n      }\n\n      viewStrategy.assert(value);\n\n      if (origin.moduleId) {\n        value.makeRelativeTo(origin.moduleId);\n      }\n\n      return value;\n    }\n\n    if (typeof value === 'string') {\n      value = new RelativeViewStrategy(value);\n    }\n\n    if (viewStrategy.validate(value)) {\n      return value;\n    }\n\n    if (typeof value !== 'function') {\n      value = value.constructor;\n    }\n\n    let origin = Origin.get(value);\n    let strategy = metadata.get(ViewLocator.viewStrategyMetadataKey, value);\n\n    if (!strategy) {\n      if (!origin.moduleId) {\n        throw new Error('Cannot determine default view strategy for object.', value);\n      }\n\n      strategy = this.createFallbackViewStrategy(origin);\n    } else if (origin.moduleId) {\n      strategy.moduleId = origin.moduleId;\n    }\n\n    return strategy;\n  }\n\n  createFallbackViewStrategy(origin) {\n    return new ConventionalViewStrategy(this, origin);\n  }\n\n  convertOriginToViewUrl(origin) {\n    let moduleId = origin.moduleId;\n    let id = moduleId.endsWith('.js') || moduleId.endsWith('.ts') ? moduleId.substring(0, moduleId.length - 3) : moduleId;\n    return id + '.html';\n  }\n}, _class7.viewStrategyMetadataKey = 'aurelia:view-strategy', _temp2);\n\nfunction mi(name) {\n  throw new Error(`BindingLanguage must implement ${ name }().`);\n}\n\nexport let BindingLanguage = class BindingLanguage {\n  inspectAttribute(resources, elementName, attrName, attrValue) {\n    mi('inspectAttribute');\n  }\n\n  createAttributeInstruction(resources, element, info, existingInstruction) {\n    mi('createAttributeInstruction');\n  }\n\n  inspectTextContent(resources, value) {\n    mi('inspectTextContent');\n  }\n};\n\nlet noNodes = Object.freeze([]);\n\nexport let SlotCustomAttribute = (_dec6 = inject(DOM.Element), _dec6(_class8 = class SlotCustomAttribute {\n  constructor(element) {\n    this.element = element;\n    this.element.auSlotAttribute = this;\n  }\n\n  valueChanged(newValue, oldValue) {}\n}) || _class8);\n\nexport let PassThroughSlot = class PassThroughSlot {\n  constructor(anchor, name, destinationName, fallbackFactory) {\n    this.anchor = anchor;\n    this.anchor.viewSlot = this;\n    this.name = name;\n    this.destinationName = destinationName;\n    this.fallbackFactory = fallbackFactory;\n    this.destinationSlot = null;\n    this.projections = 0;\n    this.contentView = null;\n\n    let attr = new SlotCustomAttribute(this.anchor);\n    attr.value = this.destinationName;\n  }\n\n  get needsFallbackRendering() {\n    return this.fallbackFactory && this.projections === 0;\n  }\n\n  renderFallbackContent(view, nodes, projectionSource, index) {\n    if (this.contentView === null) {\n      this.contentView = this.fallbackFactory.create(this.ownerView.container);\n      this.contentView.bind(this.ownerView.bindingContext, this.ownerView.overrideContext);\n\n      let slots = Object.create(null);\n      slots[this.destinationSlot.name] = this.destinationSlot;\n\n      ShadowDOM.distributeView(this.contentView, slots, projectionSource, index, this.destinationSlot.name);\n    }\n  }\n\n  passThroughTo(destinationSlot) {\n    this.destinationSlot = destinationSlot;\n  }\n\n  addNode(view, node, projectionSource, index) {\n    if (this.contentView !== null) {\n      this.contentView.removeNodes();\n      this.contentView.detached();\n      this.contentView.unbind();\n      this.contentView = null;\n    }\n\n    if (node.viewSlot instanceof PassThroughSlot) {\n      node.viewSlot.passThroughTo(this);\n      return;\n    }\n\n    this.projections++;\n    this.destinationSlot.addNode(view, node, projectionSource, index);\n  }\n\n  removeView(view, projectionSource) {\n    this.projections--;\n    this.destinationSlot.removeView(view, projectionSource);\n\n    if (this.needsFallbackRendering) {\n      this.renderFallbackContent(null, noNodes, projectionSource);\n    }\n  }\n\n  removeAll(projectionSource) {\n    this.projections = 0;\n    this.destinationSlot.removeAll(projectionSource);\n\n    if (this.needsFallbackRendering) {\n      this.renderFallbackContent(null, noNodes, projectionSource);\n    }\n  }\n\n  projectFrom(view, projectionSource) {\n    this.destinationSlot.projectFrom(view, projectionSource);\n  }\n\n  created(ownerView) {\n    this.ownerView = ownerView;\n  }\n\n  bind(view) {\n    if (this.contentView) {\n      this.contentView.bind(view.bindingContext, view.overrideContext);\n    }\n  }\n\n  attached() {\n    if (this.contentView) {\n      this.contentView.attached();\n    }\n  }\n\n  detached() {\n    if (this.contentView) {\n      this.contentView.detached();\n    }\n  }\n\n  unbind() {\n    if (this.contentView) {\n      this.contentView.unbind();\n    }\n  }\n};\n\nexport let ShadowSlot = class ShadowSlot {\n  constructor(anchor, name, fallbackFactory) {\n    this.anchor = anchor;\n    this.anchor.isContentProjectionSource = true;\n    this.anchor.viewSlot = this;\n    this.name = name;\n    this.fallbackFactory = fallbackFactory;\n    this.contentView = null;\n    this.projections = 0;\n    this.children = [];\n    this.projectFromAnchors = null;\n    this.destinationSlots = null;\n  }\n\n  get needsFallbackRendering() {\n    return this.fallbackFactory && this.projections === 0;\n  }\n\n  addNode(view, node, projectionSource, index, destination) {\n    if (this.contentView !== null) {\n      this.contentView.removeNodes();\n      this.contentView.detached();\n      this.contentView.unbind();\n      this.contentView = null;\n    }\n\n    if (node.viewSlot instanceof PassThroughSlot) {\n      node.viewSlot.passThroughTo(this);\n      return;\n    }\n\n    if (this.destinationSlots !== null) {\n      ShadowDOM.distributeNodes(view, [node], this.destinationSlots, this, index);\n    } else {\n      node.auOwnerView = view;\n      node.auProjectionSource = projectionSource;\n      node.auAssignedSlot = this;\n\n      let anchor = this._findAnchor(view, node, projectionSource, index);\n      let parent = anchor.parentNode;\n\n      parent.insertBefore(node, anchor);\n      this.children.push(node);\n      this.projections++;\n    }\n  }\n\n  removeView(view, projectionSource) {\n    if (this.destinationSlots !== null) {\n      ShadowDOM.undistributeView(view, this.destinationSlots, this);\n    } else if (this.contentView && this.contentView.hasSlots) {\n      ShadowDOM.undistributeView(view, this.contentView.slots, projectionSource);\n    } else {\n      let found = this.children.find(x => x.auSlotProjectFrom === projectionSource);\n      if (found) {\n        let children = found.auProjectionChildren;\n\n        for (let i = 0, ii = children.length; i < ii; ++i) {\n          let child = children[i];\n\n          if (child.auOwnerView === view) {\n            children.splice(i, 1);\n            view.fragment.appendChild(child);\n            i--;ii--;\n            this.projections--;\n          }\n        }\n\n        if (this.needsFallbackRendering) {\n          this.renderFallbackContent(view, noNodes, projectionSource);\n        }\n      }\n    }\n  }\n\n  removeAll(projectionSource) {\n    if (this.destinationSlots !== null) {\n      ShadowDOM.undistributeAll(this.destinationSlots, this);\n    } else if (this.contentView && this.contentView.hasSlots) {\n      ShadowDOM.undistributeAll(this.contentView.slots, projectionSource);\n    } else {\n      let found = this.children.find(x => x.auSlotProjectFrom === projectionSource);\n\n      if (found) {\n        let children = found.auProjectionChildren;\n        for (let i = 0, ii = children.length; i < ii; ++i) {\n          let child = children[i];\n          child.auOwnerView.fragment.appendChild(child);\n          this.projections--;\n        }\n\n        found.auProjectionChildren = [];\n\n        if (this.needsFallbackRendering) {\n          this.renderFallbackContent(null, noNodes, projectionSource);\n        }\n      }\n    }\n  }\n\n  _findAnchor(view, node, projectionSource, index) {\n    if (projectionSource) {\n      let found = this.children.find(x => x.auSlotProjectFrom === projectionSource);\n      if (found) {\n        if (index !== undefined) {\n          let children = found.auProjectionChildren;\n          let viewIndex = -1;\n          let lastView;\n\n          for (let i = 0, ii = children.length; i < ii; ++i) {\n            let current = children[i];\n\n            if (current.auOwnerView !== lastView) {\n              viewIndex++;\n              lastView = current.auOwnerView;\n\n              if (viewIndex >= index && lastView !== view) {\n                children.splice(i, 0, node);\n                return current;\n              }\n            }\n          }\n        }\n\n        found.auProjectionChildren.push(node);\n        return found;\n      }\n    }\n\n    return this.anchor;\n  }\n\n  projectTo(slots) {\n    this.destinationSlots = slots;\n  }\n\n  projectFrom(view, projectionSource) {\n    let anchor = DOM.createComment('anchor');\n    let parent = this.anchor.parentNode;\n    anchor.auSlotProjectFrom = projectionSource;\n    anchor.auOwnerView = view;\n    anchor.auProjectionChildren = [];\n    parent.insertBefore(anchor, this.anchor);\n    this.children.push(anchor);\n\n    if (this.projectFromAnchors === null) {\n      this.projectFromAnchors = [];\n    }\n\n    this.projectFromAnchors.push(anchor);\n  }\n\n  renderFallbackContent(view, nodes, projectionSource, index) {\n    if (this.contentView === null) {\n      this.contentView = this.fallbackFactory.create(this.ownerView.container);\n      this.contentView.bind(this.ownerView.bindingContext, this.ownerView.overrideContext);\n      this.contentView.insertNodesBefore(this.anchor);\n    }\n\n    if (this.contentView.hasSlots) {\n      let slots = this.contentView.slots;\n      let projectFromAnchors = this.projectFromAnchors;\n\n      if (projectFromAnchors !== null) {\n        for (let slotName in slots) {\n          let slot = slots[slotName];\n\n          for (let i = 0, ii = projectFromAnchors.length; i < ii; ++i) {\n            let anchor = projectFromAnchors[i];\n            slot.projectFrom(anchor.auOwnerView, anchor.auSlotProjectFrom);\n          }\n        }\n      }\n\n      this.fallbackSlots = slots;\n      ShadowDOM.distributeNodes(view, nodes, slots, projectionSource, index);\n    }\n  }\n\n  created(ownerView) {\n    this.ownerView = ownerView;\n  }\n\n  bind(view) {\n    if (this.contentView) {\n      this.contentView.bind(view.bindingContext, view.overrideContext);\n    }\n  }\n\n  attached() {\n    if (this.contentView) {\n      this.contentView.attached();\n    }\n  }\n\n  detached() {\n    if (this.contentView) {\n      this.contentView.detached();\n    }\n  }\n\n  unbind() {\n    if (this.contentView) {\n      this.contentView.unbind();\n    }\n  }\n};\n\nexport let ShadowDOM = (_temp3 = _class9 = class ShadowDOM {\n\n  static getSlotName(node) {\n    if (node.auSlotAttribute === undefined) {\n      return ShadowDOM.defaultSlotKey;\n    }\n\n    return node.auSlotAttribute.value;\n  }\n\n  static distributeView(view, slots, projectionSource, index, destinationOverride) {\n    let nodes;\n\n    if (view === null) {\n      nodes = noNodes;\n    } else {\n      let childNodes = view.fragment.childNodes;\n      let ii = childNodes.length;\n      nodes = new Array(ii);\n\n      for (let i = 0; i < ii; ++i) {\n        nodes[i] = childNodes[i];\n      }\n    }\n\n    ShadowDOM.distributeNodes(view, nodes, slots, projectionSource, index, destinationOverride);\n  }\n\n  static undistributeView(view, slots, projectionSource) {\n    for (let slotName in slots) {\n      slots[slotName].removeView(view, projectionSource);\n    }\n  }\n\n  static undistributeAll(slots, projectionSource) {\n    for (let slotName in slots) {\n      slots[slotName].removeAll(projectionSource);\n    }\n  }\n\n  static distributeNodes(view, nodes, slots, projectionSource, index, destinationOverride) {\n    for (let i = 0, ii = nodes.length; i < ii; ++i) {\n      let currentNode = nodes[i];\n      let nodeType = currentNode.nodeType;\n\n      if (currentNode.isContentProjectionSource) {\n        currentNode.viewSlot.projectTo(slots);\n\n        for (let slotName in slots) {\n          slots[slotName].projectFrom(view, currentNode.viewSlot);\n        }\n\n        nodes.splice(i, 1);\n        ii--;i--;\n      } else if (nodeType === 1 || nodeType === 3 || currentNode.viewSlot instanceof PassThroughSlot) {\n        if (nodeType === 3 && _isAllWhitespace(currentNode)) {\n          nodes.splice(i, 1);\n          ii--;i--;\n        } else {\n          let found = slots[destinationOverride || ShadowDOM.getSlotName(currentNode)];\n\n          if (found) {\n            found.addNode(view, currentNode, projectionSource, index);\n            nodes.splice(i, 1);\n            ii--;i--;\n          }\n        }\n      } else {\n        nodes.splice(i, 1);\n        ii--;i--;\n      }\n    }\n\n    for (let slotName in slots) {\n      let slot = slots[slotName];\n\n      if (slot.needsFallbackRendering) {\n        slot.renderFallbackContent(view, nodes, projectionSource, index);\n      }\n    }\n  }\n}, _class9.defaultSlotKey = '__au-default-slot-key__', _temp3);\n\nfunction register(lookup, name, resource, type) {\n  if (!name) {\n    return;\n  }\n\n  let existing = lookup[name];\n  if (existing) {\n    if (existing !== resource) {\n      throw new Error(`Attempted to register ${ type } when one with the same name already exists. Name: ${ name }.`);\n    }\n\n    return;\n  }\n\n  lookup[name] = resource;\n}\n\nexport let ViewResources = class ViewResources {\n  constructor(parent, viewUrl) {\n    this.bindingLanguage = null;\n\n    this.parent = parent || null;\n    this.hasParent = this.parent !== null;\n    this.viewUrl = viewUrl || '';\n    this.lookupFunctions = {\n      valueConverters: this.getValueConverter.bind(this),\n      bindingBehaviors: this.getBindingBehavior.bind(this)\n    };\n    this.attributes = Object.create(null);\n    this.elements = Object.create(null);\n    this.valueConverters = Object.create(null);\n    this.bindingBehaviors = Object.create(null);\n    this.attributeMap = Object.create(null);\n    this.values = Object.create(null);\n    this.beforeCompile = this.afterCompile = this.beforeCreate = this.afterCreate = this.beforeBind = this.beforeUnbind = false;\n  }\n\n  _tryAddHook(obj, name) {\n    if (typeof obj[name] === 'function') {\n      let func = obj[name].bind(obj);\n      let counter = 1;\n      let callbackName;\n\n      while (this[callbackName = name + counter.toString()] !== undefined) {\n        counter++;\n      }\n\n      this[name] = true;\n      this[callbackName] = func;\n    }\n  }\n\n  _invokeHook(name, one, two, three, four) {\n    if (this.hasParent) {\n      this.parent._invokeHook(name, one, two, three, four);\n    }\n\n    if (this[name]) {\n      this[name + '1'](one, two, three, four);\n\n      let callbackName = name + '2';\n      if (this[callbackName]) {\n        this[callbackName](one, two, three, four);\n\n        callbackName = name + '3';\n        if (this[callbackName]) {\n          this[callbackName](one, two, three, four);\n\n          let counter = 4;\n\n          while (this[callbackName = name + counter.toString()] !== undefined) {\n            this[callbackName](one, two, three, four);\n            counter++;\n          }\n        }\n      }\n    }\n  }\n\n  registerViewEngineHooks(hooks) {\n    this._tryAddHook(hooks, 'beforeCompile');\n    this._tryAddHook(hooks, 'afterCompile');\n    this._tryAddHook(hooks, 'beforeCreate');\n    this._tryAddHook(hooks, 'afterCreate');\n    this._tryAddHook(hooks, 'beforeBind');\n    this._tryAddHook(hooks, 'beforeUnbind');\n  }\n\n  getBindingLanguage(bindingLanguageFallback) {\n    return this.bindingLanguage || (this.bindingLanguage = bindingLanguageFallback);\n  }\n\n  patchInParent(newParent) {\n    let originalParent = this.parent;\n\n    this.parent = newParent || null;\n    this.hasParent = this.parent !== null;\n\n    if (newParent.parent === null) {\n      newParent.parent = originalParent;\n      newParent.hasParent = originalParent !== null;\n    }\n  }\n\n  relativeToView(path) {\n    return relativeToFile(path, this.viewUrl);\n  }\n\n  registerElement(tagName, behavior) {\n    register(this.elements, tagName, behavior, 'an Element');\n  }\n\n  getElement(tagName) {\n    return this.elements[tagName] || (this.hasParent ? this.parent.getElement(tagName) : null);\n  }\n\n  mapAttribute(attribute) {\n    return this.attributeMap[attribute] || (this.hasParent ? this.parent.mapAttribute(attribute) : null);\n  }\n\n  registerAttribute(attribute, behavior, knownAttribute) {\n    this.attributeMap[attribute] = knownAttribute;\n    register(this.attributes, attribute, behavior, 'an Attribute');\n  }\n\n  getAttribute(attribute) {\n    return this.attributes[attribute] || (this.hasParent ? this.parent.getAttribute(attribute) : null);\n  }\n\n  registerValueConverter(name, valueConverter) {\n    register(this.valueConverters, name, valueConverter, 'a ValueConverter');\n  }\n\n  getValueConverter(name) {\n    return this.valueConverters[name] || (this.hasParent ? this.parent.getValueConverter(name) : null);\n  }\n\n  registerBindingBehavior(name, bindingBehavior) {\n    register(this.bindingBehaviors, name, bindingBehavior, 'a BindingBehavior');\n  }\n\n  getBindingBehavior(name) {\n    return this.bindingBehaviors[name] || (this.hasParent ? this.parent.getBindingBehavior(name) : null);\n  }\n\n  registerValue(name, value) {\n    register(this.values, name, value, 'a value');\n  }\n\n  getValue(name) {\n    return this.values[name] || (this.hasParent ? this.parent.getValue(name) : null);\n  }\n};\n\nexport let View = class View {\n  constructor(container, viewFactory, fragment, controllers, bindings, children, slots) {\n    this.container = container;\n    this.viewFactory = viewFactory;\n    this.resources = viewFactory.resources;\n    this.fragment = fragment;\n    this.firstChild = fragment.firstChild;\n    this.lastChild = fragment.lastChild;\n    this.controllers = controllers;\n    this.bindings = bindings;\n    this.children = children;\n    this.slots = slots;\n    this.hasSlots = false;\n    this.fromCache = false;\n    this.isBound = false;\n    this.isAttached = false;\n    this.bindingContext = null;\n    this.overrideContext = null;\n    this.controller = null;\n    this.viewModelScope = null;\n    this.animatableElement = undefined;\n    this._isUserControlled = false;\n    this.contentView = null;\n\n    for (let key in slots) {\n      this.hasSlots = true;\n      break;\n    }\n  }\n\n  returnToCache() {\n    this.viewFactory.returnViewToCache(this);\n  }\n\n  created() {\n    let i;\n    let ii;\n    let controllers = this.controllers;\n\n    for (i = 0, ii = controllers.length; i < ii; ++i) {\n      controllers[i].created(this);\n    }\n  }\n\n  bind(bindingContext, overrideContext, _systemUpdate) {\n    let controllers;\n    let bindings;\n    let children;\n    let i;\n    let ii;\n\n    if (_systemUpdate && this._isUserControlled) {\n      return;\n    }\n\n    if (this.isBound) {\n      if (this.bindingContext === bindingContext) {\n        return;\n      }\n\n      this.unbind();\n    }\n\n    this.isBound = true;\n    this.bindingContext = bindingContext;\n    this.overrideContext = overrideContext || createOverrideContext(bindingContext);\n\n    this.resources._invokeHook('beforeBind', this);\n\n    bindings = this.bindings;\n    for (i = 0, ii = bindings.length; i < ii; ++i) {\n      bindings[i].bind(this);\n    }\n\n    if (this.viewModelScope !== null) {\n      bindingContext.bind(this.viewModelScope.bindingContext, this.viewModelScope.overrideContext);\n      this.viewModelScope = null;\n    }\n\n    controllers = this.controllers;\n    for (i = 0, ii = controllers.length; i < ii; ++i) {\n      controllers[i].bind(this);\n    }\n\n    children = this.children;\n    for (i = 0, ii = children.length; i < ii; ++i) {\n      children[i].bind(bindingContext, overrideContext, true);\n    }\n\n    if (this.hasSlots) {\n      ShadowDOM.distributeView(this.contentView, this.slots);\n    }\n  }\n\n  addBinding(binding) {\n    this.bindings.push(binding);\n\n    if (this.isBound) {\n      binding.bind(this);\n    }\n  }\n\n  unbind() {\n    let controllers;\n    let bindings;\n    let children;\n    let i;\n    let ii;\n\n    if (this.isBound) {\n      this.isBound = false;\n      this.resources._invokeHook('beforeUnbind', this);\n\n      if (this.controller !== null) {\n        this.controller.unbind();\n      }\n\n      bindings = this.bindings;\n      for (i = 0, ii = bindings.length; i < ii; ++i) {\n        bindings[i].unbind();\n      }\n\n      controllers = this.controllers;\n      for (i = 0, ii = controllers.length; i < ii; ++i) {\n        controllers[i].unbind();\n      }\n\n      children = this.children;\n      for (i = 0, ii = children.length; i < ii; ++i) {\n        children[i].unbind();\n      }\n\n      this.bindingContext = null;\n      this.overrideContext = null;\n    }\n  }\n\n  insertNodesBefore(refNode) {\n    refNode.parentNode.insertBefore(this.fragment, refNode);\n  }\n\n  appendNodesTo(parent) {\n    parent.appendChild(this.fragment);\n  }\n\n  removeNodes() {\n    let fragment = this.fragment;\n    let current = this.firstChild;\n    let end = this.lastChild;\n    let next;\n\n    while (current) {\n      next = current.nextSibling;\n      fragment.appendChild(current);\n\n      if (current === end) {\n        break;\n      }\n\n      current = next;\n    }\n  }\n\n  attached() {\n    let controllers;\n    let children;\n    let i;\n    let ii;\n\n    if (this.isAttached) {\n      return;\n    }\n\n    this.isAttached = true;\n\n    if (this.controller !== null) {\n      this.controller.attached();\n    }\n\n    controllers = this.controllers;\n    for (i = 0, ii = controllers.length; i < ii; ++i) {\n      controllers[i].attached();\n    }\n\n    children = this.children;\n    for (i = 0, ii = children.length; i < ii; ++i) {\n      children[i].attached();\n    }\n  }\n\n  detached() {\n    let controllers;\n    let children;\n    let i;\n    let ii;\n\n    if (this.isAttached) {\n      this.isAttached = false;\n\n      if (this.controller !== null) {\n        this.controller.detached();\n      }\n\n      controllers = this.controllers;\n      for (i = 0, ii = controllers.length; i < ii; ++i) {\n        controllers[i].detached();\n      }\n\n      children = this.children;\n      for (i = 0, ii = children.length; i < ii; ++i) {\n        children[i].detached();\n      }\n    }\n  }\n};\n\nfunction getAnimatableElement(view) {\n  if (view.animatableElement !== undefined) {\n    return view.animatableElement;\n  }\n\n  let current = view.firstChild;\n\n  while (current && current.nodeType !== 1) {\n    current = current.nextSibling;\n  }\n\n  if (current && current.nodeType === 1) {\n    return view.animatableElement = current.classList.contains('au-animate') ? current : null;\n  }\n\n  return view.animatableElement = null;\n}\n\nexport let ViewSlot = class ViewSlot {\n  constructor(anchor, anchorIsContainer, animator = Animator.instance) {\n    this.anchor = anchor;\n    this.anchorIsContainer = anchorIsContainer;\n    this.bindingContext = null;\n    this.overrideContext = null;\n    this.animator = animator;\n    this.children = [];\n    this.isBound = false;\n    this.isAttached = false;\n    this.contentSelectors = null;\n    anchor.viewSlot = this;\n    anchor.isContentProjectionSource = false;\n  }\n\n  animateView(view, direction = 'enter') {\n    let animatableElement = getAnimatableElement(view);\n\n    if (animatableElement !== null) {\n      switch (direction) {\n        case 'enter':\n          return this.animator.enter(animatableElement);\n        case 'leave':\n          return this.animator.leave(animatableElement);\n        default:\n          throw new Error('Invalid animation direction: ' + direction);\n      }\n    }\n  }\n\n  transformChildNodesIntoView() {\n    let parent = this.anchor;\n\n    this.children.push({\n      fragment: parent,\n      firstChild: parent.firstChild,\n      lastChild: parent.lastChild,\n      returnToCache() {},\n      removeNodes() {\n        let last;\n\n        while (last = parent.lastChild) {\n          parent.removeChild(last);\n        }\n      },\n      created() {},\n      bind() {},\n      unbind() {},\n      attached() {},\n      detached() {}\n    });\n  }\n\n  bind(bindingContext, overrideContext) {\n    let i;\n    let ii;\n    let children;\n\n    if (this.isBound) {\n      if (this.bindingContext === bindingContext) {\n        return;\n      }\n\n      this.unbind();\n    }\n\n    this.isBound = true;\n    this.bindingContext = bindingContext = bindingContext || this.bindingContext;\n    this.overrideContext = overrideContext = overrideContext || this.overrideContext;\n\n    children = this.children;\n    for (i = 0, ii = children.length; i < ii; ++i) {\n      children[i].bind(bindingContext, overrideContext, true);\n    }\n  }\n\n  unbind() {\n    if (this.isBound) {\n      let i;\n      let ii;\n      let children = this.children;\n\n      this.isBound = false;\n      this.bindingContext = null;\n      this.overrideContext = null;\n\n      for (i = 0, ii = children.length; i < ii; ++i) {\n        children[i].unbind();\n      }\n    }\n  }\n\n  add(view) {\n    if (this.anchorIsContainer) {\n      view.appendNodesTo(this.anchor);\n    } else {\n      view.insertNodesBefore(this.anchor);\n    }\n\n    this.children.push(view);\n\n    if (this.isAttached) {\n      view.attached();\n      return this.animateView(view, 'enter');\n    }\n  }\n\n  insert(index, view) {\n    let children = this.children;\n    let length = children.length;\n\n    if (index === 0 && length === 0 || index >= length) {\n      return this.add(view);\n    }\n\n    view.insertNodesBefore(children[index].firstChild);\n    children.splice(index, 0, view);\n\n    if (this.isAttached) {\n      view.attached();\n      return this.animateView(view, 'enter');\n    }\n  }\n\n  move(sourceIndex, targetIndex) {\n    if (sourceIndex === targetIndex) {\n      return;\n    }\n\n    const children = this.children;\n    const view = children[sourceIndex];\n\n    view.removeNodes();\n    view.insertNodesBefore(children[targetIndex].firstChild);\n    children.splice(sourceIndex, 1);\n    children.splice(targetIndex, 0, view);\n  }\n\n  remove(view, returnToCache, skipAnimation) {\n    return this.removeAt(this.children.indexOf(view), returnToCache, skipAnimation);\n  }\n\n  removeMany(viewsToRemove, returnToCache, skipAnimation) {\n    const children = this.children;\n    let ii = viewsToRemove.length;\n    let i;\n    let rmPromises = [];\n\n    viewsToRemove.forEach(child => {\n      if (skipAnimation) {\n        child.removeNodes();\n        return;\n      }\n\n      let animation = this.animateView(child, 'leave');\n      if (animation) {\n        rmPromises.push(animation.then(() => child.removeNodes()));\n      } else {\n        child.removeNodes();\n      }\n    });\n\n    let removeAction = () => {\n      if (this.isAttached) {\n        for (i = 0; i < ii; ++i) {\n          viewsToRemove[i].detached();\n        }\n      }\n\n      if (returnToCache) {\n        for (i = 0; i < ii; ++i) {\n          viewsToRemove[i].returnToCache();\n        }\n      }\n\n      for (i = 0; i < ii; ++i) {\n        const index = children.indexOf(viewsToRemove[i]);\n        if (index >= 0) {\n          children.splice(index, 1);\n        }\n      }\n    };\n\n    if (rmPromises.length > 0) {\n      return Promise.all(rmPromises).then(() => removeAction());\n    }\n\n    return removeAction();\n  }\n\n  removeAt(index, returnToCache, skipAnimation) {\n    let view = this.children[index];\n\n    let removeAction = () => {\n      index = this.children.indexOf(view);\n      view.removeNodes();\n      this.children.splice(index, 1);\n\n      if (this.isAttached) {\n        view.detached();\n      }\n\n      if (returnToCache) {\n        view.returnToCache();\n      }\n\n      return view;\n    };\n\n    if (!skipAnimation) {\n      let animation = this.animateView(view, 'leave');\n      if (animation) {\n        return animation.then(() => removeAction());\n      }\n    }\n\n    return removeAction();\n  }\n\n  removeAll(returnToCache, skipAnimation) {\n    let children = this.children;\n    let ii = children.length;\n    let i;\n    let rmPromises = [];\n\n    children.forEach(child => {\n      if (skipAnimation) {\n        child.removeNodes();\n        return;\n      }\n\n      let animation = this.animateView(child, 'leave');\n      if (animation) {\n        rmPromises.push(animation.then(() => child.removeNodes()));\n      } else {\n        child.removeNodes();\n      }\n    });\n\n    let removeAction = () => {\n      if (this.isAttached) {\n        for (i = 0; i < ii; ++i) {\n          children[i].detached();\n        }\n      }\n\n      if (returnToCache) {\n        for (i = 0; i < ii; ++i) {\n          const child = children[i];\n\n          if (child) {\n            child.returnToCache();\n          }\n        }\n      }\n\n      this.children = [];\n    };\n\n    if (rmPromises.length > 0) {\n      return Promise.all(rmPromises).then(() => removeAction());\n    }\n\n    return removeAction();\n  }\n\n  attached() {\n    let i;\n    let ii;\n    let children;\n    let child;\n\n    if (this.isAttached) {\n      return;\n    }\n\n    this.isAttached = true;\n\n    children = this.children;\n    for (i = 0, ii = children.length; i < ii; ++i) {\n      child = children[i];\n      child.attached();\n      this.animateView(child, 'enter');\n    }\n  }\n\n  detached() {\n    let i;\n    let ii;\n    let children;\n\n    if (this.isAttached) {\n      this.isAttached = false;\n      children = this.children;\n      for (i = 0, ii = children.length; i < ii; ++i) {\n        children[i].detached();\n      }\n    }\n  }\n\n  projectTo(slots) {\n    this.projectToSlots = slots;\n    this.add = this._projectionAdd;\n    this.insert = this._projectionInsert;\n    this.move = this._projectionMove;\n    this.remove = this._projectionRemove;\n    this.removeAt = this._projectionRemoveAt;\n    this.removeMany = this._projectionRemoveMany;\n    this.removeAll = this._projectionRemoveAll;\n    this.children.forEach(view => ShadowDOM.distributeView(view, slots, this));\n  }\n\n  _projectionAdd(view) {\n    ShadowDOM.distributeView(view, this.projectToSlots, this);\n\n    this.children.push(view);\n\n    if (this.isAttached) {\n      view.attached();\n    }\n  }\n\n  _projectionInsert(index, view) {\n    if (index === 0 && !this.children.length || index >= this.children.length) {\n      this.add(view);\n    } else {\n      ShadowDOM.distributeView(view, this.projectToSlots, this, index);\n\n      this.children.splice(index, 0, view);\n\n      if (this.isAttached) {\n        view.attached();\n      }\n    }\n  }\n\n  _projectionMove(sourceIndex, targetIndex) {\n    if (sourceIndex === targetIndex) {\n      return;\n    }\n\n    const children = this.children;\n    const view = children[sourceIndex];\n\n    ShadowDOM.undistributeView(view, this.projectToSlots, this);\n    ShadowDOM.distributeView(view, this.projectToSlots, this, targetIndex);\n\n    children.splice(sourceIndex, 1);\n    children.splice(targetIndex, 0, view);\n  }\n\n  _projectionRemove(view, returnToCache) {\n    ShadowDOM.undistributeView(view, this.projectToSlots, this);\n    this.children.splice(this.children.indexOf(view), 1);\n\n    if (this.isAttached) {\n      view.detached();\n    }\n  }\n\n  _projectionRemoveAt(index, returnToCache) {\n    let view = this.children[index];\n\n    ShadowDOM.undistributeView(view, this.projectToSlots, this);\n    this.children.splice(index, 1);\n\n    if (this.isAttached) {\n      view.detached();\n    }\n  }\n\n  _projectionRemoveMany(viewsToRemove, returnToCache) {\n    viewsToRemove.forEach(view => this.remove(view, returnToCache));\n  }\n\n  _projectionRemoveAll(returnToCache) {\n    ShadowDOM.undistributeAll(this.projectToSlots, this);\n\n    let children = this.children;\n\n    if (this.isAttached) {\n      for (let i = 0, ii = children.length; i < ii; ++i) {\n        children[i].detached();\n      }\n    }\n\n    this.children = [];\n  }\n};\n\nlet ProviderResolver = resolver(_class11 = class ProviderResolver {\n  get(container, key) {\n    let id = key.__providerId__;\n    return id in container ? container[id] : container[id] = container.invoke(key);\n  }\n}) || _class11;\n\nlet providerResolverInstance = new ProviderResolver();\n\nfunction elementContainerGet(key) {\n  if (key === DOM.Element) {\n    return this.element;\n  }\n\n  if (key === BoundViewFactory) {\n    if (this.boundViewFactory) {\n      return this.boundViewFactory;\n    }\n\n    let factory = this.instruction.viewFactory;\n    let partReplacements = this.partReplacements;\n\n    if (partReplacements) {\n      factory = partReplacements[factory.part] || factory;\n    }\n\n    this.boundViewFactory = new BoundViewFactory(this, factory, partReplacements);\n    return this.boundViewFactory;\n  }\n\n  if (key === ViewSlot) {\n    if (this.viewSlot === undefined) {\n      this.viewSlot = new ViewSlot(this.element, this.instruction.anchorIsContainer);\n      this.element.isContentProjectionSource = this.instruction.lifting;\n      this.children.push(this.viewSlot);\n    }\n\n    return this.viewSlot;\n  }\n\n  if (key === ElementEvents) {\n    return this.elementEvents || (this.elementEvents = new ElementEvents(this.element));\n  }\n\n  if (key === CompositionTransaction) {\n    return this.compositionTransaction || (this.compositionTransaction = this.parent.get(key));\n  }\n\n  if (key === ViewResources) {\n    return this.viewResources;\n  }\n\n  if (key === TargetInstruction) {\n    return this.instruction;\n  }\n\n  return this.superGet(key);\n}\n\nfunction createElementContainer(parent, element, instruction, children, partReplacements, resources) {\n  let container = parent.createChild();\n  let providers;\n  let i;\n\n  container.element = element;\n  container.instruction = instruction;\n  container.children = children;\n  container.viewResources = resources;\n  container.partReplacements = partReplacements;\n\n  providers = instruction.providers;\n  i = providers.length;\n\n  while (i--) {\n    container._resolvers.set(providers[i], providerResolverInstance);\n  }\n\n  container.superGet = container.get;\n  container.get = elementContainerGet;\n\n  return container;\n}\n\nfunction hasAttribute(name) {\n  return this._element.hasAttribute(name);\n}\n\nfunction getAttribute(name) {\n  return this._element.getAttribute(name);\n}\n\nfunction setAttribute(name, value) {\n  this._element.setAttribute(name, value);\n}\n\nfunction makeElementIntoAnchor(element, elementInstruction) {\n  let anchor = DOM.createComment('anchor');\n\n  if (elementInstruction) {\n    let firstChild = element.firstChild;\n\n    if (firstChild && firstChild.tagName === 'AU-CONTENT') {\n      anchor.contentElement = firstChild;\n    }\n\n    anchor._element = element;\n\n    anchor.hasAttribute = hasAttribute;\n    anchor.getAttribute = getAttribute;\n    anchor.setAttribute = setAttribute;\n  }\n\n  DOM.replaceNode(anchor, element);\n\n  return anchor;\n}\n\nfunction applyInstructions(containers, element, instruction, controllers, bindings, children, shadowSlots, partReplacements, resources) {\n  let behaviorInstructions = instruction.behaviorInstructions;\n  let expressions = instruction.expressions;\n  let elementContainer;\n  let i;\n  let ii;\n  let current;\n  let instance;\n\n  if (instruction.contentExpression) {\n    bindings.push(instruction.contentExpression.createBinding(element.nextSibling));\n    element.nextSibling.auInterpolationTarget = true;\n    element.parentNode.removeChild(element);\n    return;\n  }\n\n  if (instruction.shadowSlot) {\n    let commentAnchor = DOM.createComment('slot');\n    let slot;\n\n    if (instruction.slotDestination) {\n      slot = new PassThroughSlot(commentAnchor, instruction.slotName, instruction.slotDestination, instruction.slotFallbackFactory);\n    } else {\n      slot = new ShadowSlot(commentAnchor, instruction.slotName, instruction.slotFallbackFactory);\n    }\n\n    DOM.replaceNode(commentAnchor, element);\n    shadowSlots[instruction.slotName] = slot;\n    controllers.push(slot);\n    return;\n  }\n\n  if (behaviorInstructions.length) {\n    if (!instruction.anchorIsContainer) {\n      element = makeElementIntoAnchor(element, instruction.elementInstruction);\n    }\n\n    containers[instruction.injectorId] = elementContainer = createElementContainer(containers[instruction.parentInjectorId], element, instruction, children, partReplacements, resources);\n\n    for (i = 0, ii = behaviorInstructions.length; i < ii; ++i) {\n      current = behaviorInstructions[i];\n      instance = current.type.create(elementContainer, current, element, bindings);\n      controllers.push(instance);\n    }\n  }\n\n  for (i = 0, ii = expressions.length; i < ii; ++i) {\n    bindings.push(expressions[i].createBinding(element));\n  }\n}\n\nfunction styleStringToObject(style, target) {\n  let attributes = style.split(';');\n  let firstIndexOfColon;\n  let i;\n  let current;\n  let key;\n  let value;\n\n  target = target || {};\n\n  for (i = 0; i < attributes.length; i++) {\n    current = attributes[i];\n    firstIndexOfColon = current.indexOf(':');\n    key = current.substring(0, firstIndexOfColon).trim();\n    value = current.substring(firstIndexOfColon + 1).trim();\n    target[key] = value;\n  }\n\n  return target;\n}\n\nfunction styleObjectToString(obj) {\n  let result = '';\n\n  for (let key in obj) {\n    result += key + ':' + obj[key] + ';';\n  }\n\n  return result;\n}\n\nfunction applySurrogateInstruction(container, element, instruction, controllers, bindings, children) {\n  let behaviorInstructions = instruction.behaviorInstructions;\n  let expressions = instruction.expressions;\n  let providers = instruction.providers;\n  let values = instruction.values;\n  let i;\n  let ii;\n  let current;\n  let instance;\n  let currentAttributeValue;\n\n  i = providers.length;\n  while (i--) {\n    container._resolvers.set(providers[i], providerResolverInstance);\n  }\n\n  for (let key in values) {\n    currentAttributeValue = element.getAttribute(key);\n\n    if (currentAttributeValue) {\n      if (key === 'class') {\n        element.setAttribute('class', currentAttributeValue + ' ' + values[key]);\n      } else if (key === 'style') {\n        let styleObject = styleStringToObject(values[key]);\n        styleStringToObject(currentAttributeValue, styleObject);\n        element.setAttribute('style', styleObjectToString(styleObject));\n      }\n    } else {\n      element.setAttribute(key, values[key]);\n    }\n  }\n\n  if (behaviorInstructions.length) {\n    for (i = 0, ii = behaviorInstructions.length; i < ii; ++i) {\n      current = behaviorInstructions[i];\n      instance = current.type.create(container, current, element, bindings);\n\n      if (instance.contentView) {\n        children.push(instance.contentView);\n      }\n\n      controllers.push(instance);\n    }\n  }\n\n  for (i = 0, ii = expressions.length; i < ii; ++i) {\n    bindings.push(expressions[i].createBinding(element));\n  }\n}\n\nexport let BoundViewFactory = class BoundViewFactory {\n  constructor(parentContainer, viewFactory, partReplacements) {\n    this.parentContainer = parentContainer;\n    this.viewFactory = viewFactory;\n    this.factoryCreateInstruction = { partReplacements: partReplacements };\n  }\n\n  create() {\n    let view = this.viewFactory.create(this.parentContainer.createChild(), this.factoryCreateInstruction);\n    view._isUserControlled = true;\n    return view;\n  }\n\n  get isCaching() {\n    return this.viewFactory.isCaching;\n  }\n\n  setCacheSize(size, doNotOverrideIfAlreadySet) {\n    this.viewFactory.setCacheSize(size, doNotOverrideIfAlreadySet);\n  }\n\n  getCachedView() {\n    return this.viewFactory.getCachedView();\n  }\n\n  returnViewToCache(view) {\n    this.viewFactory.returnViewToCache(view);\n  }\n};\n\nexport let ViewFactory = class ViewFactory {\n  constructor(template, instructions, resources) {\n    this.isCaching = false;\n\n    this.template = template;\n    this.instructions = instructions;\n    this.resources = resources;\n    this.cacheSize = -1;\n    this.cache = null;\n  }\n\n  setCacheSize(size, doNotOverrideIfAlreadySet) {\n    if (size) {\n      if (size === '*') {\n        size = Number.MAX_VALUE;\n      } else if (typeof size === 'string') {\n        size = parseInt(size, 10);\n      }\n    }\n\n    if (this.cacheSize === -1 || !doNotOverrideIfAlreadySet) {\n      this.cacheSize = size;\n    }\n\n    if (this.cacheSize > 0) {\n      this.cache = [];\n    } else {\n      this.cache = null;\n    }\n\n    this.isCaching = this.cacheSize > 0;\n  }\n\n  getCachedView() {\n    return this.cache !== null ? this.cache.pop() || null : null;\n  }\n\n  returnViewToCache(view) {\n    if (view.isAttached) {\n      view.detached();\n    }\n\n    if (view.isBound) {\n      view.unbind();\n    }\n\n    if (this.cache !== null && this.cache.length < this.cacheSize) {\n      view.fromCache = true;\n      this.cache.push(view);\n    }\n  }\n\n  create(container, createInstruction, element) {\n    createInstruction = createInstruction || BehaviorInstruction.normal;\n\n    let cachedView = this.getCachedView();\n    if (cachedView !== null) {\n      return cachedView;\n    }\n\n    let fragment = createInstruction.enhance ? this.template : this.template.cloneNode(true);\n    let instructables = fragment.querySelectorAll('.au-target');\n    let instructions = this.instructions;\n    let resources = this.resources;\n    let controllers = [];\n    let bindings = [];\n    let children = [];\n    let shadowSlots = Object.create(null);\n    let containers = { root: container };\n    let partReplacements = createInstruction.partReplacements;\n    let i;\n    let ii;\n    let view;\n    let instructable;\n    let instruction;\n\n    this.resources._invokeHook('beforeCreate', this, container, fragment, createInstruction);\n\n    if (element && this.surrogateInstruction !== null) {\n      applySurrogateInstruction(container, element, this.surrogateInstruction, controllers, bindings, children);\n    }\n\n    if (createInstruction.enhance && fragment.hasAttribute('au-target-id')) {\n      instructable = fragment;\n      instruction = instructions[instructable.getAttribute('au-target-id')];\n      applyInstructions(containers, instructable, instruction, controllers, bindings, children, shadowSlots, partReplacements, resources);\n    }\n\n    for (i = 0, ii = instructables.length; i < ii; ++i) {\n      instructable = instructables[i];\n      instruction = instructions[instructable.getAttribute('au-target-id')];\n      applyInstructions(containers, instructable, instruction, controllers, bindings, children, shadowSlots, partReplacements, resources);\n    }\n\n    view = new View(container, this, fragment, controllers, bindings, children, shadowSlots);\n\n    if (!createInstruction.initiatedByBehavior) {\n      view.created();\n    }\n\n    this.resources._invokeHook('afterCreate', view);\n\n    return view;\n  }\n};\n\nlet nextInjectorId = 0;\nfunction getNextInjectorId() {\n  return ++nextInjectorId;\n}\n\nlet lastAUTargetID = 0;\nfunction getNextAUTargetID() {\n  return (++lastAUTargetID).toString();\n}\n\nfunction makeIntoInstructionTarget(element) {\n  let value = element.getAttribute('class');\n  let auTargetID = getNextAUTargetID();\n\n  element.setAttribute('class', value ? value + ' au-target' : 'au-target');\n  element.setAttribute('au-target-id', auTargetID);\n\n  return auTargetID;\n}\n\nfunction makeShadowSlot(compiler, resources, node, instructions, parentInjectorId) {\n  let auShadowSlot = DOM.createElement('au-shadow-slot');\n  DOM.replaceNode(auShadowSlot, node);\n\n  let auTargetID = makeIntoInstructionTarget(auShadowSlot);\n  let instruction = TargetInstruction.shadowSlot(parentInjectorId);\n\n  instruction.slotName = node.getAttribute('name') || ShadowDOM.defaultSlotKey;\n  instruction.slotDestination = node.getAttribute('slot');\n\n  if (node.innerHTML.trim()) {\n    let fragment = DOM.createDocumentFragment();\n    let child;\n\n    while (child = node.firstChild) {\n      fragment.appendChild(child);\n    }\n\n    instruction.slotFallbackFactory = compiler.compile(fragment, resources);\n  }\n\n  instructions[auTargetID] = instruction;\n\n  return auShadowSlot;\n}\n\nexport let ViewCompiler = (_dec7 = inject(BindingLanguage, ViewResources), _dec7(_class13 = class ViewCompiler {\n  constructor(bindingLanguage, resources) {\n    this.bindingLanguage = bindingLanguage;\n    this.resources = resources;\n  }\n\n  compile(source, resources, compileInstruction) {\n    resources = resources || this.resources;\n    compileInstruction = compileInstruction || ViewCompileInstruction.normal;\n    source = typeof source === 'string' ? DOM.createTemplateFromMarkup(source) : source;\n\n    let content;\n    let part;\n    let cacheSize;\n\n    if (source.content) {\n      part = source.getAttribute('part');\n      cacheSize = source.getAttribute('view-cache');\n      content = DOM.adoptNode(source.content);\n    } else {\n      content = source;\n    }\n\n    compileInstruction.targetShadowDOM = compileInstruction.targetShadowDOM && FEATURE.shadowDOM;\n    resources._invokeHook('beforeCompile', content, resources, compileInstruction);\n\n    let instructions = {};\n    this._compileNode(content, resources, instructions, source, 'root', !compileInstruction.targetShadowDOM);\n\n    let firstChild = content.firstChild;\n    if (firstChild && firstChild.nodeType === 1) {\n      let targetId = firstChild.getAttribute('au-target-id');\n      if (targetId) {\n        let ins = instructions[targetId];\n\n        if (ins.shadowSlot || ins.lifting || ins.elementInstruction && !ins.elementInstruction.anchorIsContainer) {\n          content.insertBefore(DOM.createComment('view'), firstChild);\n        }\n      }\n    }\n\n    let factory = new ViewFactory(content, instructions, resources);\n\n    factory.surrogateInstruction = compileInstruction.compileSurrogate ? this._compileSurrogate(source, resources) : null;\n    factory.part = part;\n\n    if (cacheSize) {\n      factory.setCacheSize(cacheSize);\n    }\n\n    resources._invokeHook('afterCompile', factory);\n\n    return factory;\n  }\n\n  _compileNode(node, resources, instructions, parentNode, parentInjectorId, targetLightDOM) {\n    switch (node.nodeType) {\n      case 1:\n        return this._compileElement(node, resources, instructions, parentNode, parentInjectorId, targetLightDOM);\n      case 3:\n        let expression = resources.getBindingLanguage(this.bindingLanguage).inspectTextContent(resources, node.wholeText);\n        if (expression) {\n          let marker = DOM.createElement('au-marker');\n          let auTargetID = makeIntoInstructionTarget(marker);\n          (node.parentNode || parentNode).insertBefore(marker, node);\n          node.textContent = ' ';\n          instructions[auTargetID] = TargetInstruction.contentExpression(expression);\n\n          while (node.nextSibling && node.nextSibling.nodeType === 3) {\n            (node.parentNode || parentNode).removeChild(node.nextSibling);\n          }\n        } else {\n          while (node.nextSibling && node.nextSibling.nodeType === 3) {\n            node = node.nextSibling;\n          }\n        }\n        return node.nextSibling;\n      case 11:\n        let currentChild = node.firstChild;\n        while (currentChild) {\n          currentChild = this._compileNode(currentChild, resources, instructions, node, parentInjectorId, targetLightDOM);\n        }\n        break;\n      default:\n        break;\n    }\n\n    return node.nextSibling;\n  }\n\n  _compileSurrogate(node, resources) {\n    let tagName = node.tagName.toLowerCase();\n    let attributes = node.attributes;\n    let bindingLanguage = resources.getBindingLanguage(this.bindingLanguage);\n    let knownAttribute;\n    let property;\n    let instruction;\n    let i;\n    let ii;\n    let attr;\n    let attrName;\n    let attrValue;\n    let info;\n    let type;\n    let expressions = [];\n    let expression;\n    let behaviorInstructions = [];\n    let values = {};\n    let hasValues = false;\n    let providers = [];\n\n    for (i = 0, ii = attributes.length; i < ii; ++i) {\n      attr = attributes[i];\n      attrName = attr.name;\n      attrValue = attr.value;\n\n      info = bindingLanguage.inspectAttribute(resources, tagName, attrName, attrValue);\n      type = resources.getAttribute(info.attrName);\n\n      if (type) {\n        knownAttribute = resources.mapAttribute(info.attrName);\n        if (knownAttribute) {\n          property = type.attributes[knownAttribute];\n\n          if (property) {\n            info.defaultBindingMode = property.defaultBindingMode;\n\n            if (!info.command && !info.expression) {\n              info.command = property.hasOptions ? 'options' : null;\n            }\n\n            if (info.command && info.command !== 'options' && type.primaryProperty) {\n              const primaryProperty = type.primaryProperty;\n              attrName = info.attrName = primaryProperty.name;\n\n              info.defaultBindingMode = primaryProperty.defaultBindingMode;\n            }\n          }\n        }\n      }\n\n      instruction = bindingLanguage.createAttributeInstruction(resources, node, info, undefined, type);\n\n      if (instruction) {\n        if (instruction.alteredAttr) {\n          type = resources.getAttribute(instruction.attrName);\n        }\n\n        if (instruction.discrete) {\n          expressions.push(instruction);\n        } else {\n          if (type) {\n            instruction.type = type;\n            this._configureProperties(instruction, resources);\n\n            if (type.liftsContent) {\n              throw new Error('You cannot place a template controller on a surrogate element.');\n            } else {\n              behaviorInstructions.push(instruction);\n            }\n          } else {\n            expressions.push(instruction.attributes[instruction.attrName]);\n          }\n        }\n      } else {\n        if (type) {\n          instruction = BehaviorInstruction.attribute(attrName, type);\n          instruction.attributes[resources.mapAttribute(attrName)] = attrValue;\n\n          if (type.liftsContent) {\n            throw new Error('You cannot place a template controller on a surrogate element.');\n          } else {\n            behaviorInstructions.push(instruction);\n          }\n        } else if (attrName !== 'id' && attrName !== 'part' && attrName !== 'replace-part') {\n          hasValues = true;\n          values[attrName] = attrValue;\n        }\n      }\n    }\n\n    if (expressions.length || behaviorInstructions.length || hasValues) {\n      for (i = 0, ii = behaviorInstructions.length; i < ii; ++i) {\n        instruction = behaviorInstructions[i];\n        instruction.type.compile(this, resources, node, instruction);\n        providers.push(instruction.type.target);\n      }\n\n      for (i = 0, ii = expressions.length; i < ii; ++i) {\n        expression = expressions[i];\n        if (expression.attrToRemove !== undefined) {\n          node.removeAttribute(expression.attrToRemove);\n        }\n      }\n\n      return TargetInstruction.surrogate(providers, behaviorInstructions, expressions, values);\n    }\n\n    return null;\n  }\n\n  _compileElement(node, resources, instructions, parentNode, parentInjectorId, targetLightDOM) {\n    let tagName = node.tagName.toLowerCase();\n    let attributes = node.attributes;\n    let expressions = [];\n    let expression;\n    let behaviorInstructions = [];\n    let providers = [];\n    let bindingLanguage = resources.getBindingLanguage(this.bindingLanguage);\n    let liftingInstruction;\n    let viewFactory;\n    let type;\n    let elementInstruction;\n    let elementProperty;\n    let i;\n    let ii;\n    let attr;\n    let attrName;\n    let attrValue;\n    let instruction;\n    let info;\n    let property;\n    let knownAttribute;\n    let auTargetID;\n    let injectorId;\n\n    if (tagName === 'slot') {\n      if (targetLightDOM) {\n        node = makeShadowSlot(this, resources, node, instructions, parentInjectorId);\n      }\n      return node.nextSibling;\n    } else if (tagName === 'template') {\n      viewFactory = this.compile(node, resources);\n      viewFactory.part = node.getAttribute('part');\n    } else {\n      type = resources.getElement(node.getAttribute('as-element') || tagName);\n      if (type) {\n        elementInstruction = BehaviorInstruction.element(node, type);\n        type.processAttributes(this, resources, node, attributes, elementInstruction);\n        behaviorInstructions.push(elementInstruction);\n      }\n    }\n\n    for (i = 0, ii = attributes.length; i < ii; ++i) {\n      attr = attributes[i];\n      attrName = attr.name;\n      attrValue = attr.value;\n      info = bindingLanguage.inspectAttribute(resources, tagName, attrName, attrValue);\n\n      if (targetLightDOM && info.attrName === 'slot') {\n        info.attrName = attrName = 'au-slot';\n      }\n\n      type = resources.getAttribute(info.attrName);\n      elementProperty = null;\n\n      if (type) {\n        knownAttribute = resources.mapAttribute(info.attrName);\n        if (knownAttribute) {\n          property = type.attributes[knownAttribute];\n\n          if (property) {\n            info.defaultBindingMode = property.defaultBindingMode;\n\n            if (!info.command && !info.expression) {\n              info.command = property.hasOptions ? 'options' : null;\n            }\n\n            if (info.command && info.command !== 'options' && type.primaryProperty) {\n              const primaryProperty = type.primaryProperty;\n              attrName = info.attrName = primaryProperty.name;\n\n              info.defaultBindingMode = primaryProperty.defaultBindingMode;\n            }\n          }\n        }\n      } else if (elementInstruction) {\n        elementProperty = elementInstruction.type.attributes[info.attrName];\n        if (elementProperty) {\n          info.defaultBindingMode = elementProperty.defaultBindingMode;\n        }\n      }\n\n      if (elementProperty) {\n        instruction = bindingLanguage.createAttributeInstruction(resources, node, info, elementInstruction);\n      } else {\n        instruction = bindingLanguage.createAttributeInstruction(resources, node, info, undefined, type);\n      }\n\n      if (instruction) {\n        if (instruction.alteredAttr) {\n          type = resources.getAttribute(instruction.attrName);\n        }\n\n        if (instruction.discrete) {\n          expressions.push(instruction);\n        } else {\n          if (type) {\n            instruction.type = type;\n            this._configureProperties(instruction, resources);\n\n            if (type.liftsContent) {\n              instruction.originalAttrName = attrName;\n              liftingInstruction = instruction;\n              break;\n            } else {\n              behaviorInstructions.push(instruction);\n            }\n          } else if (elementProperty) {\n            elementInstruction.attributes[info.attrName].targetProperty = elementProperty.name;\n          } else {\n            expressions.push(instruction.attributes[instruction.attrName]);\n          }\n        }\n      } else {\n        if (type) {\n          instruction = BehaviorInstruction.attribute(attrName, type);\n          instruction.attributes[resources.mapAttribute(attrName)] = attrValue;\n\n          if (type.liftsContent) {\n            instruction.originalAttrName = attrName;\n            liftingInstruction = instruction;\n            break;\n          } else {\n            behaviorInstructions.push(instruction);\n          }\n        } else if (elementProperty) {\n          elementInstruction.attributes[attrName] = attrValue;\n        }\n      }\n    }\n\n    if (liftingInstruction) {\n      liftingInstruction.viewFactory = viewFactory;\n      node = liftingInstruction.type.compile(this, resources, node, liftingInstruction, parentNode);\n      auTargetID = makeIntoInstructionTarget(node);\n      instructions[auTargetID] = TargetInstruction.lifting(parentInjectorId, liftingInstruction);\n    } else {\n      if (expressions.length || behaviorInstructions.length) {\n        injectorId = behaviorInstructions.length ? getNextInjectorId() : false;\n\n        for (i = 0, ii = behaviorInstructions.length; i < ii; ++i) {\n          instruction = behaviorInstructions[i];\n          instruction.type.compile(this, resources, node, instruction, parentNode);\n          providers.push(instruction.type.target);\n        }\n\n        for (i = 0, ii = expressions.length; i < ii; ++i) {\n          expression = expressions[i];\n          if (expression.attrToRemove !== undefined) {\n            node.removeAttribute(expression.attrToRemove);\n          }\n        }\n\n        auTargetID = makeIntoInstructionTarget(node);\n        instructions[auTargetID] = TargetInstruction.normal(injectorId, parentInjectorId, providers, behaviorInstructions, expressions, elementInstruction);\n      }\n\n      if (elementInstruction && elementInstruction.skipContentProcessing) {\n        return node.nextSibling;\n      }\n\n      let currentChild = node.firstChild;\n      while (currentChild) {\n        currentChild = this._compileNode(currentChild, resources, instructions, node, injectorId || parentInjectorId, targetLightDOM);\n      }\n    }\n\n    return node.nextSibling;\n  }\n\n  _configureProperties(instruction, resources) {\n    let type = instruction.type;\n    let attrName = instruction.attrName;\n    let attributes = instruction.attributes;\n    let property;\n    let key;\n    let value;\n\n    let knownAttribute = resources.mapAttribute(attrName);\n    if (knownAttribute && attrName in attributes && knownAttribute !== attrName) {\n      attributes[knownAttribute] = attributes[attrName];\n      delete attributes[attrName];\n    }\n\n    for (key in attributes) {\n      value = attributes[key];\n\n      if (value !== null && typeof value === 'object') {\n        property = type.attributes[key];\n\n        if (property !== undefined) {\n          value.targetProperty = property.name;\n        } else {\n          value.targetProperty = key;\n        }\n      }\n    }\n  }\n}) || _class13);\n\nexport let ResourceModule = class ResourceModule {\n  constructor(moduleId) {\n    this.id = moduleId;\n    this.moduleInstance = null;\n    this.mainResource = null;\n    this.resources = null;\n    this.viewStrategy = null;\n    this.isInitialized = false;\n    this.onLoaded = null;\n    this.loadContext = null;\n  }\n\n  initialize(container) {\n    let current = this.mainResource;\n    let resources = this.resources;\n    let vs = this.viewStrategy;\n\n    if (this.isInitialized) {\n      return;\n    }\n\n    this.isInitialized = true;\n\n    if (current !== undefined) {\n      current.metadata.viewStrategy = vs;\n      current.initialize(container);\n    }\n\n    for (let i = 0, ii = resources.length; i < ii; ++i) {\n      current = resources[i];\n      current.metadata.viewStrategy = vs;\n      current.initialize(container);\n    }\n  }\n\n  register(registry, name) {\n    let main = this.mainResource;\n    let resources = this.resources;\n\n    if (main !== undefined) {\n      main.register(registry, name);\n      name = null;\n    }\n\n    for (let i = 0, ii = resources.length; i < ii; ++i) {\n      resources[i].register(registry, name);\n      name = null;\n    }\n  }\n\n  load(container, loadContext) {\n    if (this.onLoaded !== null) {\n      return this.loadContext === loadContext ? Promise.resolve() : this.onLoaded;\n    }\n\n    let main = this.mainResource;\n    let resources = this.resources;\n    let loads;\n\n    if (main !== undefined) {\n      loads = new Array(resources.length + 1);\n      loads[0] = main.load(container, loadContext);\n      for (let i = 0, ii = resources.length; i < ii; ++i) {\n        loads[i + 1] = resources[i].load(container, loadContext);\n      }\n    } else {\n      loads = new Array(resources.length);\n      for (let i = 0, ii = resources.length; i < ii; ++i) {\n        loads[i] = resources[i].load(container, loadContext);\n      }\n    }\n\n    this.loadContext = loadContext;\n    this.onLoaded = Promise.all(loads);\n    return this.onLoaded;\n  }\n};\n\nexport let ResourceDescription = class ResourceDescription {\n  constructor(key, exportedValue, resourceTypeMeta) {\n    if (!resourceTypeMeta) {\n      resourceTypeMeta = metadata.get(metadata.resource, exportedValue);\n\n      if (!resourceTypeMeta) {\n        resourceTypeMeta = new HtmlBehaviorResource();\n        resourceTypeMeta.elementName = _hyphenate(key);\n        metadata.define(metadata.resource, resourceTypeMeta, exportedValue);\n      }\n    }\n\n    if (resourceTypeMeta instanceof HtmlBehaviorResource) {\n      if (resourceTypeMeta.elementName === undefined) {\n        resourceTypeMeta.elementName = _hyphenate(key);\n      } else if (resourceTypeMeta.attributeName === undefined) {\n        resourceTypeMeta.attributeName = _hyphenate(key);\n      } else if (resourceTypeMeta.attributeName === null && resourceTypeMeta.elementName === null) {\n        HtmlBehaviorResource.convention(key, resourceTypeMeta);\n      }\n    } else if (!resourceTypeMeta.name) {\n      resourceTypeMeta.name = _hyphenate(key);\n    }\n\n    this.metadata = resourceTypeMeta;\n    this.value = exportedValue;\n  }\n\n  initialize(container) {\n    this.metadata.initialize(container, this.value);\n  }\n\n  register(registry, name) {\n    this.metadata.register(registry, name);\n  }\n\n  load(container, loadContext) {\n    return this.metadata.load(container, this.value, loadContext);\n  }\n};\n\nexport let ModuleAnalyzer = class ModuleAnalyzer {\n  constructor() {\n    this.cache = Object.create(null);\n  }\n\n  getAnalysis(moduleId) {\n    return this.cache[moduleId];\n  }\n\n  analyze(moduleId, moduleInstance, mainResourceKey) {\n    let mainResource;\n    let fallbackValue;\n    let fallbackKey;\n    let resourceTypeMeta;\n    let key;\n    let exportedValue;\n    let resources = [];\n    let conventional;\n    let vs;\n    let resourceModule;\n\n    resourceModule = this.cache[moduleId];\n    if (resourceModule) {\n      return resourceModule;\n    }\n\n    resourceModule = new ResourceModule(moduleId);\n    this.cache[moduleId] = resourceModule;\n\n    if (typeof moduleInstance === 'function') {\n      moduleInstance = { 'default': moduleInstance };\n    }\n\n    if (mainResourceKey) {\n      mainResource = new ResourceDescription(mainResourceKey, moduleInstance[mainResourceKey]);\n    }\n\n    for (key in moduleInstance) {\n      exportedValue = moduleInstance[key];\n\n      if (key === mainResourceKey || typeof exportedValue !== 'function') {\n        continue;\n      }\n\n      resourceTypeMeta = metadata.get(metadata.resource, exportedValue);\n\n      if (resourceTypeMeta) {\n        if (resourceTypeMeta.attributeName === null && resourceTypeMeta.elementName === null) {\n          HtmlBehaviorResource.convention(key, resourceTypeMeta);\n        }\n\n        if (resourceTypeMeta.attributeName === null && resourceTypeMeta.elementName === null) {\n          resourceTypeMeta.elementName = _hyphenate(key);\n        }\n\n        if (!mainResource && resourceTypeMeta instanceof HtmlBehaviorResource && resourceTypeMeta.elementName !== null) {\n          mainResource = new ResourceDescription(key, exportedValue, resourceTypeMeta);\n        } else {\n          resources.push(new ResourceDescription(key, exportedValue, resourceTypeMeta));\n        }\n      } else if (viewStrategy.decorates(exportedValue)) {\n        vs = exportedValue;\n      } else if (exportedValue instanceof TemplateRegistryEntry) {\n        vs = new TemplateRegistryViewStrategy(moduleId, exportedValue);\n      } else {\n        if (conventional = HtmlBehaviorResource.convention(key)) {\n          if (conventional.elementName !== null && !mainResource) {\n            mainResource = new ResourceDescription(key, exportedValue, conventional);\n          } else {\n            resources.push(new ResourceDescription(key, exportedValue, conventional));\n          }\n\n          metadata.define(metadata.resource, conventional, exportedValue);\n        } else if (conventional = ValueConverterResource.convention(key) || BindingBehaviorResource.convention(key) || ViewEngineHooksResource.convention(key)) {\n          resources.push(new ResourceDescription(key, exportedValue, conventional));\n          metadata.define(metadata.resource, conventional, exportedValue);\n        } else if (!fallbackValue) {\n          fallbackValue = exportedValue;\n          fallbackKey = key;\n        }\n      }\n    }\n\n    if (!mainResource && fallbackValue) {\n      mainResource = new ResourceDescription(fallbackKey, fallbackValue);\n    }\n\n    resourceModule.moduleInstance = moduleInstance;\n    resourceModule.mainResource = mainResource;\n    resourceModule.resources = resources;\n    resourceModule.viewStrategy = vs;\n\n    return resourceModule;\n  }\n};\n\nlet logger = LogManager.getLogger('templating');\n\nfunction ensureRegistryEntry(loader, urlOrRegistryEntry) {\n  if (urlOrRegistryEntry instanceof TemplateRegistryEntry) {\n    return Promise.resolve(urlOrRegistryEntry);\n  }\n\n  return loader.loadTemplate(urlOrRegistryEntry);\n}\n\nlet ProxyViewFactory = class ProxyViewFactory {\n  constructor(promise) {\n    promise.then(x => this.viewFactory = x);\n  }\n\n  create(container, bindingContext, createInstruction, element) {\n    return this.viewFactory.create(container, bindingContext, createInstruction, element);\n  }\n\n  get isCaching() {\n    return this.viewFactory.isCaching;\n  }\n\n  setCacheSize(size, doNotOverrideIfAlreadySet) {\n    this.viewFactory.setCacheSize(size, doNotOverrideIfAlreadySet);\n  }\n\n  getCachedView() {\n    return this.viewFactory.getCachedView();\n  }\n\n  returnViewToCache(view) {\n    this.viewFactory.returnViewToCache(view);\n  }\n};\n\nexport let ViewEngine = (_dec8 = inject(Loader, Container, ViewCompiler, ModuleAnalyzer, ViewResources), _dec8(_class14 = (_temp4 = _class15 = class ViewEngine {\n  constructor(loader, container, viewCompiler, moduleAnalyzer, appResources) {\n    this.loader = loader;\n    this.container = container;\n    this.viewCompiler = viewCompiler;\n    this.moduleAnalyzer = moduleAnalyzer;\n    this.appResources = appResources;\n    this._pluginMap = {};\n\n    let auSlotBehavior = new HtmlBehaviorResource();\n    auSlotBehavior.attributeName = 'au-slot';\n    auSlotBehavior.initialize(container, SlotCustomAttribute);\n    auSlotBehavior.register(appResources);\n  }\n\n  addResourcePlugin(extension, implementation) {\n    let name = extension.replace('.', '') + '-resource-plugin';\n    this._pluginMap[extension] = name;\n    this.loader.addPlugin(name, implementation);\n  }\n\n  loadViewFactory(urlOrRegistryEntry, compileInstruction, loadContext, target) {\n    loadContext = loadContext || new ResourceLoadContext();\n\n    return ensureRegistryEntry(this.loader, urlOrRegistryEntry).then(registryEntry => {\n      if (registryEntry.onReady) {\n        if (!loadContext.hasDependency(urlOrRegistryEntry)) {\n          loadContext.addDependency(urlOrRegistryEntry);\n          return registryEntry.onReady;\n        }\n\n        if (registryEntry.template === null) {\n          return registryEntry.onReady;\n        }\n\n        return Promise.resolve(new ProxyViewFactory(registryEntry.onReady));\n      }\n\n      loadContext.addDependency(urlOrRegistryEntry);\n\n      registryEntry.onReady = this.loadTemplateResources(registryEntry, compileInstruction, loadContext, target).then(resources => {\n        registryEntry.resources = resources;\n\n        if (registryEntry.template === null) {\n          return registryEntry.factory = null;\n        }\n\n        let viewFactory = this.viewCompiler.compile(registryEntry.template, resources, compileInstruction);\n        return registryEntry.factory = viewFactory;\n      });\n\n      return registryEntry.onReady;\n    });\n  }\n\n  loadTemplateResources(registryEntry, compileInstruction, loadContext, target) {\n    let resources = new ViewResources(this.appResources, registryEntry.address);\n    let dependencies = registryEntry.dependencies;\n    let importIds;\n    let names;\n\n    compileInstruction = compileInstruction || ViewCompileInstruction.normal;\n\n    if (dependencies.length === 0 && !compileInstruction.associatedModuleId) {\n      return Promise.resolve(resources);\n    }\n\n    importIds = dependencies.map(x => x.src);\n    names = dependencies.map(x => x.name);\n    logger.debug(`importing resources for ${ registryEntry.address }`, importIds);\n\n    if (target) {\n      let viewModelRequires = metadata.get(ViewEngine.viewModelRequireMetadataKey, target);\n      if (viewModelRequires) {\n        let templateImportCount = importIds.length;\n        for (let i = 0, ii = viewModelRequires.length; i < ii; ++i) {\n          let req = viewModelRequires[i];\n          let importId = typeof req === 'function' ? Origin.get(req).moduleId : relativeToFile(req.src || req, registryEntry.address);\n\n          if (importIds.indexOf(importId) === -1) {\n            importIds.push(importId);\n            names.push(req.as);\n          }\n        }\n        logger.debug(`importing ViewModel resources for ${ compileInstruction.associatedModuleId }`, importIds.slice(templateImportCount));\n      }\n    }\n\n    return this.importViewResources(importIds, names, resources, compileInstruction, loadContext);\n  }\n\n  importViewModelResource(moduleImport, moduleMember) {\n    return this.loader.loadModule(moduleImport).then(viewModelModule => {\n      let normalizedId = Origin.get(viewModelModule).moduleId;\n      let resourceModule = this.moduleAnalyzer.analyze(normalizedId, viewModelModule, moduleMember);\n\n      if (!resourceModule.mainResource) {\n        throw new Error(`No view model found in module \"${ moduleImport }\".`);\n      }\n\n      resourceModule.initialize(this.container);\n\n      return resourceModule.mainResource;\n    });\n  }\n\n  importViewResources(moduleIds, names, resources, compileInstruction, loadContext) {\n    loadContext = loadContext || new ResourceLoadContext();\n    compileInstruction = compileInstruction || ViewCompileInstruction.normal;\n\n    moduleIds = moduleIds.map(x => this._applyLoaderPlugin(x));\n\n    return this.loader.loadAllModules(moduleIds).then(imports => {\n      let i;\n      let ii;\n      let analysis;\n      let normalizedId;\n      let current;\n      let associatedModule;\n      let container = this.container;\n      let moduleAnalyzer = this.moduleAnalyzer;\n      let allAnalysis = new Array(imports.length);\n\n      for (i = 0, ii = imports.length; i < ii; ++i) {\n        current = imports[i];\n        normalizedId = Origin.get(current).moduleId;\n\n        analysis = moduleAnalyzer.analyze(normalizedId, current);\n        analysis.initialize(container);\n        analysis.register(resources, names[i]);\n\n        allAnalysis[i] = analysis;\n      }\n\n      if (compileInstruction.associatedModuleId) {\n        associatedModule = moduleAnalyzer.getAnalysis(compileInstruction.associatedModuleId);\n\n        if (associatedModule) {\n          associatedModule.register(resources);\n        }\n      }\n\n      for (i = 0, ii = allAnalysis.length; i < ii; ++i) {\n        allAnalysis[i] = allAnalysis[i].load(container, loadContext);\n      }\n\n      return Promise.all(allAnalysis).then(() => resources);\n    });\n  }\n\n  _applyLoaderPlugin(id) {\n    let index = id.lastIndexOf('.');\n    if (index !== -1) {\n      let ext = id.substring(index);\n      let pluginName = this._pluginMap[ext];\n\n      if (pluginName === undefined) {\n        return id;\n      }\n\n      return this.loader.applyPluginToUrl(id, pluginName);\n    }\n\n    return id;\n  }\n}, _class15.viewModelRequireMetadataKey = 'aurelia:view-model-require', _temp4)) || _class14);\n\nexport let Controller = class Controller {\n  constructor(behavior, instruction, viewModel, container) {\n    this.behavior = behavior;\n    this.instruction = instruction;\n    this.viewModel = viewModel;\n    this.isAttached = false;\n    this.view = null;\n    this.isBound = false;\n    this.scope = null;\n    this.container = container;\n    this.elementEvents = container.elementEvents || null;\n\n    let observerLookup = behavior.observerLocator.getOrCreateObserversLookup(viewModel);\n    let handlesBind = behavior.handlesBind;\n    let attributes = instruction.attributes;\n    let boundProperties = this.boundProperties = [];\n    let properties = behavior.properties;\n    let i;\n    let ii;\n\n    behavior._ensurePropertiesDefined(viewModel, observerLookup);\n\n    for (i = 0, ii = properties.length; i < ii; ++i) {\n      properties[i]._initialize(viewModel, observerLookup, attributes, handlesBind, boundProperties);\n    }\n  }\n\n  created(owningView) {\n    if (this.behavior.handlesCreated) {\n      this.viewModel.created(owningView, this.view);\n    }\n  }\n\n  automate(overrideContext, owningView) {\n    this.view.bindingContext = this.viewModel;\n    this.view.overrideContext = overrideContext || createOverrideContext(this.viewModel);\n    this.view._isUserControlled = true;\n\n    if (this.behavior.handlesCreated) {\n      this.viewModel.created(owningView || null, this.view);\n    }\n\n    this.bind(this.view);\n  }\n\n  bind(scope) {\n    let skipSelfSubscriber = this.behavior.handlesBind;\n    let boundProperties = this.boundProperties;\n    let i;\n    let ii;\n    let x;\n    let observer;\n    let selfSubscriber;\n\n    if (this.isBound) {\n      if (this.scope === scope) {\n        return;\n      }\n\n      this.unbind();\n    }\n\n    this.isBound = true;\n    this.scope = scope;\n\n    for (i = 0, ii = boundProperties.length; i < ii; ++i) {\n      x = boundProperties[i];\n      observer = x.observer;\n      selfSubscriber = observer.selfSubscriber;\n      observer.publishing = false;\n\n      if (skipSelfSubscriber) {\n        observer.selfSubscriber = null;\n      }\n\n      x.binding.bind(scope);\n      observer.call();\n\n      observer.publishing = true;\n      observer.selfSubscriber = selfSubscriber;\n    }\n\n    let overrideContext;\n    if (this.view !== null) {\n      if (skipSelfSubscriber) {\n        this.view.viewModelScope = scope;\n      }\n\n      if (this.viewModel === scope.overrideContext.bindingContext) {\n        overrideContext = scope.overrideContext;\n      } else if (this.instruction.inheritBindingContext) {\n        overrideContext = createOverrideContext(this.viewModel, scope.overrideContext);\n      } else {\n        overrideContext = createOverrideContext(this.viewModel);\n        overrideContext.__parentOverrideContext = scope.overrideContext;\n      }\n\n      this.view.bind(this.viewModel, overrideContext);\n    } else if (skipSelfSubscriber) {\n      overrideContext = scope.overrideContext;\n\n      if (scope.overrideContext.__parentOverrideContext !== undefined && this.viewModel.viewFactory && this.viewModel.viewFactory.factoryCreateInstruction.partReplacements) {\n        overrideContext = Object.assign({}, scope.overrideContext);\n        overrideContext.parentOverrideContext = scope.overrideContext.__parentOverrideContext;\n      }\n      this.viewModel.bind(scope.bindingContext, overrideContext);\n    }\n  }\n\n  unbind() {\n    if (this.isBound) {\n      let boundProperties = this.boundProperties;\n      let i;\n      let ii;\n\n      this.isBound = false;\n      this.scope = null;\n\n      if (this.view !== null) {\n        this.view.unbind();\n      }\n\n      if (this.behavior.handlesUnbind) {\n        this.viewModel.unbind();\n      }\n\n      if (this.elementEvents !== null) {\n        this.elementEvents.disposeAll();\n      }\n\n      for (i = 0, ii = boundProperties.length; i < ii; ++i) {\n        boundProperties[i].binding.unbind();\n      }\n    }\n  }\n\n  attached() {\n    if (this.isAttached) {\n      return;\n    }\n\n    this.isAttached = true;\n\n    if (this.behavior.handlesAttached) {\n      this.viewModel.attached();\n    }\n\n    if (this.view !== null) {\n      this.view.attached();\n    }\n  }\n\n  detached() {\n    if (this.isAttached) {\n      this.isAttached = false;\n\n      if (this.view !== null) {\n        this.view.detached();\n      }\n\n      if (this.behavior.handlesDetached) {\n        this.viewModel.detached();\n      }\n    }\n  }\n};\n\nexport let BehaviorPropertyObserver = (_dec9 = subscriberCollection(), _dec9(_class16 = class BehaviorPropertyObserver {\n  constructor(taskQueue, obj, propertyName, selfSubscriber, initialValue) {\n    this.taskQueue = taskQueue;\n    this.obj = obj;\n    this.propertyName = propertyName;\n    this.notqueued = true;\n    this.publishing = false;\n    this.selfSubscriber = selfSubscriber;\n    this.currentValue = this.oldValue = initialValue;\n  }\n\n  getValue() {\n    return this.currentValue;\n  }\n\n  setValue(newValue) {\n    let oldValue = this.currentValue;\n\n    if (oldValue !== newValue) {\n      this.oldValue = oldValue;\n      this.currentValue = newValue;\n\n      if (this.publishing && this.notqueued) {\n        if (this.taskQueue.flushing) {\n          this.call();\n        } else {\n          this.notqueued = false;\n          this.taskQueue.queueMicroTask(this);\n        }\n      }\n    }\n  }\n\n  call() {\n    let oldValue = this.oldValue;\n    let newValue = this.currentValue;\n\n    this.notqueued = true;\n\n    if (newValue === oldValue) {\n      return;\n    }\n\n    if (this.selfSubscriber) {\n      this.selfSubscriber(newValue, oldValue);\n    }\n\n    this.callSubscribers(newValue, oldValue);\n    this.oldValue = newValue;\n  }\n\n  subscribe(context, callable) {\n    this.addSubscriber(context, callable);\n  }\n\n  unsubscribe(context, callable) {\n    this.removeSubscriber(context, callable);\n  }\n}) || _class16);\n\nfunction getObserver(behavior, instance, name) {\n  let lookup = instance.__observers__;\n\n  if (lookup === undefined) {\n    if (!behavior.isInitialized) {\n      behavior.initialize(Container.instance || new Container(), instance.constructor);\n    }\n\n    lookup = behavior.observerLocator.getOrCreateObserversLookup(instance);\n    behavior._ensurePropertiesDefined(instance, lookup);\n  }\n\n  return lookup[name];\n}\n\nexport let BindableProperty = class BindableProperty {\n  constructor(nameOrConfig) {\n    if (typeof nameOrConfig === 'string') {\n      this.name = nameOrConfig;\n    } else {\n      Object.assign(this, nameOrConfig);\n    }\n\n    this.attribute = this.attribute || _hyphenate(this.name);\n    if (this.defaultBindingMode === null || this.defaultBindingMode === undefined) {\n      this.defaultBindingMode = bindingMode.oneWay;\n    }\n    this.changeHandler = this.changeHandler || null;\n    this.owner = null;\n    this.descriptor = null;\n  }\n\n  registerWith(target, behavior, descriptor) {\n    behavior.properties.push(this);\n    behavior.attributes[this.attribute] = this;\n    this.owner = behavior;\n\n    if (descriptor) {\n      this.descriptor = descriptor;\n      return this._configureDescriptor(behavior, descriptor);\n    }\n\n    return undefined;\n  }\n\n  _configureDescriptor(behavior, descriptor) {\n    let name = this.name;\n\n    descriptor.configurable = true;\n    descriptor.enumerable = true;\n\n    if ('initializer' in descriptor) {\n      this.defaultValue = descriptor.initializer;\n      delete descriptor.initializer;\n      delete descriptor.writable;\n    }\n\n    if ('value' in descriptor) {\n      this.defaultValue = descriptor.value;\n      delete descriptor.value;\n      delete descriptor.writable;\n    }\n\n    descriptor.get = function () {\n      return getObserver(behavior, this, name).getValue();\n    };\n\n    descriptor.set = function (value) {\n      getObserver(behavior, this, name).setValue(value);\n    };\n\n    descriptor.get.getObserver = function (obj) {\n      return getObserver(behavior, obj, name);\n    };\n\n    return descriptor;\n  }\n\n  defineOn(target, behavior) {\n    let name = this.name;\n    let handlerName;\n\n    if (this.changeHandler === null) {\n      handlerName = name + 'Changed';\n      if (handlerName in target.prototype) {\n        this.changeHandler = handlerName;\n      }\n    }\n\n    if (this.descriptor === null) {\n      Object.defineProperty(target.prototype, name, this._configureDescriptor(behavior, {}));\n    }\n  }\n\n  createObserver(viewModel) {\n    let selfSubscriber = null;\n    let defaultValue = this.defaultValue;\n    let changeHandlerName = this.changeHandler;\n    let name = this.name;\n    let initialValue;\n\n    if (this.hasOptions) {\n      return undefined;\n    }\n\n    if (changeHandlerName in viewModel) {\n      if ('propertyChanged' in viewModel) {\n        selfSubscriber = (newValue, oldValue) => {\n          viewModel[changeHandlerName](newValue, oldValue);\n          viewModel.propertyChanged(name, newValue, oldValue);\n        };\n      } else {\n        selfSubscriber = (newValue, oldValue) => viewModel[changeHandlerName](newValue, oldValue);\n      }\n    } else if ('propertyChanged' in viewModel) {\n      selfSubscriber = (newValue, oldValue) => viewModel.propertyChanged(name, newValue, oldValue);\n    } else if (changeHandlerName !== null) {\n      throw new Error(`Change handler ${ changeHandlerName } was specified but not declared on the class.`);\n    }\n\n    if (defaultValue !== undefined) {\n      initialValue = typeof defaultValue === 'function' ? defaultValue.call(viewModel) : defaultValue;\n    }\n\n    return new BehaviorPropertyObserver(this.owner.taskQueue, viewModel, this.name, selfSubscriber, initialValue);\n  }\n\n  _initialize(viewModel, observerLookup, attributes, behaviorHandlesBind, boundProperties) {\n    let selfSubscriber;\n    let observer;\n    let attribute;\n    let defaultValue = this.defaultValue;\n\n    if (this.isDynamic) {\n      for (let key in attributes) {\n        this._createDynamicProperty(viewModel, observerLookup, behaviorHandlesBind, key, attributes[key], boundProperties);\n      }\n    } else if (!this.hasOptions) {\n      observer = observerLookup[this.name];\n\n      if (attributes !== null) {\n        selfSubscriber = observer.selfSubscriber;\n        attribute = attributes[this.attribute];\n\n        if (behaviorHandlesBind) {\n          observer.selfSubscriber = null;\n        }\n\n        if (typeof attribute === 'string') {\n          viewModel[this.name] = attribute;\n          observer.call();\n        } else if (attribute) {\n          boundProperties.push({ observer: observer, binding: attribute.createBinding(viewModel) });\n        } else if (defaultValue !== undefined) {\n          observer.call();\n        }\n\n        observer.selfSubscriber = selfSubscriber;\n      }\n\n      observer.publishing = true;\n    }\n  }\n\n  _createDynamicProperty(viewModel, observerLookup, behaviorHandlesBind, name, attribute, boundProperties) {\n    let changeHandlerName = name + 'Changed';\n    let selfSubscriber = null;\n    let observer;\n    let info;\n\n    if (changeHandlerName in viewModel) {\n      if ('propertyChanged' in viewModel) {\n        selfSubscriber = (newValue, oldValue) => {\n          viewModel[changeHandlerName](newValue, oldValue);\n          viewModel.propertyChanged(name, newValue, oldValue);\n        };\n      } else {\n        selfSubscriber = (newValue, oldValue) => viewModel[changeHandlerName](newValue, oldValue);\n      }\n    } else if ('propertyChanged' in viewModel) {\n      selfSubscriber = (newValue, oldValue) => viewModel.propertyChanged(name, newValue, oldValue);\n    }\n\n    observer = observerLookup[name] = new BehaviorPropertyObserver(this.owner.taskQueue, viewModel, name, selfSubscriber);\n\n    Object.defineProperty(viewModel, name, {\n      configurable: true,\n      enumerable: true,\n      get: observer.getValue.bind(observer),\n      set: observer.setValue.bind(observer)\n    });\n\n    if (behaviorHandlesBind) {\n      observer.selfSubscriber = null;\n    }\n\n    if (typeof attribute === 'string') {\n      viewModel[name] = attribute;\n      observer.call();\n    } else if (attribute) {\n      info = { observer: observer, binding: attribute.createBinding(viewModel) };\n      boundProperties.push(info);\n    }\n\n    observer.publishing = true;\n    observer.selfSubscriber = selfSubscriber;\n  }\n};\n\nlet lastProviderId = 0;\n\nfunction nextProviderId() {\n  return ++lastProviderId;\n}\n\nfunction doProcessContent() {\n  return true;\n}\nfunction doProcessAttributes() {}\n\nexport let HtmlBehaviorResource = class HtmlBehaviorResource {\n  constructor() {\n    this.elementName = null;\n    this.attributeName = null;\n    this.attributeDefaultBindingMode = undefined;\n    this.liftsContent = false;\n    this.targetShadowDOM = false;\n    this.shadowDOMOptions = null;\n    this.processAttributes = doProcessAttributes;\n    this.processContent = doProcessContent;\n    this.usesShadowDOM = false;\n    this.childBindings = null;\n    this.hasDynamicOptions = false;\n    this.containerless = false;\n    this.properties = [];\n    this.attributes = {};\n    this.isInitialized = false;\n    this.primaryProperty = null;\n  }\n\n  static convention(name, existing) {\n    let behavior;\n\n    if (name.endsWith('CustomAttribute')) {\n      behavior = existing || new HtmlBehaviorResource();\n      behavior.attributeName = _hyphenate(name.substring(0, name.length - 15));\n    }\n\n    if (name.endsWith('CustomElement')) {\n      behavior = existing || new HtmlBehaviorResource();\n      behavior.elementName = _hyphenate(name.substring(0, name.length - 13));\n    }\n\n    return behavior;\n  }\n\n  addChildBinding(behavior) {\n    if (this.childBindings === null) {\n      this.childBindings = [];\n    }\n\n    this.childBindings.push(behavior);\n  }\n\n  initialize(container, target) {\n    let proto = target.prototype;\n    let properties = this.properties;\n    let attributeName = this.attributeName;\n    let attributeDefaultBindingMode = this.attributeDefaultBindingMode;\n    let i;\n    let ii;\n    let current;\n\n    if (this.isInitialized) {\n      return;\n    }\n\n    this.isInitialized = true;\n    target.__providerId__ = nextProviderId();\n\n    this.observerLocator = container.get(ObserverLocator);\n    this.taskQueue = container.get(TaskQueue);\n\n    this.target = target;\n    this.usesShadowDOM = this.targetShadowDOM && FEATURE.shadowDOM;\n    this.handlesCreated = 'created' in proto;\n    this.handlesBind = 'bind' in proto;\n    this.handlesUnbind = 'unbind' in proto;\n    this.handlesAttached = 'attached' in proto;\n    this.handlesDetached = 'detached' in proto;\n    this.htmlName = this.elementName || this.attributeName;\n\n    if (attributeName !== null) {\n      if (properties.length === 0) {\n        new BindableProperty({\n          name: 'value',\n          changeHandler: 'valueChanged' in proto ? 'valueChanged' : null,\n          attribute: attributeName,\n          defaultBindingMode: attributeDefaultBindingMode\n        }).registerWith(target, this);\n      }\n\n      current = properties[0];\n\n      if (properties.length === 1 && current.name === 'value') {\n        current.isDynamic = current.hasOptions = this.hasDynamicOptions;\n        current.defineOn(target, this);\n      } else {\n        for (i = 0, ii = properties.length; i < ii; ++i) {\n          properties[i].defineOn(target, this);\n          if (properties[i].primaryProperty) {\n            if (this.primaryProperty) {\n              throw new Error('Only one bindable property on a custom element can be defined as the default');\n            }\n            this.primaryProperty = properties[i];\n          }\n        }\n\n        current = new BindableProperty({\n          name: 'value',\n          changeHandler: 'valueChanged' in proto ? 'valueChanged' : null,\n          attribute: attributeName,\n          defaultBindingMode: attributeDefaultBindingMode\n        });\n\n        current.hasOptions = true;\n        current.registerWith(target, this);\n      }\n    } else {\n      for (i = 0, ii = properties.length; i < ii; ++i) {\n        properties[i].defineOn(target, this);\n      }\n    }\n  }\n\n  register(registry, name) {\n    if (this.attributeName !== null) {\n      registry.registerAttribute(name || this.attributeName, this, this.attributeName);\n\n      if (Array.isArray(this.aliases)) {\n        this.aliases.forEach(alias => {\n          registry.registerAttribute(alias, this, this.attributeName);\n        });\n      }\n    }\n\n    if (this.elementName !== null) {\n      registry.registerElement(name || this.elementName, this);\n    }\n  }\n\n  load(container, target, loadContext, viewStrategy, transientView) {\n    let options;\n\n    if (this.elementName !== null) {\n      viewStrategy = container.get(ViewLocator).getViewStrategy(viewStrategy || this.viewStrategy || target);\n      options = new ViewCompileInstruction(this.targetShadowDOM, true);\n\n      if (!viewStrategy.moduleId) {\n        viewStrategy.moduleId = Origin.get(target).moduleId;\n      }\n\n      return viewStrategy.loadViewFactory(container.get(ViewEngine), options, loadContext, target).then(viewFactory => {\n        if (!transientView || !this.viewFactory) {\n          this.viewFactory = viewFactory;\n        }\n\n        return viewFactory;\n      });\n    }\n\n    return Promise.resolve(this);\n  }\n\n  compile(compiler, resources, node, instruction, parentNode) {\n    if (this.liftsContent) {\n      if (!instruction.viewFactory) {\n        let template = DOM.createElement('template');\n        let fragment = DOM.createDocumentFragment();\n        let cacheSize = node.getAttribute('view-cache');\n        let part = node.getAttribute('part');\n\n        node.removeAttribute(instruction.originalAttrName);\n        DOM.replaceNode(template, node, parentNode);\n        fragment.appendChild(node);\n        instruction.viewFactory = compiler.compile(fragment, resources);\n\n        if (part) {\n          instruction.viewFactory.part = part;\n          node.removeAttribute('part');\n        }\n\n        if (cacheSize) {\n          instruction.viewFactory.setCacheSize(cacheSize);\n          node.removeAttribute('view-cache');\n        }\n\n        node = template;\n      }\n    } else if (this.elementName !== null) {\n      let partReplacements = {};\n\n      if (this.processContent(compiler, resources, node, instruction) && node.hasChildNodes()) {\n        let currentChild = node.firstChild;\n        let contentElement = this.usesShadowDOM ? null : DOM.createElement('au-content');\n        let nextSibling;\n        let toReplace;\n\n        while (currentChild) {\n          nextSibling = currentChild.nextSibling;\n\n          if (currentChild.tagName === 'TEMPLATE' && (toReplace = currentChild.getAttribute('replace-part'))) {\n            partReplacements[toReplace] = compiler.compile(currentChild, resources);\n            DOM.removeNode(currentChild, parentNode);\n            instruction.partReplacements = partReplacements;\n          } else if (contentElement !== null) {\n            if (currentChild.nodeType === 3 && _isAllWhitespace(currentChild)) {\n              DOM.removeNode(currentChild, parentNode);\n            } else {\n              contentElement.appendChild(currentChild);\n            }\n          }\n\n          currentChild = nextSibling;\n        }\n\n        if (contentElement !== null && contentElement.hasChildNodes()) {\n          node.appendChild(contentElement);\n        }\n\n        instruction.skipContentProcessing = false;\n      } else {\n        instruction.skipContentProcessing = true;\n      }\n    }\n\n    return node;\n  }\n\n  create(container, instruction, element, bindings) {\n    let viewHost;\n    let au = null;\n\n    instruction = instruction || BehaviorInstruction.normal;\n    element = element || null;\n    bindings = bindings || null;\n\n    if (this.elementName !== null && element) {\n      if (this.usesShadowDOM) {\n        viewHost = element.attachShadow(this.shadowDOMOptions);\n        container.registerInstance(DOM.boundary, viewHost);\n      } else {\n        viewHost = element;\n        if (this.targetShadowDOM) {\n          container.registerInstance(DOM.boundary, viewHost);\n        }\n      }\n    }\n\n    if (element !== null) {\n      element.au = au = element.au || {};\n    }\n\n    let viewModel = instruction.viewModel || container.get(this.target);\n    let controller = new Controller(this, instruction, viewModel, container);\n    let childBindings = this.childBindings;\n    let viewFactory;\n\n    if (this.liftsContent) {\n      au.controller = controller;\n    } else if (this.elementName !== null) {\n      viewFactory = instruction.viewFactory || this.viewFactory;\n      container.viewModel = viewModel;\n\n      if (viewFactory) {\n        controller.view = viewFactory.create(container, instruction, element);\n      }\n\n      if (element !== null) {\n        au.controller = controller;\n\n        if (controller.view) {\n          if (!this.usesShadowDOM && (element.childNodes.length === 1 || element.contentElement)) {\n            let contentElement = element.childNodes[0] || element.contentElement;\n            controller.view.contentView = { fragment: contentElement };\n            contentElement.parentNode && DOM.removeNode(contentElement);\n          }\n\n          if (instruction.anchorIsContainer) {\n            if (childBindings !== null) {\n              for (let i = 0, ii = childBindings.length; i < ii; ++i) {\n                controller.view.addBinding(childBindings[i].create(element, viewModel, controller));\n              }\n            }\n\n            controller.view.appendNodesTo(viewHost);\n          } else {\n            controller.view.insertNodesBefore(viewHost);\n          }\n        } else if (childBindings !== null) {\n          for (let i = 0, ii = childBindings.length; i < ii; ++i) {\n            bindings.push(childBindings[i].create(element, viewModel, controller));\n          }\n        }\n      } else if (controller.view) {\n        controller.view.controller = controller;\n\n        if (childBindings !== null) {\n          for (let i = 0, ii = childBindings.length; i < ii; ++i) {\n            controller.view.addBinding(childBindings[i].create(instruction.host, viewModel, controller));\n          }\n        }\n      } else if (childBindings !== null) {\n        for (let i = 0, ii = childBindings.length; i < ii; ++i) {\n          bindings.push(childBindings[i].create(instruction.host, viewModel, controller));\n        }\n      }\n    } else if (childBindings !== null) {\n      for (let i = 0, ii = childBindings.length; i < ii; ++i) {\n        bindings.push(childBindings[i].create(element, viewModel, controller));\n      }\n    }\n\n    if (au !== null) {\n      au[this.htmlName] = controller;\n    }\n\n    if (instruction.initiatedByBehavior && viewFactory) {\n      controller.view.created();\n    }\n\n    return controller;\n  }\n\n  _ensurePropertiesDefined(instance, lookup) {\n    let properties;\n    let i;\n    let ii;\n    let observer;\n\n    if ('__propertiesDefined__' in lookup) {\n      return;\n    }\n\n    lookup.__propertiesDefined__ = true;\n    properties = this.properties;\n\n    for (i = 0, ii = properties.length; i < ii; ++i) {\n      observer = properties[i].createObserver(instance);\n\n      if (observer !== undefined) {\n        lookup[observer.propertyName] = observer;\n      }\n    }\n  }\n};\n\nfunction createChildObserverDecorator(selectorOrConfig, all) {\n  return function (target, key, descriptor) {\n    let actualTarget = typeof key === 'string' ? target.constructor : target;\n    let r = metadata.getOrCreateOwn(metadata.resource, HtmlBehaviorResource, actualTarget);\n\n    if (typeof selectorOrConfig === 'string') {\n      selectorOrConfig = {\n        selector: selectorOrConfig,\n        name: key\n      };\n    }\n\n    if (descriptor) {\n      descriptor.writable = true;\n      descriptor.configurable = true;\n    }\n\n    selectorOrConfig.all = all;\n    r.addChildBinding(new ChildObserver(selectorOrConfig));\n  };\n}\n\nexport function children(selectorOrConfig) {\n  return createChildObserverDecorator(selectorOrConfig, true);\n}\n\nexport function child(selectorOrConfig) {\n  return createChildObserverDecorator(selectorOrConfig, false);\n}\n\nlet ChildObserver = class ChildObserver {\n  constructor(config) {\n    this.name = config.name;\n    this.changeHandler = config.changeHandler || this.name + 'Changed';\n    this.selector = config.selector;\n    this.all = config.all;\n  }\n\n  create(viewHost, viewModel, controller) {\n    return new ChildObserverBinder(this.selector, viewHost, this.name, viewModel, controller, this.changeHandler, this.all);\n  }\n};\n\n\nconst noMutations = [];\n\nfunction trackMutation(groupedMutations, binder, record) {\n  let mutations = groupedMutations.get(binder);\n\n  if (!mutations) {\n    mutations = [];\n    groupedMutations.set(binder, mutations);\n  }\n\n  mutations.push(record);\n}\n\nfunction onChildChange(mutations, observer) {\n  let binders = observer.binders;\n  let bindersLength = binders.length;\n  let groupedMutations = new Map();\n\n  for (let i = 0, ii = mutations.length; i < ii; ++i) {\n    let record = mutations[i];\n    let added = record.addedNodes;\n    let removed = record.removedNodes;\n\n    for (let j = 0, jj = removed.length; j < jj; ++j) {\n      let node = removed[j];\n      if (node.nodeType === 1) {\n        for (let k = 0; k < bindersLength; ++k) {\n          let binder = binders[k];\n          if (binder.onRemove(node)) {\n            trackMutation(groupedMutations, binder, record);\n          }\n        }\n      }\n    }\n\n    for (let j = 0, jj = added.length; j < jj; ++j) {\n      let node = added[j];\n      if (node.nodeType === 1) {\n        for (let k = 0; k < bindersLength; ++k) {\n          let binder = binders[k];\n          if (binder.onAdd(node)) {\n            trackMutation(groupedMutations, binder, record);\n          }\n        }\n      }\n    }\n  }\n\n  groupedMutations.forEach((value, key) => {\n    if (key.changeHandler !== null) {\n      key.viewModel[key.changeHandler](value);\n    }\n  });\n}\n\nlet ChildObserverBinder = class ChildObserverBinder {\n  constructor(selector, viewHost, property, viewModel, controller, changeHandler, all) {\n    this.selector = selector;\n    this.viewHost = viewHost;\n    this.property = property;\n    this.viewModel = viewModel;\n    this.controller = controller;\n    this.changeHandler = changeHandler in viewModel ? changeHandler : null;\n    this.usesShadowDOM = controller.behavior.usesShadowDOM;\n    this.all = all;\n\n    if (!this.usesShadowDOM && controller.view && controller.view.contentView) {\n      this.contentView = controller.view.contentView;\n    } else {\n      this.contentView = null;\n    }\n  }\n\n  matches(element) {\n    if (element.matches(this.selector)) {\n      if (this.contentView === null) {\n        return true;\n      }\n\n      let contentView = this.contentView;\n      let assignedSlot = element.auAssignedSlot;\n\n      if (assignedSlot && assignedSlot.projectFromAnchors) {\n        let anchors = assignedSlot.projectFromAnchors;\n\n        for (let i = 0, ii = anchors.length; i < ii; ++i) {\n          if (anchors[i].auOwnerView === contentView) {\n            return true;\n          }\n        }\n\n        return false;\n      }\n\n      return element.auOwnerView === contentView;\n    }\n\n    return false;\n  }\n\n  bind(source) {\n    let viewHost = this.viewHost;\n    let viewModel = this.viewModel;\n    let observer = viewHost.__childObserver__;\n\n    if (!observer) {\n      observer = viewHost.__childObserver__ = DOM.createMutationObserver(onChildChange);\n\n      let options = {\n        childList: true,\n        subtree: !this.usesShadowDOM\n      };\n\n      observer.observe(viewHost, options);\n      observer.binders = [];\n    }\n\n    observer.binders.push(this);\n\n    if (this.usesShadowDOM) {\n      let current = viewHost.firstElementChild;\n\n      if (this.all) {\n        let items = viewModel[this.property];\n        if (!items) {\n          items = viewModel[this.property] = [];\n        } else {\n          items.length = 0;\n        }\n\n        while (current) {\n          if (this.matches(current)) {\n            items.push(current.au && current.au.controller ? current.au.controller.viewModel : current);\n          }\n\n          current = current.nextElementSibling;\n        }\n\n        if (this.changeHandler !== null) {\n          this.viewModel[this.changeHandler](noMutations);\n        }\n      } else {\n        while (current) {\n          if (this.matches(current)) {\n            let value = current.au && current.au.controller ? current.au.controller.viewModel : current;\n            this.viewModel[this.property] = value;\n\n            if (this.changeHandler !== null) {\n              this.viewModel[this.changeHandler](value);\n            }\n\n            break;\n          }\n\n          current = current.nextElementSibling;\n        }\n      }\n    }\n  }\n\n  onRemove(element) {\n    if (this.matches(element)) {\n      let value = element.au && element.au.controller ? element.au.controller.viewModel : element;\n\n      if (this.all) {\n        let items = this.viewModel[this.property] || (this.viewModel[this.property] = []);\n        let index = items.indexOf(value);\n\n        if (index !== -1) {\n          items.splice(index, 1);\n        }\n\n        return true;\n      }\n\n      return false;\n    }\n\n    return false;\n  }\n\n  onAdd(element) {\n    if (this.matches(element)) {\n      let value = element.au && element.au.controller ? element.au.controller.viewModel : element;\n\n      if (this.all) {\n        let items = this.viewModel[this.property] || (this.viewModel[this.property] = []);\n        let index = 0;\n        let prev = element.previousElementSibling;\n\n        while (prev) {\n          if (this.matches(prev)) {\n            index++;\n          }\n\n          prev = prev.previousElementSibling;\n        }\n\n        items.splice(index, 0, value);\n        return true;\n      }\n\n      this.viewModel[this.property] = value;\n\n      if (this.changeHandler !== null) {\n        this.viewModel[this.changeHandler](value);\n      }\n    }\n\n    return false;\n  }\n\n  unbind() {\n    if (this.viewHost.__childObserver__) {\n      this.viewHost.__childObserver__.disconnect();\n      this.viewHost.__childObserver__ = null;\n    }\n  }\n};\n\n\nfunction remove(viewSlot, previous) {\n  return Array.isArray(previous) ? viewSlot.removeMany(previous, true) : viewSlot.remove(previous, true);\n}\n\nexport const SwapStrategies = {\n  before(viewSlot, previous, callback) {\n    return previous === undefined ? callback() : callback().then(() => remove(viewSlot, previous));\n  },\n\n  with(viewSlot, previous, callback) {\n    return previous === undefined ? callback() : Promise.all([remove(viewSlot, previous), callback()]);\n  },\n\n  after(viewSlot, previous, callback) {\n    return Promise.resolve(viewSlot.removeAll(true)).then(callback);\n  }\n};\n\nfunction tryActivateViewModel(context) {\n  if (context.skipActivation || typeof context.viewModel.activate !== 'function') {\n    return Promise.resolve();\n  }\n\n  return context.viewModel.activate(context.model) || Promise.resolve();\n}\n\nexport let CompositionEngine = (_dec10 = inject(ViewEngine, ViewLocator), _dec10(_class17 = class CompositionEngine {\n  constructor(viewEngine, viewLocator) {\n    this.viewEngine = viewEngine;\n    this.viewLocator = viewLocator;\n  }\n\n  _swap(context, view) {\n    let swapStrategy = SwapStrategies[context.swapOrder] || SwapStrategies.after;\n    let previousViews = context.viewSlot.children.slice();\n\n    return swapStrategy(context.viewSlot, previousViews, () => {\n      return Promise.resolve(context.viewSlot.add(view)).then(() => {\n        if (context.currentController) {\n          context.currentController.unbind();\n        }\n      });\n    }).then(() => {\n      if (context.compositionTransactionNotifier) {\n        context.compositionTransactionNotifier.done();\n      }\n    });\n  }\n\n  _createControllerAndSwap(context) {\n    return this.createController(context).then(controller => {\n      controller.automate(context.overrideContext, context.owningView);\n\n      if (context.compositionTransactionOwnershipToken) {\n        return context.compositionTransactionOwnershipToken.waitForCompositionComplete().then(() => this._swap(context, controller.view)).then(() => controller);\n      }\n\n      return this._swap(context, controller.view).then(() => controller);\n    });\n  }\n\n  createController(context) {\n    let childContainer;\n    let viewModel;\n    let viewModelResource;\n    let m;\n\n    return this.ensureViewModel(context).then(tryActivateViewModel).then(() => {\n      childContainer = context.childContainer;\n      viewModel = context.viewModel;\n      viewModelResource = context.viewModelResource;\n      m = viewModelResource.metadata;\n\n      let viewStrategy = this.viewLocator.getViewStrategy(context.view || viewModel);\n\n      if (context.viewResources) {\n        viewStrategy.makeRelativeTo(context.viewResources.viewUrl);\n      }\n\n      return m.load(childContainer, viewModelResource.value, null, viewStrategy, true);\n    }).then(viewFactory => m.create(childContainer, BehaviorInstruction.dynamic(context.host, viewModel, viewFactory)));\n  }\n\n  ensureViewModel(context) {\n    let childContainer = context.childContainer = context.childContainer || context.container.createChild();\n\n    if (typeof context.viewModel === 'string') {\n      context.viewModel = context.viewResources ? context.viewResources.relativeToView(context.viewModel) : context.viewModel;\n\n      return this.viewEngine.importViewModelResource(context.viewModel).then(viewModelResource => {\n        childContainer.autoRegister(viewModelResource.value);\n\n        if (context.host) {\n          childContainer.registerInstance(DOM.Element, context.host);\n        }\n\n        context.viewModel = childContainer.viewModel = childContainer.get(viewModelResource.value);\n        context.viewModelResource = viewModelResource;\n        return context;\n      });\n    }\n\n    let m = metadata.getOrCreateOwn(metadata.resource, HtmlBehaviorResource, context.viewModel.constructor);\n    m.elementName = m.elementName || 'dynamic-element';\n    m.initialize(context.container || childContainer, context.viewModel.constructor);\n    context.viewModelResource = { metadata: m, value: context.viewModel.constructor };\n    childContainer.viewModel = context.viewModel;\n    return Promise.resolve(context);\n  }\n\n  compose(context) {\n    context.childContainer = context.childContainer || context.container.createChild();\n    context.view = this.viewLocator.getViewStrategy(context.view);\n\n    let transaction = context.childContainer.get(CompositionTransaction);\n    let compositionTransactionOwnershipToken = transaction.tryCapture();\n\n    if (compositionTransactionOwnershipToken) {\n      context.compositionTransactionOwnershipToken = compositionTransactionOwnershipToken;\n    } else {\n      context.compositionTransactionNotifier = transaction.enlist();\n    }\n\n    if (context.viewModel) {\n      return this._createControllerAndSwap(context);\n    } else if (context.view) {\n      if (context.viewResources) {\n        context.view.makeRelativeTo(context.viewResources.viewUrl);\n      }\n\n      return context.view.loadViewFactory(this.viewEngine, new ViewCompileInstruction()).then(viewFactory => {\n        let result = viewFactory.create(context.childContainer);\n        result.bind(context.bindingContext, context.overrideContext);\n\n        if (context.compositionTransactionOwnershipToken) {\n          return context.compositionTransactionOwnershipToken.waitForCompositionComplete().then(() => this._swap(context, result)).then(() => result);\n        }\n\n        return this._swap(context, result).then(() => result);\n      });\n    } else if (context.viewSlot) {\n      context.viewSlot.removeAll();\n\n      if (context.compositionTransactionNotifier) {\n        context.compositionTransactionNotifier.done();\n      }\n\n      return Promise.resolve(null);\n    }\n\n    return Promise.resolve(null);\n  }\n}) || _class17);\n\nexport let ElementConfigResource = class ElementConfigResource {\n  initialize(container, target) {}\n\n  register(registry, name) {}\n\n  load(container, target) {\n    let config = new target();\n    let eventManager = container.get(EventManager);\n    eventManager.registerElementConfig(config);\n  }\n};\n\nfunction validateBehaviorName(name, type) {\n  if (/[A-Z]/.test(name)) {\n    let newName = _hyphenate(name);\n    LogManager.getLogger('templating').warn(`'${ name }' is not a valid ${ type } name and has been converted to '${ newName }'. Upper-case letters are not allowed because the DOM is not case-sensitive.`);\n    return newName;\n  }\n  return name;\n}\n\nexport function resource(instance) {\n  return function (target) {\n    metadata.define(metadata.resource, instance, target);\n  };\n}\n\nexport function behavior(override) {\n  return function (target) {\n    if (override instanceof HtmlBehaviorResource) {\n      metadata.define(metadata.resource, override, target);\n    } else {\n      let r = metadata.getOrCreateOwn(metadata.resource, HtmlBehaviorResource, target);\n      Object.assign(r, override);\n    }\n  };\n}\n\nexport function customElement(name) {\n  return function (target) {\n    let r = metadata.getOrCreateOwn(metadata.resource, HtmlBehaviorResource, target);\n    r.elementName = validateBehaviorName(name, 'custom element');\n  };\n}\n\nexport function customAttribute(name, defaultBindingMode, aliases) {\n  return function (target) {\n    let r = metadata.getOrCreateOwn(metadata.resource, HtmlBehaviorResource, target);\n    r.attributeName = validateBehaviorName(name, 'custom attribute');\n    r.attributeDefaultBindingMode = defaultBindingMode;\n    r.aliases = aliases;\n  };\n}\n\nexport function templateController(target) {\n  let deco = function (t) {\n    let r = metadata.getOrCreateOwn(metadata.resource, HtmlBehaviorResource, t);\n    r.liftsContent = true;\n  };\n\n  return target ? deco(target) : deco;\n}\n\nexport function bindable(nameOrConfigOrTarget, key, descriptor) {\n  let deco = function (target, key2, descriptor2) {\n    let actualTarget = key2 ? target.constructor : target;\n    let r = metadata.getOrCreateOwn(metadata.resource, HtmlBehaviorResource, actualTarget);\n    let prop;\n\n    if (key2) {\n      nameOrConfigOrTarget = nameOrConfigOrTarget || {};\n      nameOrConfigOrTarget.name = key2;\n    }\n\n    prop = new BindableProperty(nameOrConfigOrTarget);\n    return prop.registerWith(actualTarget, r, descriptor2);\n  };\n\n  if (!nameOrConfigOrTarget) {\n    return deco;\n  }\n\n  if (key) {\n    let target = nameOrConfigOrTarget;\n    nameOrConfigOrTarget = null;\n    return deco(target, key, descriptor);\n  }\n\n  return deco;\n}\n\nexport function dynamicOptions(target) {\n  let deco = function (t) {\n    let r = metadata.getOrCreateOwn(metadata.resource, HtmlBehaviorResource, t);\n    r.hasDynamicOptions = true;\n  };\n\n  return target ? deco(target) : deco;\n}\n\nconst defaultShadowDOMOptions = { mode: 'open' };\n\nexport function useShadowDOM(targetOrOptions) {\n  let options = typeof targetOrOptions === 'function' || !targetOrOptions ? defaultShadowDOMOptions : targetOrOptions;\n\n  let deco = function (t) {\n    let r = metadata.getOrCreateOwn(metadata.resource, HtmlBehaviorResource, t);\n    r.targetShadowDOM = true;\n    r.shadowDOMOptions = options;\n  };\n\n  return typeof targetOrOptions === 'function' ? deco(targetOrOptions) : deco;\n}\n\nexport function processAttributes(processor) {\n  return function (t) {\n    let r = metadata.getOrCreateOwn(metadata.resource, HtmlBehaviorResource, t);\n    r.processAttributes = function (compiler, resources, node, attributes, elementInstruction) {\n      try {\n        processor(compiler, resources, node, attributes, elementInstruction);\n      } catch (error) {\n        LogManager.getLogger('templating').error(error);\n      }\n    };\n  };\n}\n\nfunction doNotProcessContent() {\n  return false;\n}\n\nexport function processContent(processor) {\n  return function (t) {\n    let r = metadata.getOrCreateOwn(metadata.resource, HtmlBehaviorResource, t);\n    r.processContent = processor ? function (compiler, resources, node, instruction) {\n      try {\n        return processor(compiler, resources, node, instruction);\n      } catch (error) {\n        LogManager.getLogger('templating').error(error);\n        return false;\n      }\n    } : doNotProcessContent;\n  };\n}\n\nexport function containerless(target) {\n  let deco = function (t) {\n    let r = metadata.getOrCreateOwn(metadata.resource, HtmlBehaviorResource, t);\n    r.containerless = true;\n  };\n\n  return target ? deco(target) : deco;\n}\n\nexport function useViewStrategy(strategy) {\n  return function (target) {\n    metadata.define(ViewLocator.viewStrategyMetadataKey, strategy, target);\n  };\n}\n\nexport function useView(path) {\n  return useViewStrategy(new RelativeViewStrategy(path));\n}\n\nexport function inlineView(markup, dependencies, dependencyBaseUrl) {\n  return useViewStrategy(new InlineViewStrategy(markup, dependencies, dependencyBaseUrl));\n}\n\nexport function noView(targetOrDependencies, dependencyBaseUrl) {\n  let target;\n  let dependencies;\n  if (typeof targetOrDependencies === 'function') {\n    target = targetOrDependencies;\n  } else {\n    dependencies = targetOrDependencies;\n    target = undefined;\n  }\n\n  let deco = function (t) {\n    metadata.define(ViewLocator.viewStrategyMetadataKey, new NoViewStrategy(dependencies, dependencyBaseUrl), t);\n  };\n\n  return target ? deco(target) : deco;\n}\n\nexport function elementConfig(target) {\n  let deco = function (t) {\n    metadata.define(metadata.resource, new ElementConfigResource(), t);\n  };\n\n  return target ? deco(target) : deco;\n}\n\nexport function viewResources(...resources) {\n  return function (target) {\n    metadata.define(ViewEngine.viewModelRequireMetadataKey, resources, target);\n  };\n}\n\nexport let TemplatingEngine = (_dec11 = inject(Container, ModuleAnalyzer, ViewCompiler, CompositionEngine), _dec11(_class18 = class TemplatingEngine {\n  constructor(container, moduleAnalyzer, viewCompiler, compositionEngine) {\n    this._container = container;\n    this._moduleAnalyzer = moduleAnalyzer;\n    this._viewCompiler = viewCompiler;\n    this._compositionEngine = compositionEngine;\n    container.registerInstance(Animator, Animator.instance = new Animator());\n  }\n\n  configureAnimator(animator) {\n    this._container.unregister(Animator);\n    this._container.registerInstance(Animator, Animator.instance = animator);\n  }\n\n  compose(context) {\n    return this._compositionEngine.compose(context);\n  }\n\n  enhance(instruction) {\n    if (instruction instanceof DOM.Element) {\n      instruction = { element: instruction };\n    }\n\n    let compilerInstructions = {};\n    let resources = instruction.resources || this._container.get(ViewResources);\n\n    this._viewCompiler._compileNode(instruction.element, resources, compilerInstructions, instruction.element.parentNode, 'root', true);\n\n    let factory = new ViewFactory(instruction.element, compilerInstructions, resources);\n    let container = instruction.container || this._container.createChild();\n    let view = factory.create(container, BehaviorInstruction.enhance());\n\n    view.bind(instruction.bindingContext || {}, instruction.overrideContext);\n\n    view.firstChild = view.lastChild = view.fragment;\n    view.fragment = DOM.createDocumentFragment();\n    view.attached();\n\n    return view;\n  }\n}) || _class18);\n","export * from './aurelia-templating';\nexport function configure(config) {\n  //config.globalResources([]);\n}\n"],"sourceRoot":".."}